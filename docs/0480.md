# Airbnb iOS 品牌演变内幕| Airbnb eng | Airbnb 技术博客| Medium

> 原文:[https://nerds . Airbnb . com/inside-Airbnb-IOs-brand-evolution/？UTM _ source = Wanqu . co&UTM _ campaign = Wanqu+Daily&UTM _ medium = website](https://nerds.airbnb.com/inside-airbnb-ios-brand-evolution/?utm_source=wanqu.co&utm_campaign=Wanqu+Daily&utm_medium=website)

# Airbnb iOS 品牌演变内幕

作者赞·克莱斯



今年早些时候，我们启动了一个为期六个月的项目来更新移动应用程序，以配合我们更新品牌的发布。Airbnb 产品团队继续为我们的移动应用提供新功能，甚至在实施新品牌的几个月里也是如此。从逻辑上来说，这就相当于在飞机飞行时重新喷漆，而没有任何乘客知道。当它着陆时，我们也想给它一个惊喜。

当我们开始品牌进化的时候，我们选择使用小而灵活的工程团队来防止互相阻碍。当一个项目的规格发生变化时，很容易在厨房里有太多的厨师，因为工程师们开始比变化的设计行动得更快。直到上个月，这个团队每个移动应用都有一名工程师，网站有三名工程师。这一决定背后的部分逻辑也是对设计是一个迭代过程的承认:没有一个 PSD 文件能在与用户的第一次接触中存活下来。一个小的工程团队能够更好地适应，沟通失败的地方更少。



设计团队已经努力工作了几个月来创造新的品牌，但他们让工程师们提前进入房间，开始帮助确定项目范围。此时，我们正在考虑:

1.  设计语言:我们的“工具箱”看起来会是什么样的(按钮、开关等)。？)
2.  我们如何在不超出 reskin 范围的情况下提高应用程序的可用性？
3.  我们如何在不干扰其他团队的情况下完成所有这些工作？

甚至在使用一个小团队重新设计应用程序的范围内思考，很明显有一些快速的可用性胜利。例如，我们将侧抽屉(Airnav)的背景颜色改为深色，这大大提高了可读性。作为对比，下面是我们导航系统的使用前后的照片:



我们将预订屏幕上的选项卡设计成更明显的按钮，这提高了用户发现功能的能力。在这些设计/工程会议上，对每个伟大的想法说“是”是很诱人的，但是小工程团队的限制意味着我们非常清楚我们有限的资源。



*Above: one of the PSDs in our toolkit, defining modal and user picture styles. Those with a sharp eye will note that this does not exactly match the final version, which was one of the challenges we knew we would be facing during the process.*



## 建筑工程

对于如何构建我们的工作流程，我们有两种选择。我们可以将品牌代码约束到一个长期存在的 Git 分支，或者我们可以继续合并以控制和分割 XCode 目标。出于多种原因，我们决定采用后一种方法。最值得注意的是，我们决定，即使只有一名工程师负责品牌演变本身，团队成员也将负责确保新功能与品牌演变兼容。



在复制了我们的目标并替换了应用程序图标后，我们现在面临着一系列新的挑战。首先，我们需要确保没有资产因意外包含在分发目标中而泄露。我们仔细检查了每一个。ipa 是为泄密而建立的，甚至在代码中使用代码字作为符号名，通过逆向工程二进制文件来防止泄密。

接下来，我们需要决定如何分支代码。从表面上看，这很简单:我们只是向名为 **STYLE_PRETZEL** 的新目标添加了一个预处理宏。然后，我们可以在我们的代码中使用**# if defined(STYLE _ PRETZEL)**，并确保块中的任何内容都不会被编译到现有的部署目标中。这种方法肯定有缺点，例如:

*   代码复杂性:代码库很快被分支逻辑弄得千疮百孔
*   **没有头文件变化**:由于我们 XCode 工作空间的多项目性质，我们不能保证宏在头文件中可用，所以我们不能使用在中定义的**# if**。h 文件
*   **(几乎)没有新的类**:由于上述两个原因，通常最好不要添加任何新的类，而是使用现有的类

在某些方面，这些限制实际上帮助了我们:它迫使我们考虑完成任务所需的最小可行的代码更改。换句话说:如果你写了很多代码，你可能已经超越了重皮肤。

## 逐步实施

我们的内部样式库 Nitrogen 允许我们更换颜色、字体和基本组件(“工具包”)样式。这种大规模的替换之后，接着是在所有屏幕上进行多次渐进的改进。我们喜欢把它想象成通过慢速互联网连接下载的图像的渐进渲染:



工具包之后是“第一次切割”，此时应用程序看起来肯定是新的，但仍远未达到 Airbnb 的设计完美标准；我们基本上观察了这些变化:



接下来是“红线”制作团队拿着提供的 PSDs，用软件调出准确的字体、颜色、边距等。：



对于嵌套视图、子类控制器和其他陷阱，有时很难知道设计是否真正按照规范实现。为了检查我们的工作，我们使用 [Reveal](http://revealapp.com/) 将正确的值与实际实现进行比较:



## 全体出动

距离大发布还有大约一个月的时间，我们删除了旧的 XCode 目标，并删除了预处理器宏和 **#if defined** 语句，将我们锁定在部署品牌演进的下一版本应用上。不仅所有移动团队成员现在都在使用 reskinned 应用程序，而且它还被分发给公司的员工开始测试。

我们 Airbnb 的口号之一是“每一帧都很重要”，现在是证明这一点的时候了。设计师们开始仔细检查应用程序，工程师们的队列里排满了错误报告。过去几周的重要性怎么强调都不为过。这是我们移动文本的点，这里移动一个像素，那里移动一个像素，然而所有这些像素加起来就是一个好的应用程序和一个干净的应用程序之间的差异。

## 经验教训

我们犯的最大疏忽是没有提前考虑本地化。Airbnb 是一个非常全球化的品牌，无论以何种语言显示，应用程序看起来都非常惊艳，这一点至关重要。这说明了“为动态而设计”的更大需求作为工程师，我们需要更好地与设计团队沟通，了解他们如何想象实现的变化。不仅适用于不同大小的文本，还适用于动画、屏幕大小等。

我们早期做出的分割 XCode 目标而不是创建 Git 分支的决定被证明是一个好的决定。结果是团队的其他成员至少在表面上熟悉了新的代码，当我们要求所有人都参与进来时，摩擦最小。

## 结论

总的来说，这个过程非常顺利。整个公司的团队继续在他们自己的项目上工作，直到发布前几周。在这个重要的日子里，所有的团队同时按下“启动”按钮，全世界都看到了这个新品牌。















