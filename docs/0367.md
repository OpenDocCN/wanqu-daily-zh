# 维基百科需要一个 IDE，而不是所见即所得编辑器

> 原文：<https://medium.com/@MrJamesFisher/wikipedia-needs-an-ide-not-a-wysiwyg-editor-7acd85b582c8?utm_source=wanqu.co&utm_campaign=Wanqu+Daily&utm_medium=website>

# 维基百科需要一个 IDE，而不是所见即所得的编辑器

*(顺便说一句，我最近推出了* [*日常数据科学*](https://tigyog.app/d/C-I1weB9CpTH/r/everyday-data-science) *，一门关于数据科学的互动课程。你会喜欢的。)*

如果你还没听说过，维基百科是世界上最大的软件项目。几乎有十亿条线路，是 healthcare.gov 的两倍大。它是用一种本土的[图灵完备的](https://web.archive.org/web/20130101055126/http://mentalpolyphonics.com/posts/wikimedia-proves-greenspuns-tenth-law)编程语言编码的，并且全部 13 年的历史都保存在一个本土的版本控制系统中。最终建成的人工制品——在线百科全书——获得了比 Twitter 更多的流量。

投稿人用什么文字编辑器写这个软件？只有一个:一个 HTML *< textarea >* 元素。它装饰有一些按钮，用于插入链接等常见操作，但除此之外，它是一个普通的旧文本区，具有记事本的功能。编辑的工作流程是:找到页面，点击页面顶部的“编辑”或一个节标题旁边的“编辑”，在文本区中寻找您想要编辑的文本，编辑源文件，点击“显示预览”，扫描页面以查看它是否像您预期的那样发生了变化，如果没有，则重试，然后点击“显示变化”，扫描比较以查看这是否是您预期的，如果不是，则重试，最后输入编辑摘要消息并点击“保存页面”。

这有什么错？好吧，用户显然讨厌它。太难了，太吓人了，太费时间了。用户显然非常不喜欢这种工作流程，以至于他们根本懒得投稿:与几年前相比，编辑维基百科的人明显少了。

## 失败的解决方案:可视化编辑器

维基百科已经意识到它的编辑界面是活跃用户减少的一个关键原因，已经花了很多年和很多美元来制作它的可视化编辑器。它应该是一个所见即所得的编辑器:编辑界面看起来几乎和页面一模一样，只是有一个闪烁的光标。

可视化编辑器于 2013 年推出。事情是这样的，编辑们非常讨厌它的麻烦，以至于不久之后就恢复了它的推出。今天，我们又有了不起眼的文本区，而可视化编辑器仍然是用户首选项中一个模糊的选择框。我相信它会留在那里。

为什么可视化编辑器会失败？因为它试图否认一个基本事实，即维基百科是一个程序，而不是一个 word 文档。维基百科上的页面是用大量的抽象概念构建的:模板、跨结论、目录、参考文献、类别、语义三元组等等。人们不能简单地将光标放在信息框中的任何地方并随意编辑它。在用户想要的*所见即所得*和程序员想要的*抽象概念*之间有一个基本的张力，维基百科就是建立在这两者之上的。这种矛盾是无法解决的:术语“所见即所得”和“抽象”是*字面上的反义词。编辑*工件*和编辑*源*只有在编译步骤简单且不涉及抽象的情况下才是同构的。维基百科的编译步骤当然不是微不足道的:它是图灵完备的。维基百科的所见即所得编辑器和天气预报程序的所见即所得编辑器一样有希望。*

## 更好的解决方案:IDE

编辑工具应该*接受*这个事实，而不是*隐藏*维基百科是一个程序的事实。当我们编写、编辑和导航传统程序时，大多数人都使用 IDE 来帮助我们:IDE 理解编程语言的语法和语义，也帮助我们理解它。维基百科需要的不是一个所见即所得的编辑器，而是一个 IDE。

维基百科的 IDE 会是什么样子？IDE 不会让用户时不时地点击“编译”来检查他们的工作，而是一起显示源代码和 HTML，并在*实时*更新 HTML。左边是源码，右边是 HTML。

IDE 将理解源文件和 HTML 之间的关系。滚动一个面板也会将另一个面板滚动到大致相同的位置。将鼠标悬停在源代码中的某个单词上，会在 HTML 中突出显示该单词，反之亦然。换句话说，IDE 理解源代码中的字符和 HTML 中的字符之间的对应关系，并且可以将这种对应关系传达给用户。

IDE 将理解 Mediawiki 语法。一点点语法高亮显示对帮助用户理解语法大有帮助。用户错误立即显示为源代码中的语法错误和 HTML 中的意外输出。

IDE 将实时集成源代码和 HTML 的比较查看器。在源代码中添加一个新单词，当您键入时，它会在源代码中以绿色突出显示。当您键入时，HTML 中相应的变化也会以绿色突出显示。

您可以右键单击 HTML 中的任何字符，然后选择“跳转到源代码”,而不是寻找“编辑”按钮来打开 IDE，然后重新找到您想要编辑的文本。编辑器从页面的左侧滚动，光标位于源代码中的对应字符处，准备好供您编辑。

这些添加并没有隐藏维基百科的语义，而是让语义*显现*。对于初学者来说，这些附加功能可以通过反复试验快速教会你 Mediawiki 语言。对于经验丰富的用户来说，这些附加功能提供了 ide 的常见好处。

## 字符对应

我建议的大部分内容都很传统:语法高亮(到处都有实现)、实时编译(网上的任何降价形式)、实时差异高亮(许多 ide)。

一个非常规的建议是在源文本和 HTML 文本的字符之间建立对应关系。更准确地说，有一个分部函数，它为 HTML 中的每个字符分配它在源代码中的起始字符:

```
 '''Operation Northwoods'''  was a ...
      ↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑     ↑↑↑↑↑
<p><b>Operation Northwoods</b> was a ...
```

如果我们可以在编译时建立这种起源，那么我们可以用它来简单地实现三个特性:(1)用 HTML 窗格滚动源窗格；(2)鼠标悬停时的双向文本突出显示；(3)“跳转到源”。

我们不希望编译步骤产生一个简单的输出字符串，而是希望它产生一个字符串，其中每个字符都用其原始的源字符进行了注释。然后，我们可以将它分解，生成普通的 HTML 和字符对应图。

不幸的是，与大多数编程语言一样，PHP 并不通过执行来跟踪值的来源。值进入黑盒，其他值出来，但如果你想了解输入和输出之间的关系，那么你必须看黑盒。

但是不一定要这样！我们可以跟踪出处，而根本不用改变源代码。我们只需要改变字符串的表示，这样它们就可以根据语言语义继续充当字符串，而且还可以跟踪它们的来源。这可以通过破解 PHP 编译器来实现，或者通过创建一个数据结构来实现“字符串”接口并跟踪出处。

对此有一些现有技术。在 TeX 世界中，一个名为 [SyncTeX](http://itexmac.sourceforge.net/SyncTeX.html) 的程序显然做了类似的工作:你可以从 PDF 文件中的一个位置跳转到原始文件中的一个位置。 *tex* 文件。在 Perl 和其他地方，[污点检查](https://en.wikipedia.org/wiki/Taint_checking)在运行时跟踪值，并根据它们是否来自不可信的来源对它们进行注释。这样的价值观被称为“污点”。对污染值的操作产生新的污染值；也就是说，污点具有传染性。我建议的是非常相似的，只是比*污染/未污染有一个更细粒度的出处概念。*

## 结论

维基百科的人口正在减少。他们自己的研究发现编辑过程是进入的一个重要障碍，也是离开的一个原因。他们的解决方案是一个所见即所得编辑器，失败的基本原因是它否认了维基百科是一个程序的事实。我建议一个更保守的解决方案:作为一个程序，维基百科需要一个 *IDE* 来拥抱和理解 Mediawiki 语言。IDE 应该优先考虑*快速反馈*:实时编译、实时差异查看以及源代码和 HTML 之间的实时对应。