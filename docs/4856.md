# 您的用户不需要密码。也许你的用户不需要… |亚历山大·克里沃什切科夫| Medium

> 原文:[https://medium . com/@ super paint man/your-users-don-need-a-password-9e 3 fa 492 f 69？UTM _ source = Wanqu . co&UTM _ campaign = Wanqu+Daily&UTM _ medium = website](https://medium.com/@SuperPaintman/your-users-dont-need-a-password-9e3fa492f69?utm_source=wanqu.co&utm_campaign=Wanqu+Daily&utm_medium=website)

# 您的用户不需要密码



Rusty lock. Source: [https://pixabay.com/en/padlock-grunge-rusty-rusting-76866/](https://pixabay.com/en/padlock-grunge-rusty-rusting-76866/)



在网站开发之初，最先做出的架构决策之一通常是使用电子邮件+密码来授权用户。这一对已经在我们脑子里扎了根，我们不去想为什么要让人去创造一个密码。我们习惯于这样做。

然而，让我们想想，也许你的用户不需要密码。

一个可能的解决方案是 OAuth 2.0，但并不是所有的用户都在社交网络上有账户，并想在你的网站上使用它。

你如何摆脱密码？关于这个问题，我会在文章中尝试回答。

# 有什么问题？

> [唯一安全的密码是你不记得的那个](https://www.troyhunt.com/only-secure-password-is-one-you-cant/)
> 
> 特洛伊·亨特

密码已经是个问题了。这对你和你的用户都没有好处。

对于网站所有者来说，密码是系统中的另一个漏洞。无论你的哈希算法有多强(上帝禁止不要使用它们)，它迟早会成为新 GPU 的一句废话，以后会成为 CPU 的废话。如果你的数据库泄露到网络中，将会对你和你的访问者造成巨大的打击。

对于你的访问者来说，密码是一个额外的挑战。没有经验的用户将使用他们的“常规”密码，增加了丢失密码的风险。高级用户必须为你的网站想出一个特殊的密码，或者需要使用密码管理器。

密码管理员的现象已经是一种肮脏的黑客行为，它应该向我们展示密码的无能和低效。

此外，您可以通过强制用户定期更改密码或要求使用特殊字符来使用户的生活变得痛苦。

# 我该怎么办？

答案是——不要使用密码。你只需要知道用户的电子邮件。

当用户在你的网站上注册时，你已经依赖于他们的电子邮件地址。您发送带有确认链接的邮件；你用它来重置用户的密码。

“重设密码”听起来已经像是一个矛盾修饰法了。因为您可以通过电子邮件中的链接来更改您的密码。给你。那么，你为什么强迫用户创建一个密码，改变它，并强制使用你最喜欢的特殊字符？

对于授权用户，您只需要向他们发送一封带有生成的链接的电子邮件，就像电子邮件确认一样。这足以授权用户。

现代电子邮件服务对黑客攻击的保护和准备比一个有滑稽猫的普通网站多很多倍。将密码的保存和保护委托给专业人员。

# 解决方案

举个例子，让我们看一个简单的使用 PostgreSQL 作为数据库的站点。

让我们用最少的一组列制作两个表:

**用户**:



**登录请求**:



关于他们的一些评论:

*   **sign_in_requests** 表可以(也应该)与“注册”表相同，因为在这个系统中，它们的作用是等同的。
*   基于以上观点，我们没有在**登录请求**表中使用外键，因为我们复制了**电子邮件**列。
*   **令牌**不一定是 uuid。为了手动输入，您可以将它缩短。但在这种情况下，碰撞的概率和安全性会变得更差。
*   **request_ip** 是可选列。仅将其用于限速器或类似原因。

算法:

1.  用户输入他们的电子邮件并提出请求。
2.  你生成 **sign_in_request** ，发送一个带有 token 的链接到用户的邮箱，比如:【https://example.com/signin/callback/email/{{token}}】T2。
3.  用户按照电子邮件中的链接，向您的数据库请求令牌。
4.  如果这样的令牌存在；(而且)还没过期；(且)未使用；(而且)是最后一个有这样的邮件(可选蛮力保护)，那么我们猜测一切正常。
5.  设置 **activated_at=now()** 以防止多次使用令牌。
6.  最后，一切同系统中的密码一样。你可以给用户一个 cookie / JWT /等等。

对于通过电子邮件的垃圾邮件保护，你可以设定一个速率限制，或者每 10 分钟发送一封邮件不要超过一次。

# 为了谁？

谁需要使用这种技术:

*   大多数互联网网站，像:博客/新闻网站/论坛。
*   您的用户已经在使用您的内部电子邮件服务器的公司网站。
*   定期使用但不经常使用的服务:互联网服务提供商的计费系统/站点。

但是不要使用这种技术:

*   当你是电子邮件服务(比如 Gmail)的时候。
*   你的主要客户是移动应用/智能电视/物联网。在这种情况下，使用密码会更容易。

# 结果

虽然，放弃密码的想法看起来疯狂而不寻常，但乍一看，它可以带来许多好处，并使您和您的用户的生活更加轻松。



