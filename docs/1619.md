# 五年打造 Instagram。一位联合创始人分享他的故事和经验

> 原文：<https://medium.com/backchannel/war-stories-3696d00207ff?utm_source=wanqu.co&utm_campaign=Wanqu+Daily&utm_medium=website>

## 战争故事

# 打造 Instagram 的五年



2010 年，在我们推出 Instagram v1 的前一天晚上，我和我的联合创始人凯文打赌这款应用在发布的第一天会有多少人下载。凯文猜了 2500，在一个特别乐观的时刻，我大手笔猜了 25000。第二天，我内心的现实主义者不敢相信我说对了。

现在，在我们 5 岁生日的时候，Instagram 在全球拥有 4 亿用户，他们每天上传 8000 万张照片和视频。回顾过去，我们平衡了原始产品的简单性和工艺，而就在去年，我们改进了搜索和发现，推出了 Instagram Direct 的全新版本，并继续发布 Layout 等创意工具。虽然我们的团队在过去 5 年中(谢天谢地)已经成长和发展，但我们仍然坚持先做简单的事情，并将其作为我们在未来 5 年继续扩展的核心。以下是我们在过去五年里建立 Instagram 的一些最大的里程碑——好的、坏的和令人惊讶的。希望有帮助你建立和成长自己的团队和公司的外卖。

# 里程碑# 1:3 个月内 100 万用户

**档案下:**最大挑战

上线后的头几个月相当模糊——凌晨 3 点的服务器提醒页面是常态而非例外。在第一天用户激增至 25，000 人后，我们继续快速增长，直到达到 100 万人。没有比人们真正想要使用你的产品更强烈的动机了，我们加快了速度，以确保我们能够支持不断增长的需求。当我们开始时，我们在洛杉矶的一台服务器上运行，其计算能力比 Macbook Pro 还要低。鉴于我们第一天的增长，当我打电话给主机提供商要求另一台服务器时，他们给我的报价是四天周转期——如果我们赶时间的话是 48 小时。鉴于我们的增长看起来是如此不可预测，我们决定转向亚马逊的网络服务云。

鉴于我们都没有深厚的基础设施经验，我们必须尽可能多地吸收知识。有来自 QCon 和 T2 的精彩会议视频，还有来自脸书、网飞、推特和其他网站的文章。分享技术见解的开放文化是我们行业最棒的事情之一，也是我们[工程博客](http://engineering.instagram.com/)背后的主要动力。

在最初的几周和几个月里，我们的口号“先做简单的事情”成型了。因为我们只有两个人，所以每次面对新的挑战时，我们都必须确定最快、最简单的解决方案。如果我们试图让我们所做的一切都经得起未来的考验，我们可能会因为无所作为而陷入瘫痪。通过确定要解决的最重要的问题，并选择最简单的解决方案，我们能够支持我们的指数增长。

# 里程碑#2:推出 Android

**归档于:**最受期待的发布会
在 Instagram 的最初几年里，凯文和我每次上台都会被问到一个问题:“Android 应用什么时候发布？?"

我们首先启动了 iOS-only，因为我们希望能够快速迭代我们的产品——而我们只有两名工程师。然而，随着我们进入 2012 年，是时候扩展到多个平台了。在典型的 Instagram 风格中，我们的 Android 应用程序是由三名工程师在三个月内完成的，其中两名工程师和 Philip 一起学习了 Android 来完成这个项目，Philip 从构建 Gowalla 的 Android 应用程序开始就加入了我们，并领导 Instagram 的移动应用程序直到今天。

我当时的部分角色是“专业易贝购物者”，因为我们希望在尽可能多的设备上测试我们的应用程序，包括一种名为“M865 Ascend II 2 Touch”的设备。更多的时候，我们会在办公室打开新手机的包装，加载我们的工作进展应用程序，并惊讶于该应用程序的工作效果。Android 设备的多样性给我们带来了一些挑战——尤其是在我们开发 Instagram 视频产品的时候——但在只需最少定制的情况下就能推出如此多种多样的设备，这非常令人惊讶。



在我们发布的前 12 个小时，超过 100 万新用户加入了 Instagram 这是一个令人难以置信的反应。当时，我也写了一些我们在基础设施方面的经验教训。随着时间的推移，我们的 Android 应用程序[已经进化到在平台上感觉更本土](http://engineering.instagram.com/posts/706219542839665/building-a-better-instagram-app-for-android/)，今天是速度最快、评分最高的 Android 应用程序之一。



**外卖:**从单个平台开始让我们可以快速专注和迭代，而不必将所有事情都实现两次(我们在 Instagram 内部常说“做更少的事情更好”)。当需要扩展到多个平台时，我们建立了一个小团队，将深厚的 Android 专业知识与对平台不熟悉的天才工程师结合起来。随着时间的推移，建立一个成熟的 Android 团队使我们能够更好地适应我们的应用程序。

# 里程碑#3: 2012 年弗吉尼亚风暴

2012 年，我在波特兰度过了一个为期三天的短暂周末假期，这时我的手机嗡嗡作响:“[Instagram.com](http://instagram.com/)停机了”。网上的快速检查显示，这不仅仅是 Instagram 的问题——网飞和其他人也遇到了问题。我跑回酒店，打开笔记本电脑，在亚马逊网站服务状态页面上看到一条可怕的信息:“美国东部电力事件”。一场巨大的风暴席卷了弗吉尼亚，我们几乎一半的实例都失去了电力。接下来的 36 小时将是我们几乎整个基础设施的残酷重建。令人欣慰的是，它产生了这个迷因形象:



当时，我们整个后端团队由我、我们的第一个工程师 Shayne 和 Rick 组成，Rick 在不到一个月前开始在 Instagram 工作。没有用户数据丢失，但这次中断暴露了我们在自动化基础架构方面还有多少工作要做。

这次停机对我们来说是当头一棒，我们需要转向更具可重复性的服务器供应流程。在接下来的一年里，我们将所有供应从脆弱的 shell 脚本转移到完整的 Chef 系统，并大幅降低了新团队成员使用我们基础架构的门槛。

我们也不再依赖亚马逊的弹性块存储进行数据库备份，而是采用了 [WAL-E](https://github.com/wal-e/wal-e) 和 Postgres 的 WAL shipping 复制。我们还启动了一项可靠性计划，该计划最近产生了我们的跨数据中心工作，使 Instagram 在地理上分散的数据中心运行。

**要点:**拥有一个可脚本化的基础架构需要前期工作，但可以为您的基础架构团队带来巨大的回报，并在灾难恢复场景中提供帮助。此外，我很高兴我们雇佣了有合适材料的工程师——当面临难以想象的糟糕情况时，Shayne 和 Rick 都卷起袖子，开始让我们重新振作起来，一次解决一个问题，这是 Mark-Watney 的风格。

# 里程碑#4:整合

**档案在:**最雄心勃勃的工程项目
2010 年 10 月 5 日:0 用户😬
2010 年 10 月 6 日:25，000 名用户😜【2010 年 11 月:100 万用户😅
2012 年:3000 万用户😆
2013 年:2 亿用户😵

到 2013 年，我们每月有 2 亿人使用 Instagram，存储了超过 200 亿张照片。我们的团队在成长，但规模很小，我们对 Instagram 社区的持续增长感到兴奋。随着时间的推移，我们不断发现我们希望与脸书现有的后端系统进行新的整合，例如，他们的网站完整性系统对于帮助我们打击垃圾邮件至关重要。但是，当我们使用亚马逊网络服务时，进行这些集成会很困难，我们等待的时间越长，就越难迁移我们不断增长(也越来越贵)的基础设施。

很明显，我们应该迁移到脸书的基础设施，但我们不想在迁移数百万人和数十亿张照片时中断服务。就这样开始了[I](http://instagram-engineering.tumblr.com/post/100758229719/migrating-from-aws-to-aws)T2 的安装，或者我喜欢称之为在一辆车以 100 英里的时速行驶时更换它的所有部件。一个由八名 Instagram 和脸书工程师组成的小团队首先使用我们内部开发的工具 [Neti](https://github.com/Instagram/neti) 构建了一个公共网络，将 Instagram 从 EC2 迁移到亚马逊的虚拟私有云(VPC)。然后，我们小心翼翼地迁移我们的系统和工具，包括构建一个“ig”命令行工具，将我们的开发人员熟悉的模式从 AWS 移植到新的 FB 数据中心环境中。最终的结果是一次大规模的迁移，而中断却很少。

**外卖:**不要多此一举。通过转移到脸书的服务器，我们能够给我们的基础设施一个更快、更有效的家，以及利用脸书的其他工具，如垃圾邮件战斗等。我们能够保持小规模，但利用脸书的资源和经验，并以更快的速度前进。

# 里程碑# 5:insta gram 上的趋势

**归档于:**下一个大赌注
今年早些时候，我们改进了搜索&探索并扩展了在 Instagram 上轻松找到世界上发生的有趣时刻的能力。我们引入了趋势标签和位置，并且[建立了所有新的基础设施](http://engineering.instagram.com/posts/1599203307002438/trending-on-instagram/)，以支持在 Instagram 上识别、排名和展示最佳内容。

早在 2010 年，我们第一次关注趋势，是在 Instagram 发布时提供的“热门”页面。算法非常简单:每张照片上的有效点赞数，会随着照片超过 4 小时的时间而衰减。当我们的社区规模较小时，这种方法非常有效，但是随着时间的推移，我们意识到我们需要一种更加细致入微的方法。

鉴于我们的社区更大，2014 年我们致力于个性化探索，为每个人提供无限滚动的照片和视频页面。几个月内，我们的用户与内容的交互速度是非个性化探索的 5 倍。今年，我们带回了最初流行页面的意图——对 Instagram 的*完形*的一瞥——作为我们的趋势产品。随着排名和机器学习专家加入我们的团队，我们能够根据 Instagram 社区的细微差别调整知名的趋势算法。

**要点:**先做简单的事情并不意味着你的解决方案永远有效。我们已经学会了开放地发展我们的产品，并组建像我们的数据报团队这样的专门团队，以适应我们快速扩展的社区。



对我们许多人来说，过去的五年是一段疯狂的旅程，在我们生日的时候停下来反思一下是很好的。我确信，随着我们的社区继续成长，我们的产品继续发展，在我的“回顾 10 年”中期帖子中，将不会缺少要谈论的东西。为下一个五年干杯！









