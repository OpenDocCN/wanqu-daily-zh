# 它是未来-英雄库坞|圆形坞站 vs 火箭，英雄库坞站 vs 坞站

> 原文:[https://circleci.com/blog/its-the-future/?UTM _ source = Wanqu . co&UTM _ campaign = Wanqu+Daily&UTM _ medium = website](https://circleci.com/blog/its-the-future/?utm_source=wanqu.co&utm_campaign=Wanqu+Daily&utm_medium=website)

![rabbit_hole](../Images/44f29397b403a6cbc29b6ed770362c48.png)

嘿，我的老板说要和你谈谈-我听说你对网络应用很了解？

是的，我现在更喜欢分布式系统。我刚从 ContainerCamp 和 Gluecon 回来，下周要去 Dockercon。对行业的发展方式感到非常兴奋——让一切变得更简单、更可靠。是未来！

酷毙了。我目前只是在构建一个简单的 web 应用程序——一个使用 Rails 的普通 CRUD 应用程序，将部署到 Heroku。那还是要走的路吗？

哦，不。那是老方法了。Heroku 死了，没人再用它了。你现在需要使用 Docker。这是未来。

哦，好吧。那是什么？

码头工人是这种新的集装箱运输方式。它就像 LXC，但它也是一种打包格式，一个分发平台，以及让分布式系统变得非常简单的工具。

集装箱里..—现在怎么办？LXE 是什么？

我是 LXC。这就像类固醇激素！

cher-oot 是什么？

好吧，看。码头工人。集装箱化。这是未来。这就像虚拟化，但是更快更便宜。

哦，就像流浪汉一样。

不，流浪者已经死了。现在一切都将集装箱化，这是未来。

好的，那么我不需要了解任何关于虚拟化的知识？

不，你仍然需要虚拟化，因为容器还不能提供完整的安全故事。所以如果你想在多租户环境中运行任何东西，你需要确保你不能逃离沙箱。

好吧，我有点迷路了。我们来备份一下。所以有一种类似虚拟化的东西，叫做容器。我可以用这个对付 Heroku？

嗯，赫罗库有些支持多克，但是我告诉过你:赫罗库已经死了。你想在 CoreOS 上运行你的容器。

好吧，那是什么？

这个很酷的主机操作系统可以和 Docker 一起使用。见鬼，你甚至不需要 Docker，你可以使用 rkt。

火箭？

*不，是 rkt。*

好的，火箭。

*-不，现在叫 rkt。完全不同。这是一种替代的容器化格式，不像 Docker 那样捆绑在一起，因此更具可组合性。*

这样好吗？

当然是好的。可组合性是未来。

好的，你如何使用它？

我不知道。我觉得没人用。

叹气。你刚才说了些关于科瑞奥斯的事？

是的，所以这是你和 Docker 一起使用的主机操作系统。

什么是主机操作系统？

一个主机操作系统运行你所有的容器。

管理我的集装箱？

是的，你得有东西来管理你的集装箱。因此，您可以像设置 EC2 实例一样，将 CoreOS 放在上面，然后运行 Docker 守护进程，然后可以将 Docker 映像部署到它上面。

那是容器的哪一部分？

所有的一切。看，你拿着你的应用，写一个 Docker 文件，在本地把它变成一个图像，然后你可以把它推送到任何 Docker 主机。

啊，就像赫罗库？

不，不是 Heroku。我告诉过你。赫罗库死了。你现在使用 Docker 运行你自己的云。

什么？

是的，这很简单。查一下#gifee。

吉菲？

*——“谷歌为其他所有人打造的基础设施”。你可以使用容器从现成的工具和堆栈中取出一些，你可以拥有和 Google 一样的基础设施。*

我为什么不用谷歌的东西呢？

你认为这种情况会在 6 个月后出现吗？

好吧，难道没有其他人做这些东西的主机吗？我真的不想托管自己的东西。

嗯，亚马逊有 ECS，但是你必须写 XML 或者其他东西。

OpenStack 上的东西呢？

恶心。

Ew？

恶心。

听着，我真的不想托管我自己的东西。

不，这真的很简单。您刚刚建立了一个 Kubernetes 集群。

我需要一个集群？

*-Kubernetes 星团。它将管理您所有服务的部署。*

我只有一项服务。

你是什么意思？你有一个应用程序的权利，所以你至少有 8-12 个服务？

什么？没有，就一个 app。服务什么的。只是其中之一。

不，看看微服务。这是未来。这是我们现在做任何事情的方式。你把你的单片应用程序分成 12 个服务。你做的每一项工作都有一个。

这似乎太过分了。

这是确保它可靠的唯一方法。因此，如果您的认证服务出现故障…

认证服务？我正要用这块我以前用过几次的宝石。

太好了。使用宝石。把它放到它自己的项目里。在上面放一个 RESTful API。然后，您的其他服务使用该 API，并优雅地处理失败等问题。把它放在一个容器里，然后不断地把它送出去。

好了，现在我有了几十个无法管理的服务，现在该怎么办？

是的，我说的是 Kubernetes。让您能够协调所有服务。

策划他们？

是的，所以你有这些服务，它们必须可靠，所以你需要它们的多个副本。因此，Kubernetes 会确保您有足够的资源，并且这些资源分布在您的机群中的多个主机上，因此它总是可用的。

我现在需要一支舰队？

是的，为了可靠性。但是 Kubernetes 为你管理它。你知道 Kubernetes 的作品，因为谷歌建立了它，它运行在 etcd 上。

什么是 etcd？

这是 RAFT 的一个实现。

好吧，那么木筏是什么？

就像帕克斯一样。

天啊，我们要去多深的兔子洞？我只想推出一个应用程序。叹气。他妈的，好吧，深呼吸。上帝啊。好吧，Paxos 是什么？

Paxos 就像是 70 年代的分布式共识协议，没有人理解或使用。

太好了，谢谢你告诉我这件事。筏子是什么？

*-因为没人了解帕克斯，这个家伙迭戈…*

哦，你认识他？

不，他在 CoreOS 工作。不管怎样，迭戈为他的博士论文造了一个筏子，因为帕克斯太难了。聪明绝顶的家伙。然后他写了 etcd 作为实现，Aphyr 说不是屎。

Aphyr 是什么？

Aphyr 是那个写了“也许打电话给我”的人你知道，分布式系统和 BDSM 家伙？

什么？你是说 BDSM 吗？

是的，BDSM。这是旧金山。每个人都喜欢分布式系统和 BDSM。

呃，好吧。他写了凯蒂·佩里的歌？

不，他写了一系列关于每个数据库如何失败的博文。

CAP 是什么？

*——上限定理。它说一致性、可用性和分区容忍度三者只能取其二。*

好的，所有数据库都失败了吗？这到底是什么意思？

意思是他们是狗屎。比如 Mongo。

我以为 Mongo 是网络规模的？

其他人都没有。

好吧，那么等等？

是的，etcd 是一个分布式键值存储。

哦，就像里兹。

不，一点也不像雷迪斯。etcd 分布式。如果网络分区，Redis 会丢失一半的写入数据。

好了，这是一个*分布式*键值存储。这为什么有用？

*-Kubernetes 使用 etcd 作为消息总线建立一个标准的 5 节点集群。它与 Kubernetes 自己的一些服务相结合，提供了一个非常有弹性的编排系统。*

5 个节点？我有一个应用程序。所有这些我需要多少台机器？

嗯，你将有大约 12 个服务，当然你需要每个服务的一些冗余拷贝，一些负载平衡器，etcd 集群，你的数据库，和 kubernetes 集群。大概有 50 个流动集装箱。

WTF！

没什么大不了的！容器真的很高效，所以你应该能够把它们分布在 8 台机器上！是不是很神奇？

这是一种说法。有了这些，我就可以简单地部署我的应用程序了？

当然可以。我的意思是，对于 Docker 和 Kubernetes 来说，存储仍然是一个开放的问题，联网需要一些工作，但你基本上已经做到了！

我明白了。好的，我想我明白了。

太好了！

谢谢你的解释。

没问题。

让我重复一遍，看看我是否理解对了。

当然可以！

因此，我只需要将我的简单 CRUD 应用程序分成 12 个微服务，每个微服务都有自己的 API，这些 API 调用彼此的 API，但可以灵活地处理故障，将它们放入 Docker 容器中，启动一个由 8 台运行 CoreOS 的 Docker 主机组成的机群，使用一个运行 etcd 的小型 Kubernetes 集群对它们进行“编排”，找出网络和存储的“未决问题”，然后我不断向我的机群提供每个微服务的多个冗余副本。就这样吗？

是的！是不是很光荣？

我要回赫罗库。

***想用 Docker，源源不断的送那狗屁？查看 [CircleCI 的码头支持](https://circleci.com/docker/)。***

***想动作快又不坏东西？[免费注册](https://circleci.com/signup/)软件团队喜欢使用的现代持续集成和交付平台。***

***你的防火墙后面需要牛逼的 CI/CD？[给我们留言](mailto:enterprise@circleci.com)或注册 CircleCI 企业的[30 天免费试用。](https://circleci.com/enterprise/)***

*[我们的后续。](/blog/it-really-is-the-future/)T3】*