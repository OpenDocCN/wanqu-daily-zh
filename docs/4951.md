# 永远不要编辑方法，总是重写它

> 原文:[https://Dave . Cheney . net/2017/11/30/never-edit-a-method-always-rewrite-it？UTM _ source = Wanqu . co&UTM _ campaign = Wanqu+Daily&UTM _ medium = website](https://dave.cheney.net/2017/11/30/never-edit-a-method-always-rewrite-it?utm_source=wanqu.co&utm_campaign=Wanqu+Daily&utm_medium=website)



在最近的 RubyConf 上，Chad Fowler 展示了他编写软件系统的想法，这些软件系统反映了在生物系统中观察到的连续替换过程。

毫不奇怪，这种方法的首要原则是保持软件系统的组件较小——就像人类这样的复杂有机体是由数十亿个不断经历更新过程的微小细胞组成的。

由此，福勒提出了这个想法:

> 如果你的团队中有一条规则，规定你在方法被写出来后不要编辑它，你只能从头重写一遍，会发生什么？
> 
> <cite>Chad Fowler</cite>

福勒很快收回了这个建议，认为这可能不是一个好主意，然而这个想法已经在我的脑海里停留了一整天。如果我们以这种方式开发软件，会发生什么？它能带来什么好处？

*   这对软件重用有好处吗？开放一个方法来添加另一个分支条件或 switch 子句将会变得更加昂贵，而且在一次又一次地重写相同的函数之后，作者可能会试图使它在一类问题上更加通用。
*   会对函数复杂度有影响吗？如果你知道改变一个长而复杂的函数需要从头开始重新编写，这会鼓励你把它变小吗？也许你会将非关键的设置或检查逻辑放到其他函数中，以限制你必须重写的数量。
*   这对你写的测试有影响吗？有些函数非常复杂，它们包含了一个不能再简化的核心算法。如果你不得不重写它们，你怎么知道你做对了？有测试吗？他们包括边缘案件吗？有没有基准测试来确保你的版本可以和之前的版本相媲美？
*   这对你选择的名字有影响吗？当前函数的名称是否足以描述如何重新实现它？评论会有帮助吗？目前的评论是否给了你足够的指导？

我同意 Fowler 的观点，不可变源代码的想法可能是行不通的。但是，即使你在实践中从来没有真正遵循过这条规则，如果你总是抱着不可改变的心态来编写函数，对你的程序的质量、可靠性和可用性会有什么影响呢？

* * *

*注:*福勒讲的是方法，因为在 Ruby 中，一切都是方法。我更喜欢谈论函数，因为在 Go 中，方法是一种超过函数的语法糖。出于本文的目的，请将函数和方法视为可互换的。

