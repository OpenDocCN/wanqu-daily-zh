# 什么造就了良好的工程文化

> 原文:[http://www . the effective engineer . com/blog/what-makes-a-good-engineering-culture？UTM _ source = Wanqu . co&UTM _ campaign = Wanqu+Daily&UTM _ medium = website](http://www.theeffectiveengineer.com/blog/what-makes-a-good-engineering-culture?utm_source=wanqu.co&utm_campaign=Wanqu+Daily&utm_medium=website)



我问工程候选人的一个最喜欢的面试问题是告诉我他们喜欢和不喜欢他们以前公司的工程文化的一件事。我已经采访了 500 多人——他们中的许多人来自脸书、谷歌、亚马逊、Palantir 和 Dropbox 等顶级科技公司——随着时间的推移，这个面试问题让我了解到优秀的工程师在寻找什么，他们在试图避免什么。回想一下面试的回答，以及我过去七年在 Google、Ooyala 和 Quora 工作的经历，我总结了团队可以为建立良好的工程文化做的十件事。

## 1.优化迭代速度。

快速的迭代速度增加了工作动力和兴奋度。部署代码和推出功能的基础设施和官僚障碍是工程师在面试中列举的最常见和最令人沮丧的原因。

从组织上来说，快速迭代意味着给予工程师和设计人员灵活性和自主权，无需征得许可就能做出日常决策。当我在谷歌的时候，任何用户可见的对搜索结果的改变，即使是低流量的实验，都需要 Marissa Mayer 在每周的 UI 审查中批准。不用说，尽管这让谷歌保护了自己的搜索品牌，但它极大地阻碍了创新。优化迭代速度也意味着有定义良好的产品发布流程，这样在投入大量时间后就不会意外取消。

在基础设施方面，优化迭代速度意味着建立连续部署以支持快速验证，高测试覆盖率以减少构建和站点损坏，快速单元测试以鼓励人们运行它们，快速和增量编译和重新加载以减少开发时间。值得特别一提的是持续部署，即提交立即投入生产。在 Quora 上使用它之前，我很难接受它对迭代速度的好处超过了网站崩溃的风险，至少对小型工程团队来说是这样。人们对新功能更感兴趣，也更有动力去修复漏洞，因为变化会很快带来实时流量。与一周或更长时间的批量更改相比，对于一个狭窄的提交代码窗口来说，推理和查明错误的来源要容易得多。

对于团队来说，快速的迭代速度意味着有一组强有力的领导者来帮助协调和推动团队工作。决策中的关键利益相关者需要有效地做出决定，并致力于他们的选择。借用带领 49 人队夺得 3 次超级碗的领袖比尔·沃尔什的一句话，强有力的领袖需要“承诺、爆发、恢复”，这意味着承诺一个攻击计划，执行它，然后对结果做出反应。优柔寡断的团队只会导致个人努力的失败。

## 2.坚持不懈地向自动化推进。

在他的技术演讲[“扩展 Instagram”](http://www.scribd.com/doc/89025069/Mike-Krieger-Instagram-at-the-Airbnb-tech-talk-on-Scaling-Instagram)中，insta gram 的联合创始人迈克·克里格(Mike Krieger)将“优化最小化运营负担”作为他的 13 人团队在将产品扩展到数千万用户时学到的关键一课。<sup id="fnref:instagram">随着产品的增长，每个工程师的运营负担也会增加，这可以通过用户与工程师的比率或者功能与工程师的比率来衡量。例如，脸书以宣扬每个工程师支持超过 100 万用户等扩展指标而闻名。</sup>

自动化解决方案和编写重复性任务的脚本非常重要，因为它们让工程团队能够专注于实际的产品。确保服务在出现故障时尽可能自动重启，并在流量高峰时轻松快速地复制服务，是管理大规模复杂性的唯一明智方法。在短期内，总是有一个诱人的权衡，即手动应用快速创可贴，而不是自动化和测试长期修复。

Etsy 的座右铭“测量一切，测量一切”<sup id="fnref:etsy">及其对开源监控和图表工具的支持，如 [graphite](http://graphite.wikidot.com/) 和 [statsd](https://github.com/etsy/statsd) 强调了自动化的一个重要方面——自动化必须由数据和监控驱动。如果没有监控和日志来了解什么、如何或为什么出错，自动化是困难的。一个好的后续座右铭是“测量一切，测量一切，尽可能地自动化。”</sup>

## 3.构建正确的软件抽象。

我的麻省理工学院教授兼本科生研究顾问丹尼尔·杰克逊很好地抓住了软件抽象的重要性:

> “挑对了，编程会从设计自然流出来；模块将有小而简单的接口；新的功能不需要大规模的重组就能适应。选择错误的接口，编程将会是一系列令人讨厌的惊喜:界面将变得巴洛克式和笨拙，因为它们被迫适应意料之外的交互，甚至最简单的改变也将难以做出。”

让成千上万的工程师在谷歌构建可扩展系统的部分原因是，像杰夫·迪恩和桑杰·格玛瓦特这样真正聪明的工程师构建了简单但通用的抽象，如 [MapReduce](http://research.google.com/archive/mapreduce.html) 、[s table](http://www.quora.com/What-is-an-SSTable-in-Googles-internal-infrastructure)、[协议缓冲区](http://code.google.com/p/protobuf/)等等。允许脸书工程扩大规模的部分原因是对类似核心抽象的关注，如[节俭](https://thrift.apache.org/)、[抄写员](https://github.com/facebook/scribe)和[蜂巢](http://hive.apache.org/)。允许设计者在 Quora 上有效地构建产品的部分原因是 [Webnode 和 Livenode](http://www.quora.com/Shreyes-Seshasai/Posts/Tech-Talk-webnode2-and-LiveNode) 非常容易理解和构建。

保持核心抽象的简单和通用减少了对定制解决方案的需求，并增加了团队对通用抽象的熟悉和专业知识。Memcached、Redis、MongoDB 等系统越来越受欢迎，越来越可靠。减少了构建定制存储和缓存系统的需求。将团队的注意力集中在少数核心抽象上，而不是分散在许多特定的解决方案上，这意味着公共库变得更加健壮，监控变得更加智能，性能特征得到更好的理解，测试变得更加全面。所有这些都有助于简化系统，减轻运营负担。

## 4.通过代码评审培养对高代码质量的关注。

维护高质量的代码库可以提高整个工程团队的生产力。更干净的代码更容易推理，更快开发，更容易修改，更不容易出错。一个健康的代码审查过程使这成为可能。

无论是提交前还是提交后，为及时的代码评审建立一个过程，可以在几个方面提高代码质量。首先，知道有人将审查您的代码，并且提交写得很差的代码可能会让您的团队成员失望，这种同辈压力是对粗制滥造、不可维护或未经测试的代码的强大威慑。第二，代码评审为代码评审者和作者提供了相互学习的机会，以写出更好的代码。

如果代码评审对于工程团队的其他成员来说是容易访问的，那么评审也带来了以下好处:a)增加了及时评审代码的责任，b)允许团队成员——特别是新成员——模仿他人良好的代码评审，以及 c)加速最佳编码实践的传播。

敏捷团队没有时间花在代码评审上的反驳忽略了技术债务，这些债务很容易从糟糕的代码中积累。Ooyala 在创业初期，曾经在没有代码审查的情况下，为推出尽可能多的功能进行优化；结果是，虽然最初的产品可能会更快地进入市场，但最终的代码变得难以修改，我们花了一年多的时间来重写脆弱的代码，以消除技术债务。

以谷歌的规模，它会对所有代码进行预提交代码审查，但较小的团队不需要如此全面或严格，也不是所有代码都需要同样严格地审查。我在的时候，Ooyala 后来通过电子邮件对核心或有风险的变更进行提交后评审。在 Quora，我们在 [Phabricator](http://phabricator.org/) 中进行了所有的代码评审，大部分是提交后的评审，并对模型或控制器代码和视图代码应用了不同的标准；对于敏感的代码或者来自新工程师的代码，我们或者进行提交前审查，或者试图在代码提交后的几个小时内进行审查。

## 5.保持一个相互尊重的工作环境。

同伴之间的尊重是任何开放交流的基础。一个人们乐于质疑彼此观点的地方是一个通过辩论形成合理观点的地方。人们容易被冒犯的地方是关键反馈被隐瞒的地方。

1948 年，亚历克斯·奥斯本(Alex Osborn)概述了过去几十年在工作环境中流行的常见头脑风暴法，参与者聚集在一起，搁置批评和负面反馈，集体汇集创意，而不用担心被评判。尊重地推迟判断是这种头脑风暴会议的关键。最近的心理学研究已经开始推翻奥斯本的方法，表明在头脑风暴会议中鼓励辩论实际上有助于避免群体思维，产生更有效的想法。根据这项研究，一个相互尊重的环境变得更加重要，这样攻击就指向思想而不是人身攻击。

工程通常跨越广泛的领域(系统、机器学习、产品等。)而且不是每个人在每个领域都有相同的专业知识。事实上，一个强大的团队可能应该有在某些领域特别强大的人，即使他们最终在其他领域有所欠缺。这有时会让系统工程师很难评估产品工程师的熟练程度，但在健康的工程文化中，尊重这些差异而不仅仅基于自己的优势进行判断是很重要的。

## 6.建立代码的共享所有权。

虽然个人精通代码库或基础设施的各个部分是很自然的事情，但是没有人会觉得他们拥有或者是任何一个部分的唯一维护者。虽然让个人成为拥有特定领域一年或更长时间的专家可能会在短期内提高效率，但从长远来看，这种方法最终会造成伤害。

从组织上来说，共享代码所有权有三个好处。首先，保持总线因子<sup id="fnref:busfactor">大于 1 可以减轻维护者的压力，并在维护者离开的情况下降低团队的风险。这也使得一个人很难无忧无虑地休假。我当然不会怀念我是 Ooyala 的日志处理器的唯一维护者的日子，当我在夏威夷的火山上度假徒步旅行时，我收到了传呼。</sup>

第二，共享所有权让那些在特定领域涉猎不深的工程师能够贡献新的见解。它让工程师摆脱了被某些项目束缚的感觉，并鼓励他们从事多样化的项目，这有助于保持工作的趣味性，并促进员工的学习和积极性。从长远来看，它降低了一些工程师感到停滞不前并决定离开的组织风险。

第三，共享所有权还为多个团队成员在需要更快完成战略目标的时候一起处理高优先级问题(敏捷开发的一种技术)奠定了基础。在所有权孤立的情况下，负担通常会落在一两个人身上。

许多工程组织在早期犯的一个错误是，在团队还很小的时候，将整个团队分成由技术领导组成的子团队。子团队建立所有权之墙，减少跨越这些墙的动机，因为个人可能会被他们的子团队的目标所评估。我在那里的时候，Ooyala 有子团队，我错过了一件事，那就是和其他团队的一些人一起工作的机会；从那以后，他们采用了敏捷开发过程，更加关注共享代码所有权，我听说这在工作快乐和生产力方面取得了很大进步。我喜欢 Quora 早期的一个方面是，我们强调项目胜于团队，我有机会参与从用户增长、机器学习、审核工具、推荐、分析、网站速度和垃圾邮件检测等项目。

## 7.投资自动化测试。

单元测试覆盖和某种程度的集成测试覆盖是管理大型代码库和一大群人的唯一可伸缩的方式，而不会经常破坏构建或产品。自动化测试为提高代码质量所需的大规模重构提供了信心和有意义的保护。在缺乏严格的自动化测试的情况下，由工程团队或外包测试团队进行手动测试所需的时间很容易变得令人望而却步，并且很容易陷入一种害怕改进一段代码的文化，因为它可能会崩溃。

实际上，随着团队的成长，自动化测试是使连续部署工作的一个需求。随着产品的增长，代码库的规模会随着时间的推移而增长，但是团队成员对代码库的平均熟悉程度会随着新人的加入而降低。测试和验证最容易由原始代码作者在代码记忆犹新时完成，而不是由那些试图在几个月或几年后修改代码的人来完成。鼓励强大的单元测试文化将验证的责任转移给了作者。

## 8.分配 20%的时间。

Gmail 源于 Paul Buchheit 的 20%项目，他在一天之内就拼凑出了第一个版本。 <sup id="fnref:gmail">Google News、Google Transit、Google Suggest 也作为 20%项目开始启动。在谷歌工作期间，我用 20%的时间编写了一个 python 框架，使得构建搜索页面演示变得非常容易。虽然谷歌现在 20%的时间可能比公司早期的效率低，但让工程师花 20%的时间研究他们产品地图以外的东西仍然是小型工程组织创新的摇篮。</sup>

当我在那里的时候，Ooyala 官方没有 20%的时间，但我还是花了一些时间，为 Flex 和 Actionscript 编写了一个命令行构建工具，加快了团队的构建时间。我完成它的时候，Adobe 的 Flex Builder 工具链开始退化，即使工程团队的规模增加了两倍多，这个工具仍然在使用。Atlassian 在试验了一年后采用了 20%时间。脸书喜欢的 20%时间的变化形式是定期的黑客马拉松，这是 Ooyala 后来增加的，这是一种通宵活动，规则是你可以做除了正常项目之外的任何事情。

自上而下的产品规划方法，虽然对于关注公司的整体方向是必要的，但却不能解释来自更接近实际的工程师的众多想法。只要工程师对他们 20%的时间负责，并专注于可能具有高影响力的变化，这些项目就可以在进展中向前迈出一大步。如果没有官方规定的 20%的时间，工程师和设计师仍然有可能尝试疯狂的想法，但要困难得多——专注的工程师和设计师基本上必须找到周末或假期来做这件事。

## 9.建立学习和持续改进的文化。

学习和接受足够的挑战是心理学教授米哈里·契克森米哈所说的“心流”状态的必要条件，在这种状态下，人们完全专注于自己正在做的事情，甚至忘记了时间。由更快的迭代周期提供的直接和即时的反馈循环是另一个需求。

每周一次的技术讲座为工程师们提供了分享他们的设计或成果的论坛，为工程师们创造了一个为自己的工作感到自豪的机会，也为团队提供了一个在他们的直接工作范围之外学习更多知识的机会。记录内部流程，如电子邮件服务如何工作或如何对搜索服务进行排名更改，也使工程师能够自己学习和探索新事物，很好地补充了 20%的时间。在 Quora，我们通过运行 Quora 的一个内部实例来做到这一点，在这个实例中，我们会询问与产品和开发相关的问题。

建立学习文化的必然结果是关注指导和培训，以确保每个人都拥有成功所需的基本算法、系统和产品技能。一个工程组织发展得越快，在招聘上花费的精力越多(尤其是大学招聘)，在指导和培训上需要投入的精力就越多。对于一个单独的导师来说，在新员工工作的前四周，每天花一个小时似乎是一种负担，但这种投资不到新员工一年总时间的 1%，并且在决定这个人是否成功方面具有重要作用。

## 10.雇佣最好的。

雇佣最优秀的员工是列出的许多其他理念的基础。如果你认为一个人是 B 级工程师，你很难尊重他。如果你不相信某人的产品直觉，就很难给他们产品开发的自主权。没有足够的工程经验，很难识别要构建的正确抽象。如果没有其他聪明人来挑战你的想法并引导你走向简单，你很容易陷入构建复杂事物的陷阱。

史蒂夫·乔布斯在硅谷首创了一种说法，叫做“A 级玩家雇佣 A 级玩家”。b 玩家雇佣 C 玩家。”专注于招聘和雇佣合适的人对有效发展一个工程组织来说是困难但关键的。曾任脸书工程经理和总监的王宜山(Yishan Wong)认为，招聘必须是工程组织中每个人的首要任务，不仅是经理，工程师也是如此。<sup id="fnref:yishan">他还非常正确地指出了“雇佣最好的”和“雇佣你面试过的最好的候选人”之间的区别</sup>

在 Ooyala 的早期，我们被大量的入境客户工作压得喘不过气来，以至于我们几乎屈服于降低招聘门槛，这样我们就可以雇佣足够多的人来完成我们所有的工作。我很高兴我们没有这样做，因为来自低质量代码和团队中较弱工程师的技术债务最终会伤害团队和产品。

建立良好的工程文化当然需要大量的工作，但是由此产生的工作环境是非常值得的。

这篇博文基于我最初在 [Quora](http://www.quora.com/) 上写的[回答](https://www.quora.com/Software-Engineering/What-makes-a-good-engineering-culture/answer/Edmond-Lau?share=1)。

*正在寻找一位关于工程文化的演讲嘉宾，参加技术讲座或异地工程活动？联系我关于[演讲约会](/speaking)。*

