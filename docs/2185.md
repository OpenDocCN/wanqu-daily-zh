# 迈克尔羽毛-杀死代码

> 原文:[https://michaelfeathers.silvrback.com/to-kill-code?UTM _ source = Wanqu . co&UTM _ campaign = Wanqu+Daily&UTM _ medium = website](https://michaelfeathers.silvrback.com/to-kill-code?utm_source=wanqu.co&utm_campaign=Wanqu+Daily&utm_medium=website)

![Silvrback blog image](../Images/d32af13d7ed00042e3091f459ff7d2b0.png)

经济学是理解问题的一个很好的框架，但它也能模糊许多问题。软件开发社区多年来一直反对将 IT 视为成本中心的观点。我们希望将其视为创造价值的投资。然而，尽管我们很想这么看，我们还是把代码说成是一种负担。有经验的开发人员知道，如果我们能用更少的代码交付价值，我们会更好。

围绕技术债务的许多讨论都有同样的问题。我们把代码，尤其是熵伤痕累累的代码，视为一种负担，但我们无法回避它产生价值的事实。有时候我觉得我们最好采取这样的态度，代码的问题在于它有太多的价值。固定投资后，可以保持生产多年，赚钱。它可以在产品中停留的时间远远超过任何开发人员能够记住它是如何工作的时间，这就是问题的开始。当你修改你不理解的东西时，很有可能你会引入错误——而且是在克服了不确定自己在做什么的恐惧和压力之后。

对代码理解不足是当今的标准。我们已经花了几十年的时间专注于编写更好的代码的方法，以及重构代码的方法，但我们不能回避这样一个事实，即我们不断编写更多的代码，它不会消失——除非我们主动杀死它。

杀死代码需要什么？

这比看起来要难。首先，我们需要知道某个特定区域的代码是死的。在软件开发中，我们使用术语代码覆盖率来描述源代码被测试套件覆盖的程度。我们需要做的是相当于在产品中运行覆盖率的工作，通过暗示来发现在系统运行时没有使用的代码区域。您不能使用这些信息来“证明”某个代码区域是死的，但是您可以找到尽管您的系统收到数百万个请求，但每周只执行一次或两次的代码区域。在这一点上，你有选择。您可以决定代码所做的工作是否真的有必要。在这些情况下，也许可以改变系统，让用户转换到不同的代码路径。如果可以，您可以删除该代码。

专注于罕见的案例是强大的。首先，它们可能风险更低。如果您选择通过重构、重写或消除这些路径来处理支持这些领域的代码，您不太可能让系统嘎然而止。你也选择了解决代码本身没有回报的问题。代码有非常真实的运行成本。如果我们根据系统中每一行代码的使用情况对其进行加权，我们可以看到一些代码是有开销的。无论我们能做什么来消除它或使它不太可能占用我们的时间，对我们来说都是胜利。

*生产中的覆盖*不一定意味着在生产运行中运行代码覆盖工具，尽管如果你不介意执行成本，你可以为你的流量的某个子集运行代码覆盖工具。通过一些巧妙的日志记录，您可以获得相同的信息。确保在您怀疑的代码区域进行日志记录——您认为不经常运行的区域。然后，从报告中寻找他们的缺席。你获得的洞察力可以帮助你修剪你的系统。