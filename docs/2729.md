# Rails 赢了:房间里的大象| AkitaOnRails.com

> 原文：<http://www.akitaonrails.com/2016/05/23/rails-has-won-the-elephant-in-the-room?utm_source=wanqu.co&utm_campaign=Wanqu+Daily&utm_medium=website>

### 接受现实

事实是:Rails 是为 Basecamp 量身定制的。

我们都知道，或者我们应该知道。类似 Basecamp 的应用并不太难做，至少在架构上是这样的。你不需要拥有超级高并发和并行原语的高级高性能语言。还有一个现实是，80%的 web 应用都是类似 Basecamp 的(披露:我多年咨询经验的感受)。这也是 Rails 能坚持到现在的原因。

这就像内容管理系统，或 CMS。大部分都是类似博客的系统。为此，你应该继续安装 Wordpress。反对 Rails 的理由同样可以用来反对 Wordpress。你永远也不应该把 Wordpress 改造成博客系统以外的东西。想把它做成高流量的电商，你就吃亏了。

说明一下:Wordpress 拥有我见过的最令人反感的源代码之一。我讨厌维护那个代码库。我很抱歉，如果任何来自贡献者的 Wordpress 基础的人正在阅读这篇文章，我说这些没有恶意。你知道吗？世界上可能有一半的 CMS 是 Wordpress。超过一百万个网站。

然后你就有了 Magento2 的案子。对原始 Magento 进行了大规模重写，使用了所有其他人都不喜欢的可怕的 Zend 内容。但是它很大。如果您需要一个快速的电子商务交钥匙解决方案，不用再找了。

Wordpress 插件能和 Magento 一起工作吗？没有。他们是两个分散的、独立的和孤立的社区。但是它们都产生了大量的收入，这些收入弥补了它们之间的冗余成本。这还没算上德鲁巴，朱姆拉。PHP 是一个由互不相连的岛屿组成的海洋。移民法严格的国家。

对于 Javascript 世界来说，分段并不陌生。但这是一种不同的价值创造。脸书，谷歌，微软，他们都想成为快速发展的千禧一代的思想领袖。这是一项长期战略。而这个游戏的要素之一就是浏览器。但不仅仅是在 Chrome vs Firefox vs IE 方面，还包括应用程序是如何实现的。

脸书想出了反应。谷歌想出了聚合物和棱角。Node 的人经历了与 Joyent 的权力斗争，这几乎导致进一步的分裂，但他们满足于 [Node 基金会](https://readwrite.com/2015/02/10/joyent-node-js-foundation/)。

苹果对 Adobe 的 Flash 大打出手，直到现在谷歌才在 Chrome 中关闭 Flash，但他们都在掠夺它在网络开发社区中带来的所有关注。

苹果希望 native 取得成功，Swift 成为引领这一切的语言。谷歌有相互矛盾的策略，因为他们希望本地即时应用程序取得成功，但如果失败，B 计划将继续让他们用 Angular 主导基于 HTML5/CSS3 的网络应用程序。脸书不想让他们的命运被苹果和谷歌之间的权力斗争所决定。

这是一场正在展开的复杂的权力斗争，你可以看到这与技术实力无关，也与价值创造无关。这是关于自我，影响力和权力。非常适合优酷一代。如果你没有注意到的话，网络技术在这场围攻中被扣为人质。

还有一个问题是，Ruby 的未来现在与 Rails 紧密相连。这是一个现实，如果你是一个不喜欢 Rails 的 Rubyist 迷，我为你感到难过。但没有那么多。例如，如果 Hanami 很有趣，我相信至少有一家公司投资了它。如果没人用，那么技术上再优越也没用。如果 Rom.rb 很棒就应该有人用，否则有什么意义？为什么要创造一个没人要的技术奇迹？但是如果至少有一家公司在使用它，那就有足够的理由继续下去，不管 Rails 发生了什么或者 DHH 说了什么或者做了什么。

> 人们认为，因为某种东西“技术上更优越”，所以其他人都应该盲目采用。但这不是市场运作的方式。

在所有正在发生的宇宙级事件中，如果 Ruby 一直被束缚在 Rails 上，我真的不会太担心。没有它会怎样？

所有的社区都会在某个时候面临分裂。长期保持凝聚力是非常困难和昂贵的。我认为唯一一个通过纯粹的监管力量实现这一目标的社区是微软。网络堆栈。这并不意味着没有来自外界的压力。Rails 本身在影响从 old-ASP.NET 到 ASP.NET MVC 的转变中发挥了很大的作用。现在他们终于[收购了之前的 Xamarin](https://blogs.microsoft.com/blog/2016/02/24/microsoft-to-acquire-xamarin-and-empower-more-developers-to-build-apps-on-any-device/) 。NET 可以在他们无法控制的开源平台中脱离他们的控制。

Ruby on Rails 是我见过的唯一一个“有凝聚力”的社区。好处是 Basecamp 不需要成百上千的开发者存在。一个利基市场就足够了，足以让框架通过 OSS 过程逐渐发展。这就是为什么我总是质疑工具和技术的历史和起源，以决定在哪里使用它们，而不仅仅是技术实力。

Rails 之所以有效，是因为它不需要和苹果、脸书、微软、谷歌或任何其他委员会玩政治游戏(顺便说一句，默认情况下，我从不信任委员会)。那些依赖 Rails 的人会直接做家务。Heroku，Github，New Relic，Shopify，还有很多有天赋的开发者。

### 3 市场现实法则

1.  事后很容易过度分析一些事情。10 年后，我可以很容易地找到一条最佳路径，避开路上的所有陷阱和障碍。并不意味着我是天才，只是表明我能把现在清晰可见的点连接起来。

2.  没有完美的解决方案实现。如果它真的解决了一个真正的问题，它肯定是不完美的。如果它在快速变化的市场中解决了一个真正的问题，那么它就越不完美。

3.  要么您构建工具，因为您的核心业务应用程序依赖于它，要么您构建工具来销售。前者通常比后者更适合市场。所以如果非要盲目选择，就选前者吧。

所以，首先，我总是更喜欢那些由那些真正依赖它们的人制作的工具，它们能解决一个真正的问题。否则，鞋匠的儿子最后会光着脚。例证:如果有必要，我肯定会使用 Angular。但我永远不会开始一项新的业务，仅仅依靠 Angular 生存。为什么？因为谷歌不需要。它没有眨眼就放弃了 GWT，它没有再三考虑就决定以不兼容的方式将 Angular 2 重写为 Angular 1，等等。

其次，我会一直看到还有哪些外部因素会影响技术的命运。想象一下，我花了很多时间为 Grunt 编写脚本、库和工具。然后人们决定它是坏的。现在 Gulp 是更好的选择——你会发现很多技术上的原因。现在你花了很多时间来写你所有的东西。然后，由于许多其他原因，人们决定 Webpack 是最好的选择。你又来了。NIH(非发明-此处)综合征。

这显然是一个小泡沫。又是郁金香。有太多的大玩家(脸书、谷歌、苹果、微软、Mozilla 等)有着雄厚的财力、充足的时间和资源。这就是实验室在公共场合的工作方式。很多很多实验性的替代方案，一些企业盲目地选择了本周最佳的销售方案。

有时候这种情况使得 ASP.NET 对微软阵营的垄断和 Rails 对 Ruby 阵营的垄断看起来无关痛痒。是的，我把 Rails 比作。网在这里。它们是最具可比性的两个堆栈。可能堪比 Java 阵营的春天派。如果你记得历史，Spring 就像 Java 社区中的 Rails，在 2002 年对抗庞大复杂的官方 J2EE 堆栈。然后，春天本身成为了新的 J2EE 式的庞然大物。

这是一个千年前的 dillema:

> "你要么死得像个英雄，要么活得足够长，看着自己变成恶棍。"

### 为什么 Rails 现在成了问题？

正如我之前所说，我同意 Solnic 概述的几乎每个技术问题。

Rails 的确是大卫·汉森(DHH)的创意。DHH 是一个非常自负的人，他有自己的事业要经营。你不能指望任何人在任何时候都是合理的，特别是一个从零开始推动事情的人，无论是业务还是技术平台。

当它开始的时候，人们从 Java 叛逃。NET、PHP 甚至 Python，他们都承认 Rails 与 ASP.NET 的 J2EE、Plone 相比是多么有趣。它不仅提供了生产力，还提供了技术享受。我们在讨论动态语言的奇妙世界、开放课程、即时注入行为(又名[猴子补丁](https://m.signalvnoise.com/provide-sharp-knives-cc0a22bf7934#.zcxl5lbh8))，我们都站了起来，放弃了所有不必要的讨论。

我们不能满足于 Ruby 的修复，放弃我们用一种不像 PHP 或 Java 或 C#那样官僚主义的语言所能完成的所有类似 Perl 的魔法。众人都笑了。

从 2004 年到 2006 年的黄金时代见证了一股永无止境的对类似 Perl 的编码能力的自慰。我们通过 [Why，幸运僵硬](https://poignant.guide/)最晦涩的黑魔法学习了 Ruby，记得吗？除了干净的模块化架构，它什么都不是。

然后我们进入白银时代，从 2007 年到 2011 年左右。Rails 实际上走得太远，太快了。突然我们看到大公司从各处冒出来！Twitter，Github，Engine Yard，Heroku，Zendesk，Airbnb，大家都喝了 Rails 酷援。有机会为企业提供一些东西。Merb 走在了时代的前面，但它的定位是错误的。我确实认为，在那种情况下，直接对抗全能的 Rails 是不明智的。你应该预料到过度反应，它确实来了，而且是一个迅速的打击。老实说，我在 2009 年和 2010 年对 Rails 3 的伪重写、伪合并是否真的会实现做了充分的准备。

2011 年到 2016 年是青铜时代，一个苦乐参半的时期。那是因为出现了很多新的语言，最终达到了“可用”的状态。从 JS 的 V8 和 Node.js，到 Rust，到 Clojure，到 Elixir，甚至一些过去的宝石也开始得到关注，比如 Scala，甚至 Haskell。最重要的变化是:2010 年出现了围墙花园应用程序商店，这是一种面向智能手机和平板电脑的商业应用程序。忘了网络开发吧:手机得到了一切。

这时候所有的大公司都开始展示他们的雄厚财力。苹果发布 Swift。谷歌发布 Dart，Angular，Go。微软发布了 Typescript，ASP.NET MVC，然后是 vNext，忙着开发 Windows 10。脸书通过发布 React 和 React Native 进入游戏。

Rails 现在被认为是一个“问题”,原因与当初让它流行的原因完全一样。而这是任何技术都必然会发生的。

但是你不能对 Rails 的架构做太多的改变，否则你就有可能破坏现在生产中部署的大块项目。当有人不得不重写一个项目的大块内容时，你也可以考虑用其他的东西完全重写。

许多人正是这样做的，特别是对于 API 和实现为与 API 对话的 spa 的 web 应用程序。API 可以用 Go、Elixir、Scala 编写，完全不用 Ruby。你失去了 Rails 生态系统的快速周转，但如果你能负担得起(你是一个财大气粗的独角兽创业公司)，为什么不呢？

但是，对于 90%的中小型项目来说，使用 Rails 和所有可用于 Rails 的库，您仍然可以获得最大的收益。这就像是说，如果你想建立一个博客，去使用 Wordpress，你将会为你有限的资源获得最大的收益。不要想入非非，用 Go APIs 和 React 从头开始写 SPA 博客。可行，但不值得。

如果你是一个已经使用 Rails 一段时间的中型公司，首先要确保你坚持基本的最佳实践。如果还没有的话，添加测试和规格。稳步重构代码，消除重复，升级 gems。然后，您应该考虑添加一个抽象层，比如 [Trailblazer](https://trailblazer.to/) ，并可能考虑将您的应用程序的部分组件化为 [Rails 引擎](https://leanpub.com/cbra)，或者如果可能的话，将这些部分移除到单独的 [Rails-API](https://github.com/rails-api/rails-api) 应用程序中以供使用。但是根据需要，一步一步来。

> 人们很少从《生活大爆炸》从头开始的重写中受益。

### 结论

所以，对 Solnic 这样的开发者来说，Rails 社区可能是一个令人沮丧的地方。但这也是一个很难戒掉的瘾，因为 Rails 比任何其他新的和花哨的平台上的任何其他竞争对手都大得多，你总是为自己处于劣势而感到难过。

Rails 在 5 年内从弱势变成了主流。这可能是 web 框架有史以来最快的增长速度。从 1995 年到 2003 年，一个 web 开发人员的生活并不是特别有趣。Rails 做了很多改进。如果有人认为他们可以做得更好，就去做。写 Rails 有什么意义？不仅仅是代码与代码竞争，结果也应该与结果竞争。

活动记录的架构确实会对大约 10%的案例造成严重影响。到目前为止，主动支持没有更好的替代方案，仅仅删除它不会为最终用户带来任何有价值的东西。将 Active Record 这样的大组件替换为 DataMapper 或 Rom.rb 这样的“更好”的默认组件不会带来太大的价值，尤其是对于现有的数百个应用程序而言。你告诉每个人重写所有的东西。如果我必须重写，我肯定会使用 Rails + Trailblazer 开发一个新的应用程序，或者直接使用 Hanami。但是大多数人会决定放弃 Ruby。

主动记录会更好吗？当然可以！我们有老数据映射器，Sequel，ROM.rb 为证。但真正的问题是:在 2004 年它刚创立的时候，它能做得更好吗？我不这么认为。现在，即使是数据映射器的创造者也支持无 ORM。2004 年,“NoSQL”甚至还不存在。那时我们最好的是 Hibernate，远在 JPA 之前！从各方面来看，活动记录仍然比平均水平好得多。但如果你很大，你应该小心。仅此而已。

其他社区将面临我们现在在 Rails 社区面临的同样困境。这是必然的。当你有一个小社区时，一切都变得容易得多，即使你打碎东西也不会太糟糕。维持一件超出你最乐观预期的事情要困难得多。

我确实理解 DHH 采取的保守做法，即不制造大的混乱。如果他这样做是因为他相信保守的举措，还是因为他不了解更好的架构选项，这不由我来判断，但这是一个有效的举措，将疏远像 Solnic 这样的高级开发人员，但仍然允许初学者直接进入其中，而不用担心现在有太多的抽象。

更新:DHH 稍后对此部分进行了评论:

人们忘记了抽象对于高级开发人员来说是非常好的，因为他们一直缺乏抽象。但是如果一开始就有太多的架构选择，初学者总是会吃亏。理解 GoF 设计模式、数据驱动设计、SOLID、企业架构等是非常重要的。有经验的人经常忘记他们自己是初学者时的学习曲线，那时 Rails 是如此有吸引力，如此性感。还记得那种感觉吗？当你知道某个善良的女巫留下了超级有用的黑魔法时，你会有成就感吗？

rails 为初学者赢得了简单性，也为有经验的人提供了类似“Rails”的指导，并且为更高级的开发人员提供了 T2 可接受的灵活性。面对众多试图从零开始重建一切的较小的替代者，它能再维持 10 年吗？时间会证明一切。

我觉得用鲍勃·迪伦来结尾会很合适:

> 过来聚集在人们周围
> 
> 无论你漫游到哪里
> 
> 并承认水域
> 
> 在你身边成长
> 
> 这么快就接受了
> 
> 你会湿透的。
> 
> 如果你的时间给你
> 
> 值得保存
> 
> 那你最好开始游泳
> 
> 否则你会像石头一样沉下去
> 
> 因为时代在改变。
> 
> ...