# 增长你的技术堆栈:何时说不| Cloudbees 博客

> 原文：<https://blog.codeship.com/growing-tech-stack-say-no/?utm_source=wanqu.co&utm_campaign=Wanqu+Daily&utm_medium=website>



您团队中的某个人有一个令人兴奋的建议，要介绍一项新技术。但这是个好主意吗？

人们往往更容易看到眼前的利益，而不是眼前的风险或长期的任何东西。本文着眼于在软件开发和运行中实现新技术时要问的问题和要采取的预防措施。

首先，要认识到不同的技术会带来不同的风险。问问你自己——最坏会发生什么？还有什么痛苦是不可避免的？也要问——可能发生的最好结果是什么？最后，我如何以最小的危险实现这一点？

风险简介中最大的区别因素是这个新想法在技术堆栈中的位置:

*   一个人用的程序风险低。

*   测试工具对于探索来说是相当安全的。

*   在生产中运行的任何东西(包括监控和日志记录)都有更大的风险...

*   或者将代码投入生产的任何东西(供应、构建、部署)。

*   新的编程语言带来了特殊的负担。

*   移动数据的组件需要勤奋的支持。

*   最后，小心不要信任新的生产数据记录系统。

该光谱如下图所示。

还不害怕？让我们详细考虑这个风险谱中的四点。

## 非常低的风险:本地开发商公用事业

开发就是自动化，快开发者自动化开发。风险最低的技术由我们在自己的机器上运行。任何我可以加快速度的重复性任务都会给我的一天增加几秒钟，而且成本很低。

这里有一个极端的例子:命令行别名。我每天输入“git status”一百次，所以我用“alias gs='git status '”配置我的 shell。这是一个微小的优化。它只影响我:我的团队中没有其他人，没有客户。

当我达到一个好的优化时，它可以在整个团队中传播。这是最好的结果。整个团队在以后的生活中都会得到生产力的提升。

最坏能发生什么？我使用另一台计算机，不记得如何询问哪些文件有本地更改-似乎不太可能。

实际上，情况更糟一些:在一些 Linuxy 虚拟机上，我在每个命令提示符下键入“gs”的反射会让我进入一个名为“ghostscript”的程序，这完全不是我想要的，然后我必须记住如何退出它，然后我会感到沮丧和心烦意乱，并诅咒愚蠢的 ghostscript。经过足够长的时间后，我编辑该机器的 shell 配置以添加别名。

现在我的指纹在上面；牺牲了一致性，而且整个公司的命令提示有点不可预测。即使是这么小的工具也会有一些后果。

您应该禁止您的开发人员创建别名或安装他们个人认为有用的程序吗？不要！除非你喜欢喜欢重复多于自动化的开发人员。如果一个人回避自动化，他们能成为一个好的自动化者吗？

在对一项技术说“不”之前，考虑一下对保留的影响。什么样的开发商会想留下或离开？我曾经在一家公司工作，安装文本编辑器的正确流程包括填写表格和等待一个月的批准。我在那里工作的时间不长。

#### 低风险类别:

*   只会影响选择使用它的人

*   如果我们停止使用它，我们就会回到以前的状态

**Pro:** 团队中的其他人学习了一个他们不知道的工具，整个团队的生产力就上去了。

反对意见:很难切换环境，因此更难配对。

**不可避免的成本:**仅仅是设置。

激励措施:开发人员觉得自己有能力实现自动化。

## 中度风险 1:部署基础设施

有什么比自动化我的工作更好？为我的整个团队自动化任务。这有什么风险？如果这个工具坏了，我的整个团队都会被打乱。

开发的输出不是代码:它是生产中的工作软件。这两者之间有很大的差距。DevOps 将这与自动化联系起来。基础设施工具构建可执行文件，运行测试，将新版本投入生产，并观察以确保它们继续工作。

这些是最近创新的热门领域。持续改进在这里有很大的影响——任何不进步的公司都会落后，失去竞争优势。但是代价是什么呢？

这项新技术可能很小:GitHub webhooks 可以在代码提交时触发 CI 构建。或者强制代码格式化的质量检查提交挂钩。

它可以更大:Splunk 用于日志聚合，Ansible 用于声明式配置。它甚至可能是 Docker——一个需要担心的整个生态系统。你写的那个 bash 小脚本也算！为每个构建/测试/部署运行的任何东西都是团队核心操作的一部分。

最坏能发生什么？它会坏掉，你无法展开。那很糟糕。非常糟糕，如果它与一些紧急的生产错误同时发生。

当部署过程由于其他原因中断时，每个新工具都是我们必须检查的项目。这是一个人必须了解的关于代码如何进入生产的另一件事。通过频繁运行部署来降低这种风险，这样潜在的意外就不会持续。

有什么不可避免的苦差事？我们启动时还有一件事要做。现代建筑趋势包括更多、更小的项目，因此加速旋转更加频繁。要么我们将它添加到我们的项目设置自动化中，要么我们每次都这样做并排除故障。

关键的一点是:公司里必须有人了解这个工具。必须有人知道它是如何工作的，它适合在哪里，以及它为什么在这里。

如果你正在介绍这项创新，那个人就是你。为了降低风险，不能只靠你。你的队友有兴趣了解一下吗？文档有多好，让他们可以从你之外的来源了解它？bash 脚本可读性如何？

我们的每一件工具都需要所有权。对于我使用的工具，我拥有它，没有问题。对于每个人都使用的工具，“谁拥有它？”不太明显但更重要。

生产过程中的任何程序都需要小心和维护；如果它的代码不变，它周围的世界就会改变。工具升级了。环境改变了，业务限制也改变了。责任不会随着实现而结束:当一个程序不再运行时，责任也就结束了。

如果这听起来很痛苦，别忘了问自己，最好的结果会是什么？部署自动化比节省时间重要得多。它改变了激励机制，让变革变得更安全、更有吸引力。这一点的影响远远超出了团队:整个企业都有能力进行试验并更快地前进。

影响最大的开发工具是共享的，然而共享它们会产生所有权问题。当你已经有了 DevOps 的思维模式，DevOps 团队可以提供帮助。他们可以通过提供基础设施和负责这些共享工具来提高所有其他开发人员的生产力。他们研究收益并承担风险。他们向开发团队推销使用它们。

Twitter、网飞、Lyft 和许多其他公司都这么做。对于不太关注软件的公司来说，个人开发者的主动性很重要。

#### 中度风险类别:

改变变得风险更小，痛苦更少。

**不利因素:**出现问题，生产部署受阻。

**不可避免的成本:**持续拥有和维护

激励措施:开发人员被授权改善整个部门。

## 中度风险 2:编程语言

最近编程语言遍地开花。加上微服务架构，语言的变化变得切实可行。将一门新语言引入您的生产环境意味着什么？

一门编程语言不是单独工作的。我们在编程系统中开发，语言是其中的一部分。新的语言带来了新的语法...以及新的构建工具、新的依赖管理、新的库、新的打包、新的测试框架和新的内部 DSL。

这些都可能是引入这种语言的原因。例如，ScalaTest 非常适合测试 Java 代码。Python 通过它的熊猫库进行快速的数字运算。Go 使得创建二进制文件变得很容易。

最坏的情况会是什么？生产中无人理解的代码。如果最初的爱好者离开了，其他人将需要学习这种语言或者重写这种语言。

仔细的隔离可以通过使实验代码可替换来降低风险。例如，Richard Feldman 在 NoRedInk 通过选择一个具有清晰接口的业务逻辑引入了 [Elm。这留下了一个应急计划(“用 JavaScript 重新编写”)和有限的花费在 Elm 实现上的时间成本。](http://noredinktech.tumblr.com/post/126978281075/walkthrough-introducing-elm-to-a-js-web-app)

当你把一门新语言引入公司时，你就在承担另一份全职工作。你成为当地的专家，解决问题的专家。所有的问题都是你的问题，直到团队的其他成员跟上进度。如果你不能让他们快速上手，那是不负责任的。

正如 Camille Fournier 指出的，一些公司使用多语言微服务来避免团队之间的交流。"当他们这样做的时候，他们正在切割他们的人类."如果他们没有在人群中复制这种知识，那么一个人退出，重要的知识就丢失了。

会发生什么不可避免的痛苦？整合语言系统。必须构建、测试和打包新代码以便部署。将如何监控？调试好了？许多因素影响这将有多痛苦。

如果您将 Scala 引入 Java 环境，两种 JVM 语言一旦编译后工作起来是一样的。将 Ruby 添加到 Java 环境中更加困难。如果您的部署管道是基于容器的，这就减少了痛苦。如果基础设施是特定于语言的，这将会带来伤害。在 NoRedInk，将 Elm 构建成 Rails 生态系统需要做大量的工作。

考虑围绕一种语言的工具开发得有多好，以及其他人是否已经将这种语言集成到像您这样的堆栈中，并对其进行了文档化。

这里有另一个明确的痛苦:编写的代码将被读取。

对跨越语言界限的数据流进行故障排除时，来回切换是有代价的。即使我知道所有相关的语言，在 Bash 脚本、Scala、Ruby、cloud-init、AWS Cloud Formation 之间来回切换也让我头疼...技术栈的每一部分都增加了调试的认知开销。只有当复杂性的降低大于将我的大脑切换到该工具的开销时,“工作的正确工具”才是值得的。

Avdi Grimm 曾经有意为流程的每个部分使用所有最合适的实用程序(awk、sed、make、perl ),发现在它们之间切换的负担远远超过了每个部分最大限度地简洁的好处。“正确工具”的极端可以和“唯一工具”的极端一样痛苦。

如果你真的将一种全新的语言加入到你的堆栈中，你将获得它所有的优势。可能发生的最好情况是什么？你可以从语言中学到比语法更多的东西。你可以进入它的社区。

考虑一下招聘的动机——什么样的人会愿意在这里工作，知道他们可以使用 Clojure 或 F#或 Elm？像 NoRedInk 这样的小型创业公司吸引了那些希望在 Elm 工作的热情的开发人员。当然，世界上 Scala 开发人员比 Java 开发人员少。但这些群体之间也存在天赋差异。你想吸引哪些开发商？

#### 中度风险类别:

**Pro:** 获得新的功能和新的开发者社区，拥有新的想法。

**弊:**生产中没人懂的代码。

**不可避免的成本:**部署自动化，学习整个系统的工具和库。

**激励:**留住并吸引渴望学习的人。

## 严重风险:数据库

如果我们将代码投入生产，但后来后悔了，我们可以重写代码。开始新的，停止旧的。

这很痛苦，但这并不比一开始就这样写更费力。这对于替换数据库来说是不正确的。有状态记录系统是一个严肃的承诺。

一旦数据库在生产中启动，它就拥有了您的数据。你不能开始一个新的，停止旧的，让一切都像以前一样继续。你必须进行迁移。您必须从旧数据库中提取所有数据，将其插入新数据库，然后获取在此过程中插入旧数据库的所有数据，并将其放入新数据库。

从一个数据库切换到另一个数据库并不容易。

在过去的团队中，我们希望实现一个更适合的数据库，但编写新代码需要时间，我们所有的时间都被负担过重、过时、配置不足的 ElasticSearch 部署(不打算作为记录系统！我们的错！).我们无法消灭它；我们需要这些数据。我们拿不出来。负荷太大了。

最坏能发生什么？你会丢失数据。请实现某种形式的复制。备份、恢复、迁移自动化——数据库也是整个系统的一部分。所有这些都应该在生产数据输入之前准备好并经过测试。

有什么不可避免的小痛？您将学习存储和查询的所有技巧。请将此隔离在服务之后；微服务最本质的部分就是这种隔离。

然后是维护:随着负载增加和存储扩展，进行监控、升级和重新配置。不要被一个快速的问候世界的故事所迷惑。那个最初的“嘿，我可以存储数据！”与生产负载不断增加的平稳运行的数据库非常不同。

所有这些都很难，而且对业务至关重要。任何委托给你的数据的技术——即使是短暂的，如在队列中——都需要一个团队在背后支持。

最好能发生什么？一个精心选择的数据存储库可以实现其他情况下无法实现的查询。总是问“现在我们有了这个，我们还能做什么？”也许图形查询现在很快了。也许曾经的批处理现在可以实时完成。也许现在我们可以为客户动态更新一些有见地的可视化。

#### 严重风险类别:

原本不可能回答的问题变得容易了。

**不利因素:**数据丢失或无法访问，业务停止。

**不可避免的成本:**了解每个配置选项、查询技巧、自动化迁移以及备份和恢复。

**激励措施:**仔细考虑每种业务情况下的存储权衡。

## 结论

对于每个团队、每个环境和每个可能的技术来说，权衡是不同的。自觉做出这个选择。[研究技术](https://blog.8thlight.com/sandro-padin/2014/01/03/how-i-evaluate-open-source-software.html)，[规划出自己的需求](http://mcfunley.com/choose-boring-technology-slides)，小心谨慎。

如果你对增加你的堆栈很吝啬，你的团队继续学习新的技术和思维方式仍然是至关重要的。

考虑将此功能从功能开发中分离出来。一家公司留出每天的第一个小时来开发一些新技术。一个小时的专注工作可以去除很多光彩，同时呈现出有用的想法。其他公司会在周五对他们选择的项目进行黑客攻击。内部工具可以是探索高风险技术的低风险方式。

当你接受一项技术时，确保它有一个所有者。通过配对、记录和交流传播知识。明确职责，留出时间进行维护、升级和重新评估。今天正确的技术在某个时候会变成错误的技术。

您想要的开发人员会希望对业务有生产力。给他们选择正确工具的自由和信息，不是为了他们今天在做什么，而是为了公司未来会做什么。考虑最好的、最坏的和不可避免的。当你看到它的时候，总是感激兴奋。

## 您可能也会感兴趣的帖子:

