# 没有代码？没问题——用简单的英语写测试|由 NYT 公开赛团队| NYT 公开赛

> 原文:[https://open . nytimes . com/no-code-no-problem-writing-tests-in-plain-English-537827 eaaa 6e？UTM _ source = Wanqu . co&UTM _ campaign = Wanqu+Daily&UTM _ medium = website](https://open.nytimes.com/no-code-no-problem-writing-tests-in-plain-english-537827eaaa6e?utm_source=wanqu.co&utm_campaign=Wanqu+Daily&utm_medium=website)



Illustrations by Dalbert Vilarino



# 没有代码？没问题——用简单的英语写测试

## 我们如何使用行为驱动开发来更好地协作

**由** [**奈得勒**](https://medium.com/@naidele.manjunath) **和** [**奥利维尔**](https://open.nytimes.com/@odemeulder)

行为驱动开发，或 BDD，是一种软件开发方法，其中一个特性的行为是通过纯文本的例子来定义的。这些例子被称为特性文件，在开发开始之前定义，并被用作新特性的验收标准。这些特征文件是用使用英语单词的[小黄瓜语言](https://docs.cucumber.io/gherkin/)编写的，无论编程能力如何，任何人都可以阅读。特征文件是以“行为驱动”的方式编写的，这意味着它们包含了在给定情况下某个特征发生时应该如何表现的细节。此行为是特征文件中提到的唯一信息；没有提到该特征的底层实现细节。

我们的跨职能团队——纽约时报的客户关怀技术团队——使用功能文件对我们的产品进行更深入的讨论，这有助于就应该开发什么达成共识。当每个人都理解我们的用户故事时，我们在生产过程中浪费的时间就更少，重复我们已经做过的工作的情况也更少。一起编写特性文件鼓励协作，并帮助开发人员和 QA 理解故事的业务方面。

因为团队中的任何人都可以读写特性文件，所以我们不需要依赖测试人员或 QA 工程师来编写测试。

# 我们的流程

在每个 sprint 的开始，我们的产品经理遵循敏捷原则，为每个特性编写用户故事。下面是一个简单的用户故事示例，我们可能会将它包含在我们的 sprints 中:

> 作为一名客户关怀倡导者，我想更新客户的信用卡记录，以便在下一个账单周期从客户的新信用卡中收取费用。

当用户故事写好后，我们的产品经理和开发人员坐在一起将用户故事翻译成特征文件。特性文件充当开发人员负责编写的自动化端到端测试的大纲。

按照我们上面的用户故事示例，特征文件可能如下所示:



自动化测试是用 Javascript 编写的。特征文件中的每一个`Given`、`When`和`Then`行对应一个简单的 Javascript 函数，`Then`行将包含测试断言。我们团队使用 [Mocha 断言库](https://mochajs.org/)、 [webdriver。IO](https://webdriver.io/) 作为测试运行器和[黄瓜框架](https://cucumber.io/)来解释测试特性，但是任何都可以使用。从事自动化端到端测试的开发人员可以在他们的机器上本地运行测试。

这就是奇迹发生的地方。

测试运行程序解析特性文件，找出要运行的 JavaScript 函数并报告回来。

一旦所有的端到端测试成功通过，还有一个步骤。BDD 测试框架被集成到我们的持续集成(CI)管道中。这使得每个人都可以验证测试在阶段环境中运行。

测试报告可能如下所示:



如您所见，即使您没有技术背景，该报告也很容易阅读。



Illustration by Dalbert Vilarino



那么，是什么让 BDD 有价值呢？我们的团队已经看到了四个切实的好处:

**加强合作。**产品经理参与设计测试，这意味着他们与开发人员(和 QA，如果适用的话)一起工作，以清楚地陈述业务规则。团队中的每个人都非常了解新产品的特性，每个成员都可以清楚地看到项目的进展。

**活文档。**因为特征文件是在特征进入生产前的检查，所以它们需要保持最新。对产品或功能的任何修改都意味着必须更新文件，以避免由功能定义导致的故障。虽然文档通常是软件开发中的事后想法，但是 BDD 使它成为开发过程中不可或缺的一部分。

**快速提升。**代码对每个人都没有意义。它也不是很好的文档。与不懂代码的团队成员一起工作通常意味着团队必须创建一个单独的文档，比如电子表格，来描述测试代码所覆盖的内容。BDD 有助于用特征文件解决这个问题。团队的新成员可以阅读特性文件并快速理解特性的作用。这比阅读大量文档要好。

**可读的报告。**通常，测试结果不会以用户友好的格式呈现——报告中的日志可能会说一些隐晦的话，如“预期假等于真”虽然这可能很容易阅读，但读者并不清楚上下文或含义:什么原本是真的，现在却是假的？对于 BDD 结果，每个结果都属于 BDD 特征文件中相应的场景，这提供了更好的可读性。

我们的团队几个月前开始使用 BDD。起初，这有点令人害怕和不知所措，因为每个人都需要学习新的技术技能，并以新的方式一起工作。随着时间的推移，团队掌握了 BDD 测试，并发现紧密合作是一个非常自然的过程。当团队在特性文件上合作时，我们在开发周期上更加一致，产品变得更好。



