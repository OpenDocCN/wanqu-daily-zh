# 以 500 像素构建分析。从…看建筑分析学

> 原文:[https://medium . com/@ Samson _ Hu/building-analytics-at-500 px-92e 9 a 7005 c 83？UTM _ source = Wanqu . co&UTM _ campaign = Wanqu+Daily&UTM _ medium = website](https://medium.com/@samson_hu/building-analytics-at-500px-92e9a7005c83?utm_source=wanqu.co&utm_campaign=Wanqu+Daily&utm_medium=website)

# 以 500 像素构建分析

## 看看中型初创企业如何从头开始构建分析，以及在此过程中面临的一些挑战

加入 [500px](http://www.500px.com) 成为分析主管是一个快速的决定。我看到了一个让大多数分析师垂涎三尺的绝佳机会——在雄心勃勃的初创企业中从头开始构建分析功能的机会。我可以将我对数据驱动型公司的愿景付诸实践。

一个地方:

*   每个人都了解公司的度量标准，并且知道他们的工作如何适应度量框架
*   我们衡量决策的影响，并承认其成功或失败
*   团队使用自助工具用数据回答他们自己的问题
*   我们可以通过挖掘数据并找到领先指标来预测未来

我知道这不容易。我必须给一家数据相对不成熟的公司带来变革。我也不会有太多的帮助。

最重要的是，我将不得不“更换行驶中的汽车的轮子”，因为所有现有的基础设施和流程仍然需要维护。

但是我总是对挑战感到兴奋——我马上就签约了。

T2】

我加入已经快一年了。

在重建我们的基础设施和报告程序方面取得了重大进展。我们现在在我们的[红移数据仓库](http://aws.amazon.com/redshift)中有了一个真理的中心来源。我们已经推出了我们自己的商业智能工具，[潜望镜](http://www.periscope.io)，决策者和分析师可以自助服务他们自己的分析。现在有报告和仪表板被推送到公司的每个团队进行绩效评估。

我们还没完呢。但是当你今天在办公室里走来走去，看到所有出现在人们屏幕上的图表和数据时，很明显我们已经取得了很大的进步。

我要写的是数据的两个世界——技术方面和业务方面。今天有很多关于构建数据基础设施的内容。还有大量关于初创企业分析的文章，旨在描述哪些指标是重要的。但是很少有人写实施和管理——将分析视为一项业务职能。

我将给出我的观点。

# 一些背景

## 生意

[500px](http://www.500px.com) 是一个照片分享社区和股票摄影市场。我们的平台包括桌面和移动网站、Android 和 iOS 上的移动应用，以及 Flipboard 等第三方应用。我们得到了世界级投资者的支持，包括[安德森·霍洛维茨](http://a16z.com/)和 [ff 风险投资](http://ffvc.com)。

我们的两个收入来源是:

*   允许用户上传更多照片的付费订阅
*   一个库存摄影市场，我们从每笔销售中提成

公司由几个团队管理。我们的开发团队包括 web、移动和平台。在非技术方面，我们有销售、营销、内容、客户优势和产品。在最高层，我们有一个执行领导团队。我们的员工总数超过 60 人。

每个团队都有自己的工作风格，需要分析才能发挥最佳作用。例如，管理人员每周星期二开会一次，讨论高层战略。在这次会议上清楚地总结指标的走向对于高层决策至关重要。

即使对技术人员来说，接触分析也是有帮助的。了解产品指标有助于开发人员看到他们工作背后的“为什么”——这是高性能的一个关键因素。

## 技术堆栈

我们所有的应用和网站都运行在我们的 API 服务器之上。在这些服务器上，我们提供单片 Rails 应用程序和一些微服务。这些由几个数据库支持，主要的是 MySQL。

在 MySQL 上，我们存储应用程序使用的有状态信息。两个重要的表是 photos 和 users 表。我们还有一个订阅购买和库存摄影购买的表格。

我们在后端记录 API 调用和状态变化。例如，记录提供照片的呼叫，以及注册、上传、投票或关注等操作。

如果你不知道，日志只是文本文件。当我们记录一个操作时，我们只需添加一行，如下所示:

> 2015–02–10 10:24:31.32444 23432423 photo _ like 423223 123 . 132 . 623 . 123/get？…

一行中的项目可以包括时间戳、照片 id、用户 id、用户 ip、动作以及任何其他相关的内容。

这些提供了我们平台上的活动历史，补充了 MySQL 中的有状态信息。这些日志每小时在 S3 进行汇总和归档。我们每天产生大约 20gb 的日志文件。

MySQL 和日志这两个数据源对于分析都很有用。MySQL 非常适合抓取照片和用户信息，以及股票照片和订阅交易。这些日志对于理解用户随时间的行为非常有用。

T2】

现在，您已经对公司和我们的技术有了一些了解，让我们来看看我们的分析技术的发展。

# 通往更好的分析之路

## 两个数据来源

当我刚开始时，我有两个数据源可以使用:Splunk 和 MySQL。

MySQL 可以给出一张照片的总点赞数，但它无法告诉我这张照片在过去一小时内获得了多少点赞。

Splunk 是基于日志的日志搜索引擎。等等…那是什么意思？

日志可以告诉你很多关于用户行为的信息。当用户喜欢一张照片时，这个动作会被写入一个日志文件，并提供一个带有时间戳的记录。因此，通过查看日志，你可以得到一个答案，即一张照片在过去一个小时内获得了多少个赞，方法是浏览并数一数你在那张特定照片上看到类似事件的每一行。

但是日志文件只是文本文件。从它们中获取价值是困难的，因为它们需要被解析。这就是 Splunk 的用武之地。

Splunk 是一个允许您搜索和分析日志数据的工具。我可以问一些关于用户行为的问题:

*   平均来说，一个用户一次上传多少张照片？
*   上个月有多少 android 用户使用了我们的平台？

然后，Splunk 会非常快速地逐行查看日志，并计算符合查询的事件数量。

## 两个头痛

查询这两个来源非常简单。如果我想要有状态的信息，我会查询 MySQL。如果我想了解一段时间内的用户行为，可以查询 Splunk。

但是，当你需要问一个涉及行为和状态的问题时，比如上个月有多少用户喜欢一张照片(Splunk)，按用户订阅类型分类(MySQL)，你需要一种离线方式来分别查询两个数据源，然后将两者结合起来。为此，我使用 Python 及其 MySQL 和 Splunk 库。

这是一个小问题。

编写自定义代码来进行数据提取是非常费时的。

还有一个更令人头疼的问题

这两个数据源对用户不友好。Splunk 有一种特殊的查询语言，在线资源很少。MySQL 中的模式没有得到很好的记录。这使得提取数据的责任完全落在了分析师身上。

当一个超过 60 人的公司只有一名分析师需要访问数据，而他们自己又做不到时，这将是一个糟糕的时期。

## 执行控制面板——向山上跑

在指标报告方面，情况也好不到哪里去。

我们使用 Splunk 按日期和客户端(web、iphone、android 等)统计事件(注册、上传等)的数量。这些 Splunk 搜索的结果存储在一个名为 Exec Dashboard 的 Google 表单中，由一个每夜运行的脚本调用:



Our Exec Dashboard. Numbers have been randomized



想象一下，为了了解日常活跃用户等基本指标的趋势，梳理一千个数字。只有我们团队中最有经验的 MBA 才能跟上。

T2】

很明显，有些事情需要改变。

首先，数据是不可访问的。四个月来，我被大量的数据淹没了，我很可能已经把我的头衔重新命名为数据猴子。很难责怪基础设施，尤其是因为我是新人。

其次，很难知道产品和公司的表现如何。很少有人能理解我们的衡量标准。执行仪表板是一场灾难。

我不得不采取行动。我需要重建基础架构，同时维护当前的报告流程。此外，我还必须管理整个公司的数据请求流，并确保数据仍在流动，但我将有足够的时间花在基础架构工作上。

基础设施建立之后，我需要重做报告，并向公司的其他人宣传新系统。

在公司的这一点上，一个新的基础设施项目并没有导致指标的改变，这是管理团队最不想听到的。但这是必要的。我赌我能做到这一切，并在他们失去耐心之前证明自己的价值。

这就是我喜欢初创企业的原因。你可以做这样的事情。#yolo

T2】

在基础设施方面，我需要两样东西:

*   一个结合了日志和 MySQL 的数据库，易于查询
*   这个数据库的前端。一些易于使用的东西，这样任何人都可以在最少的帮助下查询数据模型

有了这个，我就可以摆脱对所有数据分析的依赖，在公司里四处走动。

幸运的是，我们不必重新发明轮子。存在正好解决这两种需求的产品。在接下来的两节中，我将讨论红移数据库和潜望镜的实现。

之后，我将讨论使用 Periscope 和 Google Sheets 重建指标报告。

# 新基础架构，第 1 部分—红移

在这一节中，我将深入探讨数据仓库。如果您已经熟悉这个概念，请随意浏览下一部分。

## 维度建模入门

Kimball 在 90 年代引入了多维数据仓库的概念。这是一个专门用于业务分析的 SQL 数据库，不同于用于应用程序的生产数据库。它应该易于理解和查询。

维度数据仓库有一个特殊的模式，有两种类型的表，称为*事实表*和*维度表。*数据将从源(MySQL 和日志)流向这两种类型的表，这个过程称为提取-转换-加载(ETL)。

让我们简单谈谈 ETL 和模式。

## 多维数据仓库模式

数据仓库的模式有两种类型的表:

*   *事实表*记录过程中的时间测量值。
*   *维度表*记录特定项目的信息。

这两个表都是可以理解的。它们必须具有可读的列名和值。

举个例子:

*   *likes 事实表*具有列:日期时间、用户标识、照片标识、客户
*   *用户维度表*包含以下列:用户 id、用户名、名字、姓氏、…、订阅类型、…、is_seller、…、has_android_app、…

这里有一个使用这个模式的例子。

如果我们想知道过去一周有多少个赞，我们可以查询 *likes 事实表*，对记录求和，并按日期过滤。

但是如果我们想要按用户订阅类型对喜欢进行分类，查询*事实表*是不够的。subscription_type 不包含在*喜欢事实表*中。但是 user_id 是。我们需要通过 user_id 将 *likes 事实表*加入到 *users 维度表*，然后通过用户 subscription_type 进行分组。

从这个例子中，很容易理解为什么*事实表*经常包含*维度表*的外键。这是为了将它们连接起来，以便可以按维度对事实进行切片。

## 抽取、转换、加载至目的端（extract-transform-load 的缩写）

为了用来自生产数据库和日志的数据填充我们的数据仓库，我们应用了一个称为 ETL 的过程。

数据仓库看起来与生产数据库和日志文件非常不同。表通常是非规范化的，复杂性是隐藏的。例如，在生产中，为了查看用户是否有一个活动的订阅，我们可能需要编写一个涉及几个表的复杂查询。但是在数据仓库中，它应该只是用户表中的是/否列。

正因为如此，我们需要在从数据源提取数据并将其加载到数据仓库之后对其进行转换。因此得名 E-T-L。

通过将查询数据的复杂性隐藏在 ETL 中，访问数据变得更加容易，错误也更少。

## 创建模式

到这个时候，我已经花了几个月的时间收集数据，做特别的分析。查看我过去的查询，我提出了一组表要求:

*   事实表:订阅购买，股票购买，上传，注册，喜欢，收藏，关注，…
*   **维度表**:用户，照片

这似乎是在没有满足足够的需求和过度工程化系统之间游走。

## 这个模式符合我们的需求吗？

这个数据模型包含日志和 MySQL 数据——在一个地方，不需要做额外的工作来组合它们。理解和阅读都很简单。所有复杂的查询，比如确定用户的账户类型，现在都隐藏在 ETL 中了。查询这个数据模型是一种乐趣。

但有时我们的数据模型有所欠缺:

1.  如果我们没有为我们的问题准备好合适的桌子
2.  如果我们需要 SQL 以外的高级处理

通过对我们的解决方案进行适当的规划和迭代，我们可以最小化 1)。

SQL 功能强大。2)形式的问题很复杂，通常超出了商业智能平台的范围。

## 托管它—亚马逊红移

既然我们已经讨论了数据仓库的模式，我们需要一个实际的数据库来托管它。

对可以支持维度模型的数据库有一些技术要求。

这种数据库的主要操作是聚合和连接。这两个操作在传统数据库上代价很高，传统数据库是应用程序的数据存储。尝试在 MySQL 中将一个 100 米的表连接到一个 500 米的表。甚至波斯特格雷也会屈服。我们需要一些专业的东西。

我们需要一些专门用于分析的东西。幸运的是，我们有一个便宜、易于使用、易于维护的数据库，该数据库针对分析查询(如连接和聚合)进行了优化:AWS 上的 Amazon Redshift。

一个 2tb 磁盘空间的红移数据库足以满足我们的需求，每年花费 4000 美元多一点。

## 构建 ETL

跟我重复:我不会烘焙我自己的 ETL 解决方案。

ETL 管道很快变得非常混乱。您会发现您的生产数据库并没有考虑周全。获取 ETL 所需的某些类型的信息将需要黑客和大量的依赖。

> 例如，我们衡量指标的一个主要难题是衡量订阅、续订和流失。如果一个已有订阅的用户手动购买一个新的(非自动续订)来延长他的订阅，那么最初在我们的代码中我们把它算作一个新的订阅。但因为他已经是一个订户，我们会重复计算他。因此，我们需要一种方法来查看购买新订阅的人是否已经是订阅者，以及他是否将他放在续订桶中。
> 
> 但是 MySQL 中没有这个栏目。由于我们每晚进行一次这种计算，当一个人延长他们的订阅时，我们不再有能力检查我们以前是否是一个活跃的订户。我们拥有的唯一列是 _active。因此，我们需要创建一个新表，只供 ETL 使用，它存储某一天的活动订户记录。我们保留了这个表的 join，并删除了之前活动的表，以获得固定的新订户数。我们做了类似的事情，将他添加到续订。

你听懂了吗？

生产模式对于分析来说很糟糕。

一个必须将混乱的生产数据转换成干净的数据仓库数据的 ETL 脚本自然会变得极其混乱。

使用像 Luigi T1 这样的框架或者像 T2 Informatica T3 这样的工具。这些具有众所周知的编码风格和结构，并且被广泛使用。还是会很乱。但是它可以与已知的 ETL 方法相媲美。

如果你忽视这个建议，并最终自己烘烤，一旦你离开，没有人能够理解这个系统。

我选择 Luigi 框架来构建 ETL 管道有很多原因:

*   Luigi 由 Spotify 构建和支持。它被世界上成千上万的初创企业所使用。有一个活跃的邮件列表和一个不断增长的社区。
*   Luigi 是开源的，可扩展的。这很清楚发生了什么，并鼓励扩展基类。
*   Luigi 是基于 Python 的，这是一种处理数据的流行语言。
*   路易吉的代码可读性很强。Luigi 的基本单元是模拟原子 ETL 操作的任务类。他们有三个部分。需求部分，包括指向需要在此任务、数据转换步骤和输出之前运行的其他任务的指针。因此，每个任务都是有向图中的一个节点 ETL 作业。Luigi 将在可视化工具中为您可视化这个图表，并为您提供关于 ETL 每次运行的诊断信息。
*   以这种方式构建代码使事情更容易阅读和维护。既有等级又有关系。我还将红移最终表中的所有任务放在一个文件中。这允许我快速地看到代码的结构，并分离出我感兴趣的部分。



The Luigi directed graph



*   Luigi 是幂等的。这意味着一个接一个地运行两次不会有任何效果。如果您删除这些特定任务的输出，它只会再次重新运行部分代码。这对调试非常有帮助。如果运行在某个特定的节点失败，您只需在再次点击 run 之前修复该节点。您不必隔离那段代码，并费力地隔离运行它。
*   Luigi 有错误日志和状态邮件。如果节点在运行过程中出现故障，您会收到通知。然后，您可以查看错误堆栈跟踪，修复代码并重新运行 ETL。

在 Luigi 中编写了 ETL 之后，我在有向图中有了 200 多个节点。这些操作包括从 MySQL 提取数据，将转储文件上传到 S3，然后从 S3 加载到 Redshift。一个特定的节点触发一个弹性 Mapreduce 实例来解析日志数据，并将它们转换为存储在 S3 上的事实表转储，然后加载到 Redshift 上。

ETL 的整个运行从开始到结束大约需要四个小时。我将该过程设置为每天午夜开始。

## 成品数据仓库

这就是我们的数据模型——存储在 Amazon Redshift 上，每天晚上通过 Luigi 上运行的 ETL 管道输入新数据。

首先，在实现之后，你会意识到你已经错过了需求中的一些东西。人们会问你模式的变化，因为他们需要一个额外的列来进行分析。您会注意到 ETL 的某些部分被破坏了，因为工程人员在没有通知您的情况下对生产模式进行了更改。

但是过一段时间事情会稳定下来。人们将不再要求改变。您将习惯工程更改生产模式的节奏。当模式发生变化时，工程也将更好地与您沟通。

您可以做一些事情来确保数据仓库中的数据是准确的。我将在本文的后面谈到这些。

总而言之，运行这个数据仓库一年的成本不到 8000 美元。与这种规模的传统数据仓库解决方案相比，这是非常划算的。

# 新基础设施，第二部分——潜望镜

随着数据仓库的建立，现在需要一个可以在公司内使用的工具来访问它。我评估了几种流行的选择。

*   最简单和最便宜的解决方案是给每个人一个 SQL 终端。但它不容易使用，也不友好，而且学习 SQL 仍然有摩擦。
*   Looker 真的很吸引人，因为它的界面允许非技术用户访问数据库，构建仪表板和报告。但是每年支付 30k+超出了我们的预算。
*   Tableau 是视觉分析的强大工具，但是在这个范围之外就不够用了。它不能很容易地进行报告和列表提取。它还需要在计算之前将数据存储在内存中，而不是依赖 Redshift 出色的数据处理能力。

这些解决方案都不合适。我在 [Periscope](http://www.periscope.io) 中找到了我的答案，这是一家早期初创公司，它生产的产品正是我一直在寻找的。

T2】

关于潜望镜:

*   Periscope 是一个轻量级的分析工具，您可以在其中编写 SQL 来创建图表。
*   Periscope 可以轻松连接到 Redshift，因为它们都是云解决方案。
*   仪表板是基本的文档类型。



An example of a dashboard



*   在这些仪表板上，用户可以编写 SQL 来创建图表和表格。



Writing SQL to create charts



*   它是协作的。不限数量的用户可以在一个公司内注册，并看到彼此的仪表板。链接可以在 Slack 和电子邮件中发送给其他用户，将他们指向某些仪表板。
*   每个仪表板每小时自动更新，以便您获得最新数据。
*   您可以将每个仪表板设置为在设定的时间以电子邮件形式发送出去。

这个工具是杀手:

*   它是基于 SQL 的，所以学习 SQL 是一项要求。但是通过让仪表盘如此容易共享，使用 Periscope 成为了公司内部的一项社交活动。这为人们学习 SQL 创造了强大的动力。
*   潜望镜中的特别分析速度很快。因为创建图表的速度非常快，所以你可以快速迭代你是如何看待数据的，以及你在问什么问题。我觉得迭代是一个分析师最自然的工作模式。通过快速迭代，你可以更快地找到你想要的答案。
*   用潜望镜报道很容易。要获取列表，只需创建一个新的仪表板，编写您的 SQL，然后点击 save。然后，您可以共享指向仪表板的链接或将表格导出为 CSV 格式。
*   潜望镜是一个功能齐全的仪表板工具。安装 Periscope 后，我做的第一件事就是为我们的每个产品和团队构建仪表板。然后，我将这些仪表板设置为每天早上给每个人发电子邮件。
*   潜望镜是协作的。公司里的每个人都可以加入，看看其他人都在做什么。用户可以向彼此的仪表板添加图表，或者编辑彼此现有图表背后的 SQL。被查询困扰的用户可以快速而轻松地寻求帮助。
*   费用合理。对于一家超过 60 人的公司来说，我对我们每月收取的费用感到满意。

T2】

架设 Periscope 后，公司内部开辟了一条新的沟通渠道——数据通信层。

我不再是允许数据在公司流动的依赖者。这释放了我花在数据提取上的大量时间。整个公司现在都在关注更多的数据，就像我独自进行数据提取和分析时一样。

实现红移和潜望镜是一个巨大的成功。

# 绩效评估和报告

## 决定格式

基础设施完成后，我们现在需要专注于修复指标报告。旧的 Google Sheets Exec 仪表板上有数千个数字，需要彻底改革。

这不仅很难理解，而且也是一个尺寸适合所有人。高管们不需要每日数据，除非有大的异常值。营销不需要太多产品指标的细节，产品也不需要太多营销指标的细节。开发团队中没有人能理解发生了什么。

还有指标定义的问题。不是每个人都理解我们所认为的每日活跃用户。这是个问题。

需要创建一组新的仪表板。更容易理解和做出决策，并为每个团队定制。这些都是有记录的，这样每个人都知道我们在测量什么。

T2】

我从最高层开始，首先在为管理团队服务的仪表板上工作。这将以每周一页的形式在每周二的高管会议上分发。我与我们的产品副总裁和运营副总裁密切合作，反复研究衡量公司的不同方法。

我们来来回回迭代了几个解决方案。几个星期后，形式就确定了。便笺将列出与每个团队相关的最重要的指标。这封信要追溯到五周前。

在单独的选项卡中，本文档中的每个指标都有精确的定义。

在每个周数字旁边，还会有一个从我们的主计划文档中提取的预计数字。我们可以比较这两者，看看我们的总体战略是否正确。



这是我们最重要的仪表板。它为 500px 的人们应该如何思考他们的工作奠定了基础。其他团队的仪表板也随之而来。

最后，我为以下每个团队创建了一组仪表板:

*   产品
*   网
*   移动的
*   营销
*   销售

这些仪表板是用潜望镜制作的，非常直观。每个仪表板都包括团队在高管手册中负责的指标，还包括其他支持指标。每个指标会有一个图表，通常是折线图。每个图表都包含定义，因此用户可以将鼠标悬停在图表旁边的信息图标上，阅读定义。

有两种方法可以访问这些仪表板。用户可以随时登录查看他们的仪表板。但我还设置了 Periscope，每天早上给每个团队的仪表盘发邮件。

通过电子邮件发送仪表板对开发人员特别有帮助。他们不需要经常登录 Periscope，因此不需要养成这个习惯。他们可以通过电子邮件获得他们需要的一切。

## 关于度量的定义

对于如何衡量公司，有比我自己的经验更好的资源。但是我将简要地谈论每个仪表板的主题。

在执行层面，分析表包括的指标大多是每周的日平均值。这使得保持在一个参考框架内变得容易，例如在与活跃用户的每日计数进行比较时。

我们衡量的指标与我们的参与度漏斗相关。你可以想象 500 像素的三个漏斗:

*   访客->注册->每日活跃->每日参与->付费用户
*   访客->注册->照片上传->照片提交到市场->照片在市场上出售
*   访问者->注册->从市场购买照片

对于不同的产品，每个团队拥有这个漏斗的不同部分:

*   营销团队拥有这个漏斗的顶部(页面浏览量)和底部(收入)
*   产品团队不太重视漏斗指标
*   开发团队(web 和移动)希望看到他们自己产品的整个漏斗。

《精益分析》一书提倡使用比率(每天上传的数据量)而不是计数(每天上传的数据量)。我们的团队认为，伯爵更容易在领导链上上下下进行社交活动。

计数用于除产品指标之外的一切，在产品指标中，我们主要通过两种方式来衡量特性:

1.  使用频率(用户每月上传照片的次数)
2.  使用量(每次上传的照片数量)

# 履行

推广基础设施和新的测量系统需要培训。人们需要学习如何使用 Periscope，并对度量标准有一个清晰的概念。

## 潜望镜训练

Periscope 是基于 SQL 的，所以人们需要知道如何编写 SQL 才能有效地使用它。我给人们指出了两个很好的资源:

1.  [SQL 学校](http://sqlschool.modeanalytics.com/)
2.  [可汗学院](https://www.khanacademy.org/computing/computer-programming/sql)

一旦掌握了 SQL 技能，我就给他们模式定义文档。在这个 Google 工作表中，我定义了数据仓库中的每个表和列。如果一列是分类的，我列出它可能的值。

## 度量福音主义

仅仅给每个人仪表板和报告是不够的。每个人都需要在我们衡量的方面达成共识。

我主持了一个小时的午餐，了解我在哪里向整个公司描述了衡量框架。我花了整整 45 分钟谈论我们使用的每一个指标。在这种枯燥的素材下，我尽最大努力变得有趣和投入。

这是必要的。不是每个人都知道什么是日活跃用户。这不明显。当有几十个指标被抛出，但没有关于定义的共识时，会有很大的混乱。

最重要的是，对于一个数据驱动的公司，每个人都需要知道他们的工作如何符合指标。因此，指标需要在文化中根深蒂固，从人们设定季度目标时，到问题得到战术性解决时，都要谈论它。

宣传活动需要持续进行。

# 数据准确性

衡量标准经常是错误的。我认为这是一件出于尴尬而不常公开谈论的事情。但是每个公司都面临这个问题。

在这个系统中有太多失败的空间:

*   日志可能会被错误地解析，您可能会低估或高估一个事件
*   API 服务器上的日志发送器可能会失败，而您不会注意到，并且会错过一小部分事件
*   有一天可能会出现网络问题，10%的日志条目可能无法发送到 S3
*   一些重要的指标可能很难在数据库中查询，您可能会得出错误的数字
*   等等

这不包括硬失败事件，比如 ETL 失败和指标没有被刷新。这些错误是无声的。

错误会发生。每次需要向董事会重述指标时，都会有人被踢屁股。但是很难完全避免。

你如何应对这种情况？

总是在审计。

将重要的数字与外部的事实联系起来。我们从我们的数据仓库中提取每日活跃用户，并每天将他们与谷歌分析进行比较。我们还将我们的订阅指标与 Stripe/Paypal 进行了匹配。

我们还交叉引用从日志中创建的事实表和从 MySQL 中创建的维度表。这是对解析错误的检查。例如，我们将用户维度表中的新用户与注册事实表中的注册事件进行比较。

最后，当我们的团队认为指标看起来很有趣时，我们依靠他们来报告。无法解释的异常值、数字的跳跃或下降，或者一对不一致的指标——这些都是可能出错的信号。

但是这个系统仍然非常复杂，很难进行质量保证。在与许多不同公司的分析人员交谈后，实际上你应该以 80%的信心相信你的数字。

这是一个难以接受的事实。

# 与工程部门合作

分析是几个业务部门之间的合作关系:产品、营销、客户支持、销售和工程。

特别是，必须小心处理与工程的关系。

分析需要在工程路线图上。在每个功能发布时:

*   需要方便地查询数据模型以进行分析
*   需要为相关的用户操作输入事件日志

同时，分析师需要了解工程师是如何工作的。他们需要知道冲刺的节奏，工作如何在团队中分配，以及如何最好地提出工程时间的要求。

我很幸运，随着我需求的增长，工程和产品都很体贴。就我而言，我需要学习如何与成熟的工程团队合作。

# 20%法则——分析需要传道

很有趣。考虑到我的上一份工作是向科技公司销售软件，我大大低估了销售这份工作需要多少钱。

没有正确的结构，分析师所做的工作很难理解。他们独自在一个组织中，从一个团队漂流到另一个团队，从一个项目漂流到另一个项目。没有知名度和支持网络，很难保持动力。

我给你讲讲我自己的经历。

我在 500px 的计划是分阶段构建分析:

1.  基础设施
2.  报告
3.  分析学
4.  预测建模

在报告和基础设施修复之前，分析师深入挖掘数据以找出业务的分析不会有效。

但是，当来自高层的问题开始浮到你面前，问你为什么不做你的工作——为什么分析部分没有完成，而你仍然在努力构建基础设施，这是非常消极的。除非你一开始就认同你的路线图，否则很难收回。

还需要花时间交流成功案例。人们需要对数据领域的进步感到兴奋。这有助于完成你需要帮助的事情，并让你远离政治。

人们不会自然地得到数据，为什么它很重要，以及它是如何做到的。这三者对分析师的成功都很重要。

如果我不得不做一些不同的事情，或者下一次，我会分配 20%的时间去传福音。建立沟通流程。午餐和学习。演示文稿。社交。销售。

花 20%的时间去销售。这很重要。

# 反射

在过去的一年里，我们修复了数据基础架构，并拥有了一个健全的报告系统。我们已经通过培训和社会化在公司推广了这项技术。

前进道路上面临的障碍包括应对资源匮乏和公司间的政治斗争。但他们没有阻止我们完成任务。

我们现在有了一个系统，人们可以知道公司在做什么，并且可以自助服务他们自己的分析和数据，而不需要询问分析师。我们离起点还很远，我们正在将 500px 转变为顶级数据驱动型初创企业。

## 下一步是什么？

多好的一年。关于分析，我们甚至还没有触及表面。还有很多事情要做:

1.  像谷歌分析这样的前端分析还没有被很好地理解
2.  按渠道模拟整个盗版指标
3.  我们用户群的细分
4.  特征变化影响的因果模型
5.  创建用于营销的 LTV 模型
6.  A/B 测试流程
7.  扩大团队

这将是一个激动人心的时刻。

但我正在远离我的角色。我进入 500px 的计划一直是暂时的，我最终会搬到旧金山。

七月，我将搬到旧金山加入[愿望](http://www.wish.com)。我将在他们的数据平台上工作。

我很高兴能去科技圣地。我希望能认识其他对数据感兴趣的人。

如果你想在旧金山喝咖啡，或者有兴趣在 500px 取代我(我们正在寻找一名高级数据工程师、业务分析师和数据分析师)，请给我发消息到 shanzhen.hu@gmail.com。所有工作都在[https://500px.com/jobs](https://500px.com/jobs)发布。

*感谢*[*@ Joseph by*](https://twitter.com/josephby)*作为一个伟大的老板，*[*@ andyyangstar*](https://twitter.com/andyyangstar)*让我加入，感谢凯文·帕丁在我离开后接管基础设施，@robbraun 向我展示了 Uken Games 如何实现其分析基础设施*，*和* [*，@seanpower*](https://twitter.com/seanpower) *关于数据的精彩演讲。这是一个好年景。*

