# 复杂性和策略|黑客之夜

> 原文：<https://hackernoon.com/complexity-and-strategy-325cd7f59a92?utm_source=wanqu.co&utm_campaign=Wanqu+Daily&utm_medium=website>

在我职业生涯的大部分时间里，特别是在我领导 Office 开发的十年里，我一直在努力思考如何考虑复杂性。建模复杂性影响了我们如何规划主要版本，我们在迁移到新平台时的技术策略，我们如何看待新技术的影响，我们如何与 Google Apps 竞争，我们如何看待开源，以及我们与比尔·盖茨就构建 Office 应用程序的长期技术策略进行的“坦率而开放”的讨论。

我想探索我当时面临的问题，以及我对复杂性的看法是如何影响我们的方法的。

我最近在重读梅勒妮·米切尔的《复杂性:一次导游之旅》,令我振奋的是，即使是全职研究复杂性的专业学者也很难定义或衡量它。恐怕这里没有突破，但是让我们试着构建一个可以用来探索这个话题的心智模型。

当我们考虑增强一个软件系统时，我们可以考虑一条曲线，该曲线衡量实现它所需的总功能和总成本。我从阅读记者和分析师写的关于软件的文章中得到的印象是，他们认为你有一个线性曲线，通常看起来像这样:

这反映了一条曲线，随着产品功能的增强，新功能的增量成本相对稳定。一些突破性的新技术或发展战略能提升曲线或改善其斜率吗？

或者，曲线可能看起来是凹的(也可能改变斜率或通过一些新的技术策略向上转换)。

这反映了一条曲线，随着时间的推移，新功能越来越容易添加，也许是因为你开发了越来越多的基础设施、专业知识、流程和工具，使得添加新功能越来越有效。

长期从事软件工作的人倾向于相信曲线实际上看起来是凸的，更像这样:

这反映了这样一种模式，随着系统功能的增加，新功能的增加越来越难。

那么，哪条曲线反映了现实，它如何影响战略？

正如你所料，这要视情况而定，但最终的惨淡曲线可能最能反映大型系统的实际情况。让我们看几个例子。

FrontPage 编辑器具有关键的良好分解的组件，如词法分析器、HTML 解析器以及内置在模型和视图中的核心基础结构，这使得随着 HTML 标准的发展，扩展编辑器以支持新的 HTML 标记变得相对简单。lexer 和 parser 是从描述如何处理标签类的表中驱动的，因此新标签只需要在表中添加另一个条目。通常有少量的自定义渲染工作，然后需要任何自定义编辑支持—通常只是一个相对简单的对话框来编辑任何特殊的标签属性。编辑器模型自动处理多级撤消、重新显示、加载和保存。由于我们增加了对某些特性的支持，比如对 ASP 等服务器端脚本语言的解析，这种支持可以很容易地扩展到对 PHP 等其他语言的支持。很明显，我们构建的强大基础设施使得添加某些类型的新功能变得更加容易——导致许多功能看起来像上面的凹曲线。

头版编辑也提供了一个很好的反例。对于加载到编辑器中的 HTML 页面，编辑器支持三种不同的视图:“普通”视图是用于编辑的典型的 WYSIWYG 视图，“HTML”显示底层 HTML 标记的颜色编码的可编辑视图，“预览”显示嵌入 Internet Explorer 实例中的页面。预览视图对于在浏览器中验证布局和测试动态行为特别有用。预览视图是一个“夜间功能”，是由我们的一个开发人员在编程中添加的，他是一个 ActiveX 编程向导，也能够利用我们已经构建的基础结构来支持同一文档上普通视图和 HTML 视图的独立视图。

不幸的是，预览视图最终成为了一个不断赠送的礼物。它引入的复杂性与该特性的初始编程中的任何失败都没有关系。面临的挑战是，当我们添加新功能时，Preview 需要特别考虑-额外的规范-它应该如何表现以及如何与这些新功能交互。框架集支持(早期的 HTML 特性，现已废弃)尤其复杂。随着我们增加了对服务器端脚本的新支持，特别是对编辑基于 SharePoint 的网站的越来越多的支持，我们不断遇到关于预览应该如何工作的问题，然后是实现该行为的额外编程工作。最终(特别是当 SharePoint 和动态站点支持成为产品关注的焦点时)，团队完全删除了这个特性。这显然是一个使曲线变凸的特性，使得任何新的东西都难以实现。同样，问题不是因为糟糕的设计，问题是它与我们正在开发的许多其他功能相互作用，需要额外的规范和额外的代码来实现该规范。

Word 提供了另一个有趣的例子。当我开始领导 Office 2007 产品周期的 Word 开发团队时，我们正在使用 PowerPoint 来增强对表格的可视化支持。PowerPoint 已经完成了利用改进图形支持的功能的早期原型，包括渐变、透明、阴影和反射。这种早期的原型工作让他们很好地理解了实现这些特性的代价。他们正在推动这些功能在整个办公套件中得到一致采用。功能一致性有助于用户在应用程序之间转移学习内容，并在应用程序之间复制和粘贴内容时提高视觉和语义的一致性。

当 Word 团队去估算这些功能的成本时，他们得到的估算值比 PowerPoint 的估算值大很多倍。部分成本是因为 PowerPoint 代码架构的结构更好，可以添加这些类型的可视化功能。但是估计值的增长主要是因为 Word 的功能集的交互方式使得*规范*(以及实现)更加复杂和昂贵。该功能如何与跨行和跨列交互？运行表头怎么样？它应该如何显示在样式表中？你如何为早期版本的 Word 进行编码？那么 Word 支持的所有不同的剪贴板和输出格式呢——这些特性应该如何出现在那里？用弗瑞德·布鲁克斯的[术语](http://worrydream.com/refs/Brooks-NoSilverBullet.pdf?ref=hackernoon.com)来说，这是*本质*的复杂性，而不是*偶然*的复杂性。特性是有意交互的，这使得实现 N+1 特性的成本更接近于 N 而不是 1。

由于本质复杂性的增长，成本随着特性深度的增加而增加，这种观点导致了对持续改进和重构代码库的高度重视。如果本质复杂性的增长是不可避免的，那么您希望尽一切努力减少正在发生的意外或不必要的复杂性。当然，当您嵌入到项目中间时，偶然的和本质的复杂性之间的区别并不总是那么明显，并且在某种程度上是由产品的未来发展决定的。因此，这是“更多的指导方针，而不是规则”——在内部，我们会谈论“艺术的 20%”。

当我们开始 OneNote 项目(最初在 Office 2002 中提供)时，我们认真考虑过是否要在非常丰富的 Word 编辑界面上构建它。OneNote 团队最终决定“放弃”Word 的复杂性(和丰富的功能)，因为他们认为他们需要在新的方向上自由创新，而无需支付持续集成所有 Word 现有功能的成本。为了能够在新的方向上创新，他们会满足于更小的初始“N”。这是该团队从未后悔过的决定。他们能够以相对较小的团队在存储模式、共享和不同的整体内容模式方面进行创新，因为他们完全控制了自己的端到端堆栈。

在此期间的其他“功能”包括将 Office 套件的大部分移植到 64 位版本的 Windows，然后移植到基于 ARM 的 Windows(用于 Windows RT 和更高版本的 Windows Phone 设备)。这项工作的成本与代码库的规模(数百万行代码)成比例，并为我们的工程系统成本增加了一个持续的倍增因素，以支持在这些额外平台上的构建、测试和交付。随着代码库规模的扩大，这类广泛的新产品功能越来越多。安全性是第一位的，应该有一个单独的位置，就像跨平台一样。

这种观点确实会让人对新技术的惊人突破产生某种偏见。在此期间，托管代码是我们争论了很长时间的一个问题。利用开源也有一些相同的动力。我发现，这些新技术的倡导者往往会混淆小代码库工作的生产力优势(由于更少的功能交互和随着代码库大小而扩展的功能的小成本，小的基本复杂性)和新技术本身的优势——使用新技术的努力从本质上来说是小的，所以优势被混为一谈。此外，这些新技术(Java、C#、NodeJS 是最新的一种)从一组功能更加强大的基础库和丰富的框架开始，当然与我们在 C 和 C++以及早期的 Mac 或 Windows 应用程序开发中看到的相比。

就我们的功能/成本曲线而言，这意味着您在开始时将曲线显著推高功能轴。这可能会让技术经理感到困惑，不知道你是简单地平移了一条基本形状不变的曲线，还是改变了曲线本身的形状或斜率。在一个新技术的每一个信徒都在赞美上帝的环境中，尤其如此。在实际操作中，如果产品仍然很小，您可以基本上“预定”最初的生产率增长——一个明显的胜利。如果产品开始变得复杂——你可以通过观察开发团队的规模相当直接地预测到这一点——那么成本将会被不断增加的功能交互和基本复杂性所主导。一个又一个项目已经证明，语言或底层技术基础设施不会改变这一基本曲线。

像 Office 这样的长寿代码库的动态是，随着时间的推移，框架代码的数量会被应用程序代码的数量所支配，事实上，随着时间的推移，框架会被吸收到整个代码库中。框架通常不能沿着产品要求的路径发展——这导致了一般的建议“你运输它，你拥有它”。这意味着你最终会为那些提升了你最初生产力的代码付出代价。所以“自由代码”倾向于“像小狗一样自由”，而不是“像啤酒一样自由”。

这并不反对“精益创业”或“最小可行产品”或任何其他专注于加速找到正确的产品/市场匹配或功能可行性的方法。持续敏捷交付是开发过程中的一个基本变化，因为它消除了功能开发和功能使用之间可怕的摩擦和延迟。(还有其他好处，但同样值得另文讨论。)但是持续交付并没有改变我在这里讨论的本质复杂性，除非它有助于阻止团队构建增加复杂性但不增加用户价值的特性。您可以构建的最高成本的功能是不被使用或重视的功能—您的成本/收益比是无限的。从那时起，当您构建每一个额外的功能时，您需要继续为集成那个无用的功能而付费。

Office 与 Google Apps 的竞争过去(现在仍然)受到这些复杂性观点的强烈影响。就在谷歌收购 Writely(谷歌文档的最初版本)之前，Office 团队已经决定开发 web 应用程序。当我们审视该产品时，我们从技术和功能的角度很好地理解了竞争策略。在生产力领域经历了一段相当平静的时期后，新的基于浏览器的应用程序正在多个产品领域推出。通过浏览器交付结合了许多关键突破，尤其是与当时的消费 PC 应用环境相比。浏览器使部署和收购的摩擦接近于零。将您的内容存储在云中允许在任何地方访问您的内容，这是工作、家庭和学校中多台 PC 使用爆炸式增长的关键。云中的内容可以轻松共享和共同编辑，包括后来的实时共同创作，如聊天和更改通知等功能。基于浏览器的应用交付解决了部署问题，在应用商店出现之前，这是 PC 应用的一个大问题。这使得新功能能够持续交付，并确保每个人都拥有最新版本。免费或免费增值商业模式通过这种技术策略促进了低摩擦共享。

事实上，应对这一竞争的最困难的方面之一是引导业务模式从基于设备的许可模式转变为用户订阅模式，使单个用户能够在其所有设备上保持最新版本的 Office。任何关注科技行业颠覆性事件的人都很清楚这样一个事实:新技术进步带来的不对称商业模式攻击，是竞争对手可以采取的最有效策略之一。

对我们来说很清楚的一件事是，云/浏览器开发策略并没有像我在这里讨论的那样，在本质复杂性的限制上提供突破。事实上，在浏览器中运行大量代码或大型数据模型以及管理应用程序前端和后端之间相对较高的延迟所带来的性能挑战，通常会增加在基于 web 的环境中构建复杂应用程序的难度。记者和分析师对谷歌应用程序创新速度的过度宣传，通常忽略了一个事实，即这些应用程序仍然相对简单。在加入微软之前，我和其他几个开发人员一起构建了一个功能强大的多媒体文档编辑器，包括文字处理、电子表格、图像、图形、电子邮件和实时会议。我知道在功能性还相对较低的时候，创新的步伐是可能的(“功能性很强”，但与 Office 应用程序相比仍然很小)，我所看到的谷歌应用程序的发展没有挑战这一点。

事实上，在几个展现出真正的跨领域复杂性挑战的领域，谷歌的放缓步伐尤为重要。Google Apps 已经发布了一些离线编辑的变体近 8 年了，它仍然是半功能性的。另一个“很快”的承诺是“与 Office 更好的兼容性”。这有洗衣液宣称的“现在有蓝色晶体”的味道！“更好”的说法很难反驳，但历史似乎表明，它们并没有更接近于实际上的兼容，尤其是随着 Office 的不断发展。最后一个领域是本机应用程序。谷歌为手机开发了相对简单的原生应用，但并未表现出任何真正全面投资的兴趣。本地应用程序会给所有未来的工作增加高度的复杂性，因为基础技术和架构与基于 web 的版本非常不同，至少如果他们真的对利用本地设备功能感兴趣的话。很明显，他们要么继续在本机代码和真正的兼容性上小心翼翼地投资，要么投资并立即开始面对这些复杂性挑战，这将减缓他们发展的速度，并专注于实际的差异化。这两种方法都有利于我们的竞争，他们对可用选项的看法受到这种本质复杂性模型的强烈影响。

这并不意味着我们不认真对待挑战。事实上，很明显，他们使用了一种不对称的技术攻击，利用他们的简单性来提供共享和共同编辑功能。这些功能是明显不同的，在现有的高功能(大 N) Office 应用程序之上交付会非常困难。当我们开始构建 web 应用程序时，我们需要决定是像开发 OneNote 时那样“摆脱”我们自己的复杂性，还是拥抱现有的复杂性，以及对未来开发意味着的成本和约束。

最终决定开发“Word Web App”而不是“微软的一款与 Word 不完全兼容的新的基于网络的文字处理软件”(Excel、PowerPoint 和 OneNote 也是如此)，主要是因为他们相信，文件格式仍然是一个关键的竞争优势，具有非常强大的网络效应。事实上，可以说 Office 文件格式代表了商业史上最重要的基于网络的壁垒之一(Win32 和 iOS APIs 是另外两个)。甚至像 OpenOffice 这样专门被设计成克隆的应用程序也在兼容性方面挣扎了几十年。通过接受这种复杂性和成本，我们将交付一些我们知道从根本上难以匹敌的东西，特别是如果对竞争所需的承诺有任何困惑或犹豫的话。(我要指出的是，我们决定打造 Sway 产品([http://sway.com](http://sway.com/?ref=hackernoon.com))从根本上来说是一个决定，即“远离”复杂性，探索创新，采取与现有 Office 应用完全不同的架构方法，而没有任何兼容性限制)。

现在已经是十年后了。Office 具有全平台覆盖，包括所有设备上的本机应用程序和高度功能化且兼容的 web 应用程序。这些都支持共享，共同创作和离线使用。完全实时的共同编辑现在正在推出，在本地应用程序中实现起来和我们预期的一样困难。实时共同编辑，就其被使用和重视的程度而言，加强了文件格式护城河，因为在技术上难以想象具有不同底层数据模型的两个独立实现能实现如此高程度的实时互操作性。Office 实现高度利用跨本地和 web 客户端的核心引擎的共享代码实现来实现互操作性。

竞争战略认为，当竞争对手试图差异化时，你需要专注于尽快消除这种差异化。我们所走的道路没有实现这一目标。谷歌能够通过建立他们的差异化来建立一个关键的竞争滩头阵地。我认为现在看这一切将如何发展还为时过早。很明显，如果在迎接复杂性的挑战方面有任何拘谨，Office 应用程序就不会以现在的方式进行功能定位(在所有设备上完全兼容本地和网络客户端，并支持离线和共同编辑)。这种复杂性(因为它体现了有价值的功能)*是*的护城河。

这可能已经太长了，但我还想简单谈谈我在微软的整个职业生涯中，我们与比尔·盖茨一直在进行的讨论，这些讨论与复杂性的观点直接相关。

比尔希望(现在仍然希望)在我们如何构建丰富的生产力应用程序方面有所突破。他预计突破的形式将是构建一个功能强大的组件，作为所有应用程序的核心引擎。有一段时间，他认为 Trident(Internet Explorer 的核心引擎)可以成为那个组件。该模型引导您投资构建越来越多的功能组件，这些组件代表整个应用程序越来越多的部分(因此导致构建每个应用程序的更多成本由所有应用程序共享)。

我在这里描述的不断增加的特性交互导致不断增加的本质复杂性的观点导致这样一个结论，即这样一个组件将最终遭受它需要服务的主组件的所有复杂性和约束的联合。最终它会因自身重量而倒塌。另一种策略是强调隔离复杂性，创建更简单的功能组件，并持续提取和重构可共享的组件。这种方法还受到端到端论点的强烈影响，以及您希望以一种让应用程序最直接地针对其特定场景和设计点进行优化的方式来构建整个系统的观点。这听起来有点像苹果派，实际上实现起来比宣布起来要复杂得多。确定哪些组件值得隔离，让团队同意并统一它们，而不是让“百花齐放”是一项艰巨的持续工作。它最终看起来不像是一个突破——它看起来像是一个工程团队正在完成的事情。对我来说，这似乎一直是一个有价值的目标。