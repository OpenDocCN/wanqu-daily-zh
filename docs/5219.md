# 我的微服务常见问题

> 原文：<https://jimmybogard.com/my-microservices-faq/?utm_source=wanqu.co&utm_campaign=Wanqu+Daily&utm_medium=website>

主要是因为我总是被问到微服务，我厌倦了不得不当场记住:

### 什么是微服务？

微服务是一种设计关注最小自治边界的服务。

### 什么是服务？

(来自[克莱门斯](https://gotocon.com/amsterdam-2016/presentation/Messaging%20and%20Microservices))服务是这样的软件:

*   由某个组织拥有、构建和运营
*   负责保存、处理和/或分发系统范围内特定种类的信息
*   可以独立构建、部署和运行，满足既定的运营目标
*   与消费者和其他服务通信，使用约定和/或契约保证来呈现信息
*   保护自身免受不必要的访问，并防止信息丢失
*   处理故障情况，使故障不会导致信息损坏

简而言之，服务是展示自主性的软件。它的构建、部署和运行独立于其他服务。它管理自己的信息，以及如何与外界通信。它处理故障，这样它的信息就不会丢失。

### 微服务需要容器/Docker 吗？

号码

### 微服务是否需要 Go/node.js/Elixir/。网芯？

号码

### 微服务需要什么特定的技术或者栈吗？

号码

### 我把我的 app 放在一个容器里，是微服务吗？

容器与软件是否是微服务没有关系。

这些技术可以帮助消除服务规模的技术障碍。

### 什么是独石？

整体软件是一种软件，其设计、信息模型和界面将多个相互竞争和相互干扰的领域结合成一个单一的应用程序和数据模型。用户和软件设计者不再对术语、建模、信息设计或界面达成一致。竞争模型之间的耦合使得未来对系统的改变变得困难或不可能。

### 如果我不做微服务，那我是在造独石吗？

不，不一定。您可以构建服务，而不必关注最小但仍然自治的边界。

### 如果我只有一个应用程序和数据库，它是一个整体吗？

不，不一定。你可能有一个单一的软件系统，它的模型足够内聚，以至于没有竞争/干扰域。如果该应用程序满足组织的已定义的操作和业务需求，那么它确实具有整体性的负面指标。

类似地，并不是所有的数据模型都是“贫血的领域模型”。如果一个领域模型是伪装成领域模型的数据模型，那么这个领域模型就是贫血的。

### 一个微服务可以太小吗？

是的，如果它不再满足服务的特征，软件就不再是服务，而是模块、功能或数据存储。

### 一个微服务能不能太大？

微服务是一种在设计上关注最小的*可能的*自主边界的服务。什么是可能的，什么是理想的，这与业务的领域、人员、技术和目标高度相关。

### 我应该从微服务还是整体开始？

微服务关注服务的最小自治边界。如果领域足够模糊或者业务目标足够多变，你可能会构建可以独立部署的模块，但是不能运行，因为它们依赖于其他模块来运行。

也许一个更好的问题是“我应该从单个应用程序还是模块化架构开始？”答案高度依赖于团队、业务和领域的成熟度。

### 微服务应该如何沟通？

以不违反服务的基本定义的方式和媒介。如果通信协议引入了违反服务设计特征的耦合，那么您必须重新评估该协议，或者重新评估您的服务边界。

例如，仅通过 RPC 进行通信的服务引入了流程(可能是时间)耦合，使得服务不再是自治和独立的服务，而是更大服务边界内的模块。

### 我应该拥有单个存储库(monorepo)还是每个服务一个存储库？

这取决于你的交付渠道。如果您可以在一个独立于其他库的源代码控制库中拥有、构建、部署和运行您的服务，这可能是一种选择。您可能决定围绕系统、应用程序、组织、服务、模块等来组织存储库。存储库边界(在某种程度上)与服务边界正交。但是，如果每个服务都有一个存储库，可能会让您的生活更轻松。

如果您觉得必须构建一个单一的存储库来托管您的服务，以便更容易地进行更改，那么您没有微服务，而是模块。您的服务不是独立的，也没有与其他服务松散耦合，因此不是服务。

### 我应该做 RESTful 服务还是异步、持久的消息传递？

这些选择与微服务是正交的。记住服务的基本定义，选择对您正在设计的通信协议和您所具有的约束有意义的内容。

我通常选择事件驱动架构作为服务间通信，但是这可以通过各种传输协议来实现，并且从来不是一个通用的决定。避免做出诸如“一切都必须使用 RESTful web 服务”这样的通用决策，尤其是因为大多数“RESTful APIs”仅仅是基于 HTTP 的 RPC。

### 我应该使用流或队列/代理将事件分派给其他人吗？

你可以两者都做，因为两者都有完全不同的设计和限制，优点和缺点。但是，从根本上说，正如您的服务应该避免将自己与他人强耦合一样，您应该避免将内部状态变化作为外部事件直接公开。暴露在服务边界之外的契约将会以不同于内部状态/通信的速度和原因发生变化。

例如，将事件源聚合的事件直接公开给外部订阅者与将数据库连接字符串提供给数据库的只读视图没有太大区别。

### 该不该做微服务？

视情况而定，在自治允许的范围内构建尽可能小的服务是一种不同的构建服务的方式，这通常会导致更多的服务。它影响的不仅仅是一个开发者，而是从概念到产品的整个价值传递链。它通常涉及灌输一种 DevOps 文化和心态，但其影响也延伸到上游。

更大的问题是——我们的软件交付价值流是否以业务需要的速度交付其价值？如果不是，我们交付瓶颈的原因是我们没有足够小的服务来更紧密地协调敏捷性吗？如果是这样，那么微服务是一个可以考虑的好选择。