# 微服务测试:介绍|作者 Nathan Peck | Medium

> 原文：<https://medium.com/@nathankpeck/microservice-testing-introduction-347d2f74095e?utm_source=wanqu.co&utm_campaign=Wanqu+Daily&utm_medium=website>

# 微服务测试:简介

## 认识测试金字塔，学习如何建立测试文化

自动化测试是软件公司取得成功所需要的最重要的事情之一。经过适当测试的代码以一致和可靠的方式运行，从而赢得客户的信任。一个没有测试，或者测试不够彻底的软件系统，将会遭受中断和回归，让客户失望。

尽管测试单一应用程序的最佳实践已经相当成熟，但在测试分布式系统(如微服务架构)时，仍然会出现一些挑战。开发人员必须确保组件具有一致的内部行为，同时还要确保每个单独的组件能够与其他组件正确集成。分布式系统需要对故障条件进行额外的测试，例如阻止一个组件与另一个组件通信的网络错误。对于一些分布式系统，系统的整体规模使得很难运行完整的端到端测试，因此开发人员需要允许他们独立测试整体架构的各个部分，同时仍然确保互操作性的策略。

本文介绍了为分布式系统创建全面测试覆盖的一些基本概念，并讨论了如何在开发过程中建立测试思维，以确保测试概念得到有效利用。

# 测试金字塔

为了构建一个全面的测试框架，我们需要从“测试金字塔”的概念开始这个概念是由 Mike Cohn 开发的，当时大多数软件测试都是通过操作软件界面来完成的。质量保证工程师将手动与软件 UI 交互，或者编写与 UI 交互的自动宏。这种类型的测试通常无法检测出代码中的潜在问题。在这种情况下，测试金字塔的概念很重要，因为它普及了这样一种思想，即这种 UI 测试应该只是不同测试层金字塔的顶端。

拥有多层测试的目标是捕捉不同类型的问题。每种类型的测试都集中在整个软件系统的不同层，并验证该范围内的行为。对于具有客户端和后端的分布式系统，测试可以分为以下几层:



## 单元测试

验证服务内部的类方法或函数的行为的测试。这些测试从服务的代码库中获取代码文件，并使用不同的输入执行其函数或类方法，同时验证每个输入的函数输出。

## 集成测试

验证单个服务的外部行为的测试。测试框架启动服务的一个实例，然后使用服务的外部接口来执行服务的业务逻辑，就像外部服务与被测试的服务集成一样。例如，通过向服务发出 HTTP 请求来测试 REST API 服务。

## 端到端测试

验证相互通信的多个服务的行为的测试。这些测试是通过在一个隔离的环境中运行多个服务来完成的，在这个环境中，这些服务实际上可以相互通信。端到端测试向一个服务(比如 REST API)发起一个网络请求，然后验证其他相关的后端服务是否已经更新，以响应第一个服务的输入。

## UI 测试

从客户端用户界面开始验证整个平台行为的测试。这将测试客户端的逻辑和后端系统，以验证客户端能够与后端系统通信，并且状态在客户端和后端之间正确更新和持久化。

# 建立测试文化

为了使测试有效，它们必须不仅仅是开发过程中的边栏。测试必须是开发和发布管道中不可或缺的一部分，测试必须能够阻止失败代码的发布。

*   没有通过测试的代码不应该被合并到您的代码库中。
*   没有通过测试的代码不应该发布给客户。

从单元测试到 UI 测试，每一层测试都建立在最后一层之上，在更高的抽象层次上测试系统:



谈到测试，工程师必须有正确的心态。他们通常负责编写测试和特性，所以他们对测试的质量和有效性有很大的控制权。如果测试没有被认真对待，软件工程师将会创建出不能测试所有边缘特性的基本测试，或者他们将会试图走捷径来获得“覆盖率”,通过那些并不真正测试任何东西的测试。

测试的目标不是通过测试。我们的目标是做出让客户满意的一致的、高质量的软件。测试确保软件质量从高开始，并随着功能的增加或对现有功能的更改而保持高质量。

这意味着需要认真对待测试失败。考试不能为了通过而改变。任何古怪的测试，有时通过了，有时却失败了，都需要极度怀疑。如果在产品中发现了一个 bug，这意味着缺少需要填充的测试覆盖。如果工程师意识到遗漏的测试覆盖，他们需要确保给他们时间和/或资源来解决这个问题。

创建一个彻底的测试文化的责任不仅仅在于工程师。产品经理也需要了解测试过程并参与其中。如果他们要求新功能的构建和发布速度快于工程师为这些功能开发良好测试的速度，那么质量将受到影响，问题将开始进入测试流程，直到最终到达客户并影响客户满意度。

# 结论

为分布式应用程序创建一个全面的测试框架需要采用多层测试。基于客户端 UI 的质量保证不足以捕捉可能出现的所有类型的错误。相反，软件工程师必须开发一种测试文化，将自动化测试整合到开发和发布管道的所有方面。这包括为类和函数编写单元测试，为服务编写集成测试，为整个系统编写端到端测试，以及同时测试客户端和后端的 UI 测试。

本系列的下一篇文章将详细阐述如何构建有效的单元测试。



