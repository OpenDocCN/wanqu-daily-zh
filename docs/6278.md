# 限制你的浏览器扩展的案例——安全上的克雷布斯

> 原文:[https://krebsonsecurity . com/2020/03/the-case-for-limiting-your-browser-extensions/？UTM _ source = Wanqu . co&UTM _ campaign = Wanqu+Daily&UTM _ medium = website](https://krebsonsecurity.com/2020/03/the-case-for-limiting-your-browser-extensions/?utm_source=wanqu.co&utm_campaign=Wanqu+Daily&utm_medium=website)

上周，KrebsOnSecurity 向医疗保险提供商 [**加州蓝盾**](https://www.blueshieldca.com/) 报告称，其网站被多个安全产品标记为提供恶意内容。蓝盾迅速删除了未授权代码。一项调查确定，它是由安装在蓝盾员工电脑上的浏览器扩展程序注入的，该员工在过去一个月里编辑了该网站。

这一事件提醒人们，浏览器扩展——无论安装时看起来多么有用或有趣——通常都具有强大的功能，可以有效地读取和/或写入浏览会话中的所有数据。正如我们将看到的，扩展制造商将他们的用户群出售或出租给可疑的广告公司，或者在某些情况下将他们交给彻头彻尾的网络罪犯，这并不罕见。

![](../Images/420457501aaa1cb2fd22a147a3a07360.png)

在该公司的一名员工编辑网站内容时，健康保险网站遭到破坏，当时使用的 Web 浏览器配备了一个曾经良性但现在已被破坏的扩展，该扩展悄悄地将代码注入页面。

有问题的扩展是[页面标尺](https://chrome.google.com/webstore/detail/page-ruler/emliamioobfffbgcfdchabfibonehkme?hl=en)，这是 Chrome 的一个附加功能，下载量约为 40 万次。页面标尺允许用户测量图像和网页上其他对象的英寸/像素宽度。但是该扩展是由最初的开发者在几年前[出售的，出于某种原因，尽管最近有多份报告指责它传播恶意代码，但它仍然可以从谷歌 Chrome 商店获得。](https://github.com/wrakky/page-ruler/issues/101)

浏览器扩展是如何导致恶意链接被添加到健康保险公司网站的？这个受到损害的扩展试图确定使用它的人是否正在将内容键入特定的网络表单，例如像 **WordPress** 或 **Joomla** 这样的博客帖子编辑系统。

在这种情况下，扩展会在用户输入并保存在页面上的任何内容的末尾添加一个 javascript 链接请求。当更改后的 HTML 内容被保存并发布到 Web 上时，隐藏的 javascript 代码会导致访问者的浏览器在特定条件下显示广告。

当这些广告被显示或点击时，到底是谁得到了报酬还不清楚，但有一些线索表明是谁在促成此事。当人们试图访问蓝盾加州时，引发反病毒警报的恶意链接从一个名为 **linkojager【】的域下载了 javascript 内容。]组织**。

它试图下载的文件 **212b3d4039ab5319ec.js** 似乎是以一个代销商标识号命名的，该标识号指定了一个因提供广告而应获得积分的特定账户。一个简单的互联网搜索显示，同样的 javascript 代码出现在[数百个其他网站](https://krebsonsecurity.com/wp-content/uploads/2020/03/212b3d4039ab5319ecjs.txt)上，毫无疑问是碰巧安装了这个页面标尺扩展的网站所有者无意中发布的。

如果我们下载该 javascript 文件的副本并在文本编辑器中查看，我们可以在文件末尾看到以下消息:

> [此处为扩展名称]的发展得到了您访问的一些网站中添加的广告的支持。在这个扩展的开发过程中，我投入了数千个小时来添加功能、修复 bug 并使事情变得更好，更不用说对所有寻求帮助的用户的支持了。
> 
> 广告支持着我们都在使用和喜爱的大部分互联网；没有他们，我们今天拥有的互联网就不会存在。类似地，如果没有收入，这种扩展(以及即将到来的新扩展)将是不可能的。
> 
> 您可以现在或稍后在设置页面禁用这些广告。您也可以通过单击部分支持按钮来最小化广告外观。这两个选项都可以通过单击每个广告角上的“x”按钮来获得。在这两种情况下，您的选择将保持有效，除非您重新安装或重置扩展。

这似乎是一个或多个联盟程序使用的样板文本，这些程序付钱给开发人员，让他们在扩展中添加几行代码。上文提到的选择退出功能实际上不起作用，因为它指向一个不再解析的域。]美国。但是这个领域仍然有助于更好地理解我们正在处理的问题。

由[域名工具](https://www.domaintools.com)(该网站的一个广告客户)维护的注册记录显示，它最初是由一个使用电子邮件地址【frankomedison1020@gmail.com**的人注册的。对这个不寻常的名字进行反向搜索，会发现其他几个有趣的域名，包括 **icontent。]美国**。**

icontent。]美国目前也没有解决，但在 Archive.org 的缓存版本显示，它曾经属于一个名为**Metrext**的广告网络，该网络将自己标榜为一个分析平台，让扩展制造商实时跟踪用户。

[![](../Images/fe8ddeb46a62b939da7978072cdad3ec.png)](https://krebsonsecurity.com/wp-content/uploads/2020/02/metrext.png)

曾经在 icontent[提供的内容的存档副本。]美国承诺“即插即用”能力。

“进入你的产品的三行，它就在现场，”我兴奋地说。“每用户高收入。”

与弗兰克·麦迪森相关的另一个领域是 cdnpps。]us ，目前重定向到域名“**money us[。]com** 。”像它的竞争对手一样，money us 的网站充满了语法和拼写错误:“使用 money us 解决方案，在不失去观众的情况下，为你的工具栏、插件和扩展带来额外的价值，”该公司在其网站顶部的横幅中说。

[![](../Images/fdd8269c656dae06f94b9eecad1b6267.png)](https://krebsonsecurity.com/wp-content/uploads/2020/03/monetizus.png)

一定不要“放松”在粗略的赚钱活动！

KrebsOnSecurity 联系了 Page Ruler 的原始开发者 **Peter Newnham** 证实他在 2017 年向 MonetizUs 出售了他的扩展。

“他们没有说他们打算用它做什么，但我猜想他们会以某种方式试图赚钱，可能是用他们网站上提到的脚本，”纽汉姆说。

纽汉姆说:“我本可以自己制作更多的广告代码，但我不想为管理所有这些而烦恼，谷歌当时似乎在制造噪音，要求打击这种行为，所以一次性付款很适合我。”“特别是我已经有 3 年没有更新扩展了，工作和家庭生活意味着我不太可能在未来用它做任何事情。”

Monetizus 没有回应置评请求。

纽纳姆拒绝透露他放弃延长合同的报酬。但是不难理解为什么开发者会将他们的作品出售或出租给一家营销公司:这些实体中的许多都承诺为拥有体面追随者的扩展提供丰厚的报酬。例如，一个名为 **AddonJet** 的竞争推广货币化平台声称，它可以为美国每 10 万名用户每天提供高达 2500 美元*的收入*(见下面的截图)。

[![](../Images/26cef23c4807ee7260763ad8aad471a7.png)](https://krebsonsecurity.com/wp-content/uploads/2020/02/addonjt.png)

阅读这里它是如何工作的！

我希望这一点是显而易见的，但是读者在安装扩展时应该非常谨慎——主要坚持那些被积极支持和响应用户关注的扩展。就我个人而言，我不怎么使用浏览器扩展。几乎在我考虑安装的每一个案例中，我都被请求的权限吓到了，最终我决定不值得冒这个险。

如果你是那种使用多种扩展的人，采取基于风险的方法可能是明智的。考虑到安装扩展通常带来的高风险，请仔细考虑拥有扩展是否真的值得。这同样适用于为网站内容管理系统设计的插件，如 **WordPress** 和 **Joomla** 。

如果一个扩展突然请求比以前版本更多的权限，不要同意更新它。这应该是一个巨大的危险信号，表明事情不对劲。如果你信任的扩展出现这种情况，建议你完全删除它。

此外，不要仅仅因为某个网站说你需要它来查看某种类型的内容，就下载并安装一个扩展。这样做几乎总是一个高风险的提议。在这里，KrebsOnSecurity 的在线安全三大规则中的第一条规则发挥了作用:“如果你没有去寻找它，就不要安装它。”最后，如果你真的想安装一些东西，确保你是直接从生产软件的实体那里得到的。

谷歌 Chrome 用户可以通过点击地址栏右边的三个点，在出现的下拉菜单中选择“更多工具”，然后选择“扩展”，来查看他们已经安装的任何扩展在 Firefox 中，单击地址栏旁边的三个水平栏，选择“附加组件”，然后在结果页面上单击“扩展”链接，查看任何已安装的扩展。