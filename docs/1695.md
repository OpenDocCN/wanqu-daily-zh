# 网飞科技博客|网飞科技博客

> 原文:[https://medium . com/网飞-tech blog/5-lessons-we ve-learned-using-AWS-1f2a 28588 e 4c？UTM _ source = Wanqu . co&UTM _ campaign = Wanqu+Daily&UTM _ medium = website](https://medium.com/netflix-techblog/5-lessons-weve-learned-using-aws-1f2a28588e4c?utm_source=wanqu.co&utm_campaign=Wanqu+Daily&utm_medium=website)

# 我们从使用 AWS 中学到的 5 个教训

在我的上一篇文章中，我谈到了我们选择 AWS 作为计算平台的一些原因。我们从自己的数据中心过渡到 AWS 大约已经一年了。到目前为止，我们已经学到了很多，我想与你分享一些我们犯过的错误和我们学到的教训可能会有所帮助。

**1。多萝西，你已经不在堪萨斯了。**

如果您习惯于在自己的数据中心设计和部署应用程序，那么您需要做好准备，忘掉许多您知道的东西。寻求理解和接受在云环境中运行的差异。

想到的例子很多，比如硬件可靠性。在我们自己的数据中心，基于会话的内存管理是一种很好的方法，因为任何单个硬件实例故障都很少发生。在易失性内存中管理状态是合理的，因为我们很少需要从一个实例迁移到另一个实例。我知道 AWS 中会有更高的单个实例失败率，但是我没有考虑到其中的一些含义。

另一个例子:在网飞的数据中心，我们有一个高容量、超快、高度可靠的网络。这为我们提供了围绕远程系统的聊天式 API 进行设计的机会。AWS 网络有更多可变的延迟。即使我们已经过渡到一个更加高度分布式的架构，我们也不得不更加结构化地处理“线上”交互。

**2。合租很难。**

在为云环境设计面向客户的软件时，一切都是为了降低预期的整体响应延迟。AWS 是围绕共享资源的模型构建的:硬件、网络、存储等。共同租用可能会在堆栈的任何级别引入吞吐量差异。您必须要么愿意放弃任何特定的子任务，要么在 AWS 中管理您的资源，以避免在必要的情况下出现共租。

你最好的办法是构建你的系统来预期和适应任何级别的失败，这就是下一课的内容。

**3。避免失败的最好方法是不断失败。**

我们有时将 AWS 中的网飞软件架构称为我们的兰博架构。无论如何，每个系统都必须能够成功，甚至完全依靠自己。我们设计每一个分布式系统都是为了预期和容忍它所依赖的其他系统的故障。

如果我们的推荐系统出现故障，我们会降低对客户回复的质量，但我们仍然会做出回应。我们将展示流行的标题，而不是个性化的精选。如果我们的搜索系统慢得让人无法忍受，流媒体应该仍然可以很好地工作。

我们的工程师在 AWS 中构建的第一个系统被称为混沌猴。混乱猴子的工作是随机杀死我们架构中的实例和服务。如果我们不经常测试我们在失败后成功的能力，那么它就不可能在最重要的时候起作用——在意外停机的情况下。

**4。用真实的比例学习，而不是玩具模型。**

在我们致力于 AWS 之前，我们花时间研究平台并在其中构建测试系统。我们努力模拟这些研究项目的实际交通模式。

这在帮助我们选择 AWS 时至关重要，但在思考我们的架构时却没有我们预期的那么有帮助。在产品构建的早期，我们构建了一个简单的中继器，并开始将全部客户请求流量复制到我们的 AWS 系统。这才是真正告诉我们瓶颈在哪里的东西，一些在白板上看起来明智的设计选择在大范围内被证明是愚蠢的。

我们继续在 AWS 内研究新技术，但今天我们是用真实数据全面研究。例如，如果我们正在考虑新的 NoSQL 选项，我们将选择一个真实的数据存储，并将其完全移植到我们想要了解的选项。

**5。承诺你自己。**

当我回顾团队今年在 AWS 迁移中取得的成就时，我真的很惊讶。但这种感觉并不总是这么好。AWS 只有几年的历史，在它内部进行大规模的构建是当今的一项开创性事业。有一些黑暗的日子，我们努力应对我们承担的任务的巨大规模，以及 AWS 与我们自己的数据中心之间的一些差异。

当你遇到障碍时，要有勇气和信念战胜它们。我们的首席执行官雷德·哈斯汀斯不仅全力支持这一迁移，他还是推动这一迁移的人！他的承诺，整个公司技术领导者的承诺，帮助我们在本可以选择撤退的时候取得了成功。

AWS 是一个巨大的服务套件，一直在变得更好，一些大的技术公司今天正在那里成功地运行。你也可以！我们希望我们的一些错误和我们学到的教训能帮助你做好这件事。

约翰·钱库提。

# 另请参见: