# 揭秘秘密。《狐狸洞的一瞥》|

> 原文:[https://medium.com/p/12ab82fda29f?utm_source=wanqu.co&UTM _ campaign = Wanqu+Daily&UTM _ medium =网站](https://medium.com/p/12ab82fda29f?utm_source=wanqu.co&utm_campaign=Wanqu+Daily&utm_medium=website)

***更新(2014 年 10 月 10 日):我们计划在 2015 年初将我们的后端服务迁移到 AWS。*T3】**

一个简单的想法或你内心深处的渴望可以在不到一秒钟的时间里匿名传遍世界，只从你和你的朋友开始。

仅在四天前[发射了](http://recode.net/2014/01/30/with-new-anonymous-social-app-secret-the-merit-is-in-the-message/)，我们所看到的简直是鼓舞人心。全国各地都在分享这样的想法:诚实的[、](https://twitter.com/getsecret/status/429755559823147008)[感人的](https://twitter.com/kangaroo5383/status/428964727319179264)、[搞笑的](https://twitter.com/getsecret/status/429114676580859904)，出乎意料的是，[很少不合时宜的](https://twitter.com/MikeIsaac/status/429318490680336384)。这再次证实了我们的信念，匿名可以促进世界的积极变化。

我们收到了几个关于“秘密”如何保护您的身份的问题。我们非常重视隐私和安全，并认为直接、公开和诚实地介绍我们系统的工作方式非常重要，这样才能赢得您和我们社区的信任。

# 看看引擎盖下面

让我们关注两个组件。存储—我们存储数据的方式和位置。传递——我们如何将秘密传递给你认识的人。

## **存储**

秘密数据存储在谷歌服务器上，这些服务器与 Gmail 位于同一个数据中心。这意味着你的秘密受益于谷歌的物理安全，本质上和你的 Gmail 一样不会被滥用。作为一名对后端服务有着深入了解的谷歌工程师，我做出了这个选择，以便秘密用户能够从谷歌强大的物理安全中受益。

一些高层次的细节:

*   Secret 托管在[谷歌应用引擎](https://developers.google.com/appengine)上。它几乎完全是用 Go 编写的，但是有 Java 和 Python 的各种组件。
*   所有通过网络发送的信息都用 TLS 加密。
*   我们使用构建在 Google 的 [BigTable](http://en.wikipedia.org/wiki/BigTable) 之上的高度可用的非关系型数据存储。没有关系数据存储。
*   所有消息数据在写入数据存储之前都会被加密。密钥存储在异地密钥库服务中，该服务会轮换密钥。
*   图像存储在[谷歌的云存储](https://cloud.google.com/products/cloud-storage/)数据库中，并通过谷歌的图像前端服务 TLS 提供。

**联系人。**当我们通过您的联系人将您与您认识的人联系起来时，我们不会向我们的服务器发送原始电话号码或电子邮件地址。相反，我们首先在本地[散列](http://en.wikipedia.org/wiki/Hash_function)联系人详细信息(使用共享 salt)，然后服务器使用它来与其他散列值进行比较。例如，[+15552786005]可能会变成[a22d75c92a630725f4]，而原来的电话号码永远不会离开你的手机。这是一种单向转换。换句话说，**我们不知道对应于哈希值的电话号码或电子邮件地址。**

重要提示:尽管我们对数据进行了加盐处理，但仍有可能将电话号码与哈希进行匹配，尤其是当加盐对攻击者来说是已知的时候。我们正在寻找使其更加安全的方法(例如，通过加入特定于客户端的数据预哈希或 Diffie-Hellman 密钥交换)。如果您有任何建议，请通过 security@secret.ly 告知我们，因为这是我们的一个活跃研究领域。

**秘密。**存储秘密元数据时不引用用户。相反，在向用户交付机密时，我们为该用户创建一个惟一的令牌，并授予其访问机密的权限，这是一种多对一的关系。令牌资源驻留在由机密而不是用户拥有的 ACL 中。消息数据(评论和帖子)在服务器上加密，并在用唯一令牌交换秘密时解密。因此，个人身份数据不需要与机密一起呈现。

这些数据结构(用户、帖子和 ACL)在我们的数据存储中是逻辑分离的。虽然这种抽象没有提供物理安全性，但它确实防止了简单的观察者识别秘密作者，并为我们提供了在未来轻松分离数据的能力。

**身份。**版主不能访问或修改特定用户创建的帖子。如果我们出于管理、调试或其他目的需要访问或修改信息，我们会采用[双人规则](http://en.wikipedia.org/wiki/Two-man_rule)。本质上，两个有权限的人必须同时转动钥匙。也就是说，两个管理员(目前是两个创始人)都必须使用他们的 Google 帐户登录(受双重身份验证保护),并在给定的时间范围内请求相同的资源。为了进一步阅读，Cloudflare 的这篇博文中[描述了一个类似的系统，称为红色十月。](http://blog.cloudflare.com/red-october-cloudflares-open-source-implementation-of-the-two-man-rule)

## **交货**

Secret 的交付系统旨在满足以下要求:

*   应该是安全的。
*   应该很快。
*   它应该学会。

**当你发布**时会发生什么

*   文章首先被存储并交付给作者。
*   一个异步作业运行并确定应该将秘密传递给谁，也就是我们认为与您有关系的人，或者您可能会发现与之相关的人。接触只是算法中的一个强信号。
*   每个交付对每个用户来说都是唯一的，并且可以被重新编译。这有助于我们识别和减少垃圾邮件和其他不必要的秘密活动。

**没有发生的事情**

*   我们不会将您的所有秘密发送给通讯录中的所有人。仅仅因为你的联系人中有人，并不一定意味着他们会看到你的每个秘密。

**计时。**虽然我们的交付管道有很高的交付吞吐量，但并不总是立即释放机密。例如，用户在系统上的“朋友”越少，我们显示给他们的就越少。这有助于避免孤立个人及其秘密的简单伎俩。

作为一个朋友很少或者没有朋友的用户，很多你可能认识的人的秘密是看不到的。一旦你有了足够多的朋友，我们会向你展示更多，比如一个特定的秘密来自“你的圈子”，这个圈子被定义为“朋友”或“朋友的朋友”。然后，在相当多的帖子之后，我们会向您展示某个帖子是否来自朋友。这对于在不知道某人身份的情况下建立联系至关重要。

## 将这一切结合在一起

我们致力于以一种高度安全的方式构建技术，但仍然为我们提供了灵活性，使我们的产品更人性化。只有当复杂的技术能够以简单、美丽和完整的形式呈现时，才能做出伟大的产品。

在这个时代，隐私和安全比以往任何时候都更重要。这对我们谷歌和 Square 来说很重要，并将永远是 Secret 的重中之重。

戴维·拜托
*联合创始人，秘密*

你应该在推特上关注我们，[@偷偷的](http://twitter.com/secretly)。

想和我们一起工作吗？电子邮件 [work@secret.ly](mailto:work@secret.ly) ，我们正在招聘工程师。