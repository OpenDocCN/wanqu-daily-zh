# Instagram 提高了他们应用的性能。以下是方法。-高可扩展性-

> 原文:[http://high scalability . com/blog/2014/9/29/insta gram-improved-their-apps-performance-heres-how . html？UTM _ source = Wanqu . co&UTM _ campaign = Wanqu+Daily&UTM _ medium = website](http://highscalability.com/blog/2014/9/29/instagram-improved-their-apps-performance-heres-how.html?utm_source=wanqu.co&utm_campaign=Wanqu+Daily&utm_medium=website)

![](../Images/e7b70a6c02b1e7425849dd6d1af801f2.png)

扁平化设计仅仅是另一张漂亮的脸，还是披着 UI 革命外衣的巨大性能改进？事实证明，扁平设计是一个冰冷的性能胜利。

Instagram 的工程师泰勒·基夫特(Tyler Kieft)在 [@scale 会议](http://atscaleconference.com/) : [典型安卓系统的 insta gram](https://www.youtube.com/watch?v=GHTO2WKDO6I#t=8927)上做了一个简洁而又内容丰富的演讲，对这一点以及更多内容进行了专业的解释。这个演讲是脸书关于如何设计全球移动应用的系列演讲的一部分，在这个世界上，手机更慢，屏幕更小，网络比美国更慢。

为普通手机而不是高端手机设计需要 Instagram 团队以一种深刻的方式重新思考他们的设计。Tyler 演讲中的一个启示是**转向扁平化设计**在使应用程序更漂亮、更可用方面有巨大的作用，而且它还极大地提高了性能。

这真是一个惊喜。我只认为平面设计只是一种思考如何构建漂亮 ui 的方式。我真傻。感谢泰勒如此清晰有力地解释了扁平化设计的好处，用 Instagram 作为可能性的一个很好的例子。

平面设计是反 skeuomorphism，走向数字原生，避免对现实外观的盲目痴迷，采用简单的元素，简单的排版，平面的颜色和简单的设计。

使用平面设计的 Instagram 能够将其冷启动时间缩短 120 毫秒。它还能够将显示提要屏幕所需的资产数量从 29 项减少到 8 项。同时使应用程序更漂亮，更可用，更关注不同手机尺寸的内容。

扁平化设计是如何让这一切成为可能的？

## 转向扁平化设计

*   Instagram 重写了他们的用户界面，专注于在 Android 上提供的各种用户界面上实现更好的性能。

*   当 Instagram 于 2012 年在 Android 上发布时，它是由 3 个人在大约 4 个月内完成的。两名工程师和一名设计师。Android 版本使用了与 iOS 版本相同的设计。

*   该设计使用了甜美的渐变和大量的用户界面元素。

*   向 iOS7、向扁平化设计的过渡，让产品变得更简单、更美观。不再有渐变。拿出盒子。不再有阴影。

*   从适应扁平化设计的经历中**他们学到了**:

    *   **扁平化设计是一个机会，可以做得更少**，更快地开发代码，更快地交付产品。这对开发人员来说非常好。

    *   **扁平设计更具性能**。不仅仅是开发者做的少了，手机显示 UI 的工作也少了。

*   利用从 iOS7 平板设计重新设计中学到的知识，新 Android 版本的目标是:

    *   **让它变平，让它变快**。这不是重写。导航模式没有改变。

    *   **注意屏幕空间**。重新审视每一个屏幕，找出如何更好地适应所有屏幕尺寸。

    *   **把它变漂亮**。这是他们在 Instagram 上所做的一切的基础。

*   总体效果是戏剧性的简化。做了哪些改变？

    *   **把 chrome 的所有东西都拿出来**。去掉了所有的渐变和亮面按钮。去轮廓形状，而不是图标渐变按钮。剩下的是纯色和扁平的形状。希望用户界面淡出背景。

    *   **拿出评论图标**，让评论占满屏幕宽度，给评论文字更多空间。让内容在屏幕上突出。用户界面越少，使用小屏幕的人就有更多的空间阅读文本。

    *   **分叉拍照的手机布局**。在小型手机上，他们使用一种在屏幕顶部有操作按钮的设计。对于更大的屏幕，所有的命令都在底部。

    *   **整个应用程序中不必要的用户界面被移除，以便更专注于内容**。搜索屏幕上的三层 chrome 被缩减为两层。这为小型手机腾出了大量空间。三星 Galaxy 的按钮变薄了，这很容易通过平面设计以编程方式实现，为内容留出了大量空间。

    *   注意，这个演讲有很多不同设计的好图片，所以只看之前和之后的图片是很值得的。

## 为什么要扁平化设计？

*   **通过资产着色减少资产出货**。这意味着 APK 较小，这对小型网络非常有利。神奇的是**资产着色** **(** 我从来没听说过的东西)。[资产着色](http://blog.danlew.net/2014/08/18/fast-android-asset-theming-with-colorfilter/)意味着资产，在这种情况下是图像，可以通过编程着色。例如，一颗灰色的心可以通过编程被染成红色。资产着色意味着需要运输的资产更少。传统上，每个按钮状态(按下、未按下、选择等)都需要单独的图像。通过着色，不同州的所有图像不再需要运输。只需要一个图像，不同的状态可以着色。

*   **加载更少的资产**。这意味着 UI 显示速度更快，存储位图使用的内存更少。需要显示的每个资产都必须从闪存中读取并解码为位图。做得越少，应用程序变得越快。

*   **更快的迭代次数**。如果你想改变颜色或新的发展，你不需要设计师了。只需更改代码并重新编译。

*   结果是:

    *   **在平面设计之前，显示 feed 屏幕需要 29 种不同的资产**。在平面设计之后，用了 **8 个资产**来显示同一个页面。只需要形状来显示图标和标志。其他所有东西都用代码绘制成纯色和矩形。这使得所有设备的冷启动时间减少了**120 毫秒**。

    *   **扁平化设计让整个应用变得更快**。每一个屏幕做得越来越少。加载的资产更少，整个应用程序感觉更好。用户在他们的评论中评论了重新设计后应用程序的速度。人们真的很喜欢。人们欣赏与平台匹配的设计带来的速度提升。

## 改善冷启动时间

*   冷启动时间是应用程序启动并响应所需的时间。从点击图标到点击应用程序，它的工作。我们的目标是让**应用程序启动速度超快**，这样低端手机的用户就有了很好的体验。

*   几年前，在低端 Galaxy Y 上，Instagram 的启动时间是 3 秒。在高端 Galaxy S5 上，启动时间为 750 毫秒。

*   现在，在 Galaxy Y 上，Instagram 需要 1.5 秒才能启动。在 Galaxy S5 上需要 400 毫秒。

*   怎么会？(除了移除资产)

*   **应用范围内的单例被发现速度很慢**。通过计时找到。

    *   很多**重度单机**在 app 可以启动之前就启动了:HTTP 客户端、Cookie Store、图片缓存、视频缓存。并不真的需要这些东西来向用户展示 UI。它们可以在后台并行加载。

    *   **两部分惰性加载**

        *   想要**在后台初始化 singleton**但是程序员仍然把它当作一个对应用程序总是可用的 singleton。我不希望程序员必须检查单例是否可用，因为那样它就不是单例了。

        *   **在 UI 线程**上创建足够多的对象，这样公共 API 就可以完全发挥作用，并且可供程序员使用。将繁重的工作交给后台线程。对于缓存，这意味着打开和读取磁盘存储。对于客户端，证书在后台加载。Cookies 在后台进行反序列化和解码。有了这些改变，用户界面在屏幕上出现得更快了。

*   新闻浏览速度很慢。通过方法跟踪找到。

    *   Newsview，显示你所有的喜欢和评论，最初是作为 webview 编写的。它需要在启动时加载，以便尽快向用户显示他们的数据。

    *   问题是无法控制网络视图。它有自己的堆栈和缓存系统。**转换为原生**。花了 2-4 周。本地转换后，冷启动时间**减少了 30%**。

## 经验教训

*   **可实现快速冷启动时间**。如果他们很快，他们甚至可以变得更快。剖析、修复、迭代。

*   **明智地使用像素**。查看每个屏幕，看看哪些是不需要的。其他国家的用户使用的手机比美国的小得多。

*   手机喜欢简单的设计，手机开发者也是如此。这要容易得多，也快得多。

## 相关文章