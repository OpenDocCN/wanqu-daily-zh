# 为什么我讨厌你的单页应用。好的，现在我已经引起你的注意了……|作者:Stefan Tilkov |我们已经搬到 freeCodeCamp.org/news | Medium

> 原文:[https://medium . com/@ stil kov/why-I-hate-your-single-page-app-f 08 bb 4 ff 9134？UTM _ source = Wanqu . co&UTM _ campaign = Wanqu+Daily&UTM _ medium = website](https://medium.com/@stilkov/why-i-hate-your-single-page-app-f08bb4ff9134?utm_source=wanqu.co&utm_campaign=Wanqu+Daily&utm_medium=website)

# 为什么我讨厌你的单页应用

好了，现在你注意到我了，我想说我并不讨厌你的单页应用。我只是觉得这非常令人讨厌，除非它是非常非常少的例外情况之一，实际上值得以这种方式开发。因为这些很少，所以很有可能你的不符合条件。

也许你的单页应用不同，但我知道的那些打破了我浏览器的大部分功能，如后退和前进按钮，页面刷新，书签，发送链接，或在新窗口或标签中打开链接。它们无法链接到我看到的东西。(哦，我知道这条规则也有例外，但它们通常需要付出努力——比许多开发人员准备投入的要多得多)。尽管它们显示的实际信息和提供的交互非常简单，但它们臃肿且加载缓慢。

我只是一个脾气暴躁的老家伙吗？是的，但这是题外话。我的观点是，从架构的角度来看，大多数单页应用程序都是做出错误选择和错过重要机会的结果。

我对单页应用程序(简称 SPAs)的主要不满是，它们不在“网络”上。在这方面，它们非常类似于 SOAP web 服务。他们有一个 URI，但只针对整个东西，而不是里面所有有价值的东西。(还是那句话，我知道你可以用不同的方式建造你的 SPA，但大多数人不会。)我认为，如果你构建一个 web 应用程序，它应该有一个名副其实的 web UI，类似于应该与 web 有关的 web 服务。

如果这一切对你来说很抽象，想想是什么让网络成为网络。网络最重要的一个特征就是你可以链接到各个事物。应用程序中的每个重要概念都应该是一个可能的切入点。这使得任何人、任何地方都可以使用它作为链接的目标。事实上，用户可以在他们访问过的事物的历史中前进和后退，这不是一个错误，而是一个基本的特性。至关重要的是，这些目标中的每一个都要快速返回响应，因为您创建的任何开销都必须多次支付。后退和前进按钮不应该在应用程序之间导航。

我几乎能听到你说:“但我不关心网络。我在构建一个应用程序，而不是一个网站。”对此我说:那就继续吧，使用你的桌面或移动操作系统的原生工具包，构建一个应用程序，或者构建一个 applet，或者一个 Flash 或 Silverlight 应用程序。我没意见。我甚至不反对你使用浏览器作为应用程序运行时来构建同样的东西。请注意，当您以这种方式做事时，您的应用程序就像是作为 Java applet 构建的一样在 web 上。意识到你在牺牲什么。

这就是我认为人们错误选择的原因。似乎对许多人来说，建立一个 SPA 已经成为建立一个现代 web 应用程序的同义词。任何批评这种建筑方法的人显然没有向现代世界迈进。我完全不同意。人们选择 SPA 时并没有意识到它的缺点，包括框架不再维护、客户端代码几乎无法控制的复杂性，以及性能和可访问性问题。

但更重要的是，他们错过了不选择水疗的好处。他们没有意识到这种选择的好处。那么，这种选择是什么？它将构建一个经典的 web 应用程序，包括呈现服务器端的 HTML，并尽可能少用 JavaScript 来增强浏览器的功能。在这种架构方法中，非常清楚的是，实际业务逻辑的责任完全落在服务器上。这包括管理页面之间转换的服务器端状态机。同样，这不是一个 bug，而是一个特性:它使服务器端的快速更改能够在任何地方立即生效——包括除了 web UI 之外您可能最终构建的其他类型的客户端。业务逻辑不属于客户端，除非您喜欢在您支持的每种客户端中冗余地维护相同的逻辑(当然，除了在服务器上维护它之外，请记住，您永远不能信任任何客户端)。从服务器端的角度来看，您可以拥有的最佳架构是您十年前就可以(并且应该)构建的架构:遵循 REST 原则，包括无状态通信和资源标识。

有些人反对这样做，因为他们认为 SPA 给了你一个更好的架构。我不同意:对于 SPA，你的架构通常是你的框架所建议的架构，因为从 web 的角度来看，你的 SPA 是 web 所关心的单一事物。对于非 SPA 方法(从现在开始我将称之为 [ROCA](http://roca-style.org) )，管理应用程序的架构是 web 本身的架构。再说一次，你的服务器承担呈现 HTML 的枯燥任务是一种资产，而不是负担。就我而言，我不太相信任何现有的客户端 JavaScript 框架的稳定性和长期可维护性。

SPA 方法产生的问题的一个很好的例子是工作的并行化。如果你有一个多人的团队，或者上帝禁止，多个团队在同一个 SPA 上工作，你需要想出一个好的方法来支持它。相反，您可以让这些团队中的每一个都构建自己的 web 应用程序。这些应用程序中的每一个都可以连接到同一组织在同一时间构建的所有其他应用程序(也可以连接到驻留在任何地方的所有其他 web 应用程序，如果你愿意的话)——事实上依赖于 web 的核心力量。

就可访问性而言，在服务器端呈现语义 HTML 提供了开箱即用的支持。使用 HTML 只能做有限的事情，这也是一个特性，而不是一个错误。

你也可以在水疗中心解决这些问题。但这需要努力。有了 ROCA 方法，您就有了一个众所周知的、非常成熟的、经过验证的架构可以依赖。

当然，这并不意味着你不使用 JavaScript 和 Ajax。我完全意识到，如果没有 JavaScript 来支持页面内修改，就无法构建一个现代的用户界面。但这是可选的增强，而不是架构的驱动因素。(即使从 REST 的角度来看，使用 JavaScript 也是完全没问题的:在 REST 论文中，它实际上是作为一个可选的约束被称为“按需编码”。但它的预期目的是作为一种手段来扩展浏览器，以支持它本身不支持的内容。)据我所知，几乎在所有情况下，你的 SPA 对用户都没有任何好处，相反，采用浏览器功能只有积极的一面。你可能认为这对开发者有好处，但首先，你应该把这些放在用户利益之后，其次，它们大多是假装的，特别是从长远来看。

所以建你的温泉吧，我不介意，只要我不用它们。只是要意识到你放弃的是什么。