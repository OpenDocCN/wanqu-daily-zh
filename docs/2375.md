# 工程师不应该写 ETL:构建高功能数据科学部门指南|缝合修复技术——多线程

> 原文：<http://multithreaded.stitchfix.com/blog/2016/03/16/engineers-shouldnt-write-etl/?utm_source=wanqu.co&utm_campaign=Wanqu+Daily&utm_medium=website>



“你的团队和数据科学家之间的关系如何？”毫无疑问，这是我在面试数据平台工程师时最常被问到的问题。这是一个很好的问题——考虑到数据领域工程工作的现状，这是在评估新机会时进行尽职调查时必须问的问题。我总是很乐意回答。但我希望我不必，因为这是一个由怀疑和恐惧引发的问题。

这是为什么呢？如果你阅读硅谷数据科学和算法开发部门的招聘宣传，你可能会相信数据科学家和工程师之间的关系是高度协作、有机和创造性的。就像豌豆和胡萝卜一样。

然而，这种情况很少发生，这并不是什么秘密。大多数商店培养工程师和科学家之间的关系，这种关系介于不存在的和高度失调之间。

## 典型的数据科学部门

大多数公司将其数据科学部门分为 3 个组:

*   **数据科学家**:那些“比统计学家更好的工程师，比工程师更好的统计学家”的家伙。又名，“思想家”。

*   **数据工程师**:这些人构建管道，为数据科学家提供数据，并从数据科学家那里获取想法并加以实施。又名“实干家”。

*   **基础设施工程师**:这些人负责维护 Hadoop 集群/大数据基础设施。又名“水管工”。

数据科学家经常对工程师将他们的想法投入生产的速度缓慢，以及工作周期、路线图和动机不一致感到沮丧。当他们的想法的第一个版本进入 A/B 测试时，他们已经有了第二个和第三个版本。他们的沮丧是完全有道理的。

数据工程师经常感到沮丧，因为数据科学家产生效率低、写得差的代码，很少考虑生产想法的维护成本，要求不切实际的功能，从而扭曲了实现努力，但收效甚微……这个列表还在继续，但您已经明白了这一点。

基础设施工程师对每个人都让集群过载和填满磁盘空间感到沮丧。他们与科学家和工程师保持一定的距离，这意味着他们永远无法了解基础架构的使用情况，或者需要使用它来解决的业务和技术问题。这让他们觉得无力改善现状。相反，他们的反应是使基础设施更加严格。反过来，每个人都对他们感到沮丧。

这是一个恶性循环。

## 哪里出了问题？

我们都知道这个标准是不合标准的，招聘炒作也是如此。那么，我们为什么不修理它呢？为什么每个数据科学和算法开发团队似乎都陷入了同一个功能失调的模型？

我把这归咎于两件事，在这里以一些观察的形式提出来:

### 你可能没有大数据

在过去的五年里，数据处理工具和技术有了巨大的发展。除非您需要处理超过数 Pb 的数据，或者您每天要接收数千亿个事件，*大多数技术已经发展到可以满足您需求的程度*。

除非您需要拓展这些技术的能力范围，否则您可能不需要一个由专业工程师组成的高度专业化的团队来构建基于这些技术的解决方案。如果你设法雇用他们，他们会感到厌烦。如果他们感到无聊，他们会离开你去谷歌、脸书、LinkedIn、Twitter 等真正需要他们专业知识的地方。如果他们不觉得无聊，那么他们很可能相当平庸。平庸的工程师确实擅长于建造巨大的复杂的、难以处理的混乱局面，他们称之为“解决方案”。混乱往往需要专业化。

### 每个人都想成为“思想家”

因为听起来是个很酷的角色！你可以整天无所事事，想出更好的方法来做事，然后把你的想法交给那些急于将它们投入生产的人。去吧，把它卖给街上的某个人。我打赌他们会抓住这个机会！数据科学家，尤其是那些对这个行业还不太了解的新手，尤其渴望得到这样的职位。

那是因为我们已经训练他们渴望它。这要感谢更大、更成熟的公司。在大数据热潮之前拥有商业智能部门的公司…

传统的商业智能部门由三个角色组成:ETL 工程师、报表开发人员和 DBA。ETL 工程师将数据移入数据仓库。他们痴迷于金博尔和他的维度建模指南。另一方面，报表开发人员是以使用特定工具(如 Microstrategy 等)设计报表为职业的人。他们是专家。DBA(和其他工具管理员团队)尽最大努力让事情保持运行。

事情是这样的。ETL 工程师、报表开发人员、DBA 都是“实干家”。因此，大约 10 年前，当大数据和数据科学开始成为流行语时，有一些成熟的 BI 部门，他们有很多实干家，但没有足够的思想家。所以，他们让“思想者”成为一个角色。我们将数据科学家与已建立的 BI 部门整合在一起，承诺他们能够摆弄数据并改变业务流程。事实上，这并没有发生。这些数据科学家偶尔会设法创建一些非常酷和有效的解决方案，但总的来说，他们专注于执行略高层次的报告开发，并反馈给业务部门(这在很大程度上忽略了他们的建议)。

但是这个角色听起来真的很好，而且*很容易招到*。传统的、现代的数据科学部门就这样诞生了:数据科学家(报告开发人员，又名“思想者”)、数据工程师(ETL 工程师，又名“实干家”)和基础设施工程师(DBA，又名“管道工”)。

*呜呜。*看起来商业智能部门从未真正改变，我们只是添加了一个 Hadoop 集群，并开始用一个新名称来称呼它。

## 真的有那么糟糕吗？

事实上，这取决于你想要实现什么。如果您同意上述观点，那么您必须接受这样一个事实，即自商业智能出现以来，它已经让公司生存了很多很多年。但我认为，如果您想让您的数据科学团队真正做得比构建 PowerPoint 平台和仪表板更多，这是一个非常低效的模型。

阻止思想家和实干家模型实现其招募宣传的根本缺陷是，假设存在一群没有灵魂的非平庸的实干家工程师，他们急切地实现数据科学家的想法和愿景。这听起来像是你认识的有才华的工程师的简介吗？

在这种模式中，实干家对他人想法的实施、失败和支持全权负责，而思考者因其成功而获得奖励。这是团队之间竞争和错位的核心。它创造了一个 It 团队，而不是一个工程团队。

为了吸引有才华的工程师担任这样的角色，你需要一些真正大的扩展问题，以分散他们对你雇佣的没有灵魂的从属角色的注意力。你需要大数据的存在所产生的问题类型。还有，不好意思，你没有大数据。

相反，你会雇佣平庸的工程师。他们会制造出极其复杂的混乱局面。这将加剧争论。*欢迎来到恶性循环*。最终结果是，一个数据科学家团队被赋予了与报告开发人员差不多的权力，因为他们缺乏可靠的创新数据平台的支持。如果你的招聘宣传让他们担任报告开发员，他们可能会选择另一条路。**毕竟，他们是思想家，不是实干家！**

## 一个不同的数据科学部门

我们需要创新和发展模型，而不是试图模仿知名公司的结构(他们从 BI 过渡到 DS )!*不再尝试设计更快的马…*

几年前，正是因为这个原因，我搬到了 Stitch Fix。在 Stitch Fix，我们努力在我们生产的算法和分析方面成为世界上最好的。我们努力用我们的产出来领导业务，而不是告知业务。除非你愿意大胆挑战并重新思考你知道的不合标准的事情，否则这是一个很难完成的任务。

在看到该部门在过去两年中的成长和发展后，我有信心分享我们正在做的事情。

鉴于我们的目标是领导而不是提供信息，我想向您提出我认为构建数据科学部门的更好方式。一种允许角色自治、真正的生产所有权和产出责任的方式。这种方式非常适合业务(和数据)模式快速发展的公司。

接下来是建立一个数据科学团队的蓝图，该团队可以快速调整和反应，以便**通过思想领导、API 和代码的产生来领导和创新**，而不是对变化做出反应，并拼凑一些 PowerPoint 演示文稿，绝望地试图重新引导直觉和直觉。

### 让每个人都成为世界上最好的人

让我们忘记传统的角色，转而想想让人们在早上兴奋地来工作的内在动机。

不管是什么角色，优秀的人和伟大的人之间的根本区别在于他们对创新的渴望和天赋。伟大的人能够发现并创造性地解决那些让平庸的人困惑的问题。他们擅长并渴望自主、自主和专注的环境。

装配线从科学家到工程师的转移创造了截然相反的环境。(事实是，即使是思考者也不愿意依赖行动者)。诀窍是创造一个环境，让每个人都有自主权、所有权和专注。

然而，重要的是要认识到工程师和数据科学家对完全不同的任务充满激情:

*数据科学家*:

数据科学家喜欢解决与业务垂直相关的问题，并通过他们的努力对项目/组织的成功产生重大影响。他们着手优化某件事或某个过程，或者从头开始创造某样东西。这些都是面向点的问题，它们的解决方案往往也是面向点的。它们通常包含商业逻辑、对事情如何完成的重新想象以及适量的创造力。因此，他们需要对业务的特定部分如何运作有深刻的理解，并与垂直业务有高度的合作关系。

工程师:

工程师擅长抽象、概括，并在需要的地方找到有效的解决方案。这些问题在本质上通常是横向的。当它们被广泛应用时，会产生最大的影响。他们需要对业务如何运作有一个很好的总体理解，但是解决方案的抽象本质意味着他们对业务逻辑不太重视，并且不需要与业务中的垂直行业有很深的合作关系或对其有很深的理解。

### 混合型思想家和实干家

对于数据领域的工程师来说，一个普遍的恐惧是，不管你的工作描述或招聘宣传如何，你都在秘密地寻找一个 ETL 工程师。

如果你没有意识到的话，**没有人喜欢编写和维护数据管道或 ETL** 。这是业内最棘手的问题。ETL 工程角色是平庸的典型温床，这真的不应该令人惊讶。

工程师不应该写 ETL。出于对职业中一切神圣不可侵犯的事物的热爱，这不应该是一个专注的或专门的角色。没有什么比编写、维护、修改和支持 ETL 来产生您自己从未使用或消费过的数据更让人伤脑筋的了。

取而代之的是，让人们对他们生产的工作拥有端到端的所有权(自主权)。对于数据科学家来说，这意味着 ETL 的所有权。这也意味着对数据分析和数据科学成果的所有权。数据科学家的许多努力的最好结果是一个为机器消费者而不是人类消费者设计的人工制品。它不是报告、仪表板或 PowerPoint 演示文稿，而是集成到工程堆栈中的某种算法或 API 从根本上改变业务运营的东西。自治意味着数据科学家也拥有这些代码。*一直到生产。*他们应该能够开发和部署 it 而无需征得工程师的许可，对支持负责，遵守性能、延迟和 SLA 要求等。

这将垂直责任和关注点直接交给了数据科学家。但是，数据科学家通常不是受过传统训练或技术高超的软件工程师。你最多可以说它们已经足够了。所以你会认为他们会制造一场大混乱。

这就是 ETL 和 API /生产算法开发通常以流水线方式交给工程师的原因之一。但是，所有这些任务本质上都是垂直(点)聚焦的。数据领域的天才工程师几乎总是最专注于水平应用。

那么，在这个新的、水平的世界里，工程师的角色是什么？总而言之，工程师必须部署平台、服务、抽象和框架，让数据科学家能够自主地构思、开发和部署他们的想法(比如用于构建、调度和执行 ETL 的工具、框架或服务)。我喜欢把它想象成乐高积木。工程师设计新的乐高积木，数据科学家以创造性的方式组装这些积木来创建新的数据科学。这绝对是说起来容易做起来难，但是:

*   工程师的工作在本质上可以是完全水平的。这使他们能够专注于构建广泛适用于多个数据科学问题的技术。这最大化了工程输出的杠杆作用。这很好，因为数据科学部门的数据科学家可能比工程师多得多。

*   工程师可以专注于他们最擅长的事情:抽象、概括，并在需要的地方创建高效、可扩展的解决方案。

*   工程师可以自主操作。以这种方式部署的工程团队的产品应该看起来像“魔术”。对于数据科学家来说，事情应该“井井有条”,因为他们的需求是可预见的，并且他们使用的平台、服务和框架考虑了可伸缩性和弹性。

*   为了更好地工作，大多数时候工程师需要预测数据科学家的需求。他们应该提前多步开发。

*   对于才华横溢、富有创造力的工程师和数据科学家来说，这是一件非常有趣的事情。

### 所以，所有的工作都是科学家做的？

不，一点也不。如果说有什么不同的话，那就是工程师的角色比标准模型中的更具挑战性，要求也更高。数据科学家可能也是如此。我们不是为了效率而优化组织，而是为了自治而优化。所提供的是清晰的想法所有权和实现想法的责任。

这些角色对那些拥有企业家心态的人来说非常有吸引力。它允许快速行动，消除了建立不必要共识的需要，并为破坏性创新打开了大门。但这确实是以专业化为代价的，因此也是以效率为代价的。

然而，人们并不期望数据科学家会突然变成天才工程师。也不是说工程师们会对所有的业务逻辑和垂直计划一无所知。事实上，伙伴关系是这种模式成功的内在因素。工程师应该将自己视为“托尼·斯塔克的裁缝”，打造盔甲，防止数据科学家陷入陷阱，产生不可扩展或不可靠的解决方案。

在缺乏推出解决方案的抽象和框架的情况下，工程师与科学家合作创建解决方案。但是，不是以放手的形式。相反，工程挑战变成了构建自助服务组件，以便数据科学家可以自主迭代业务逻辑和算法，将他们的想法传递给业务。在最初推出解决方案后，谁拥有什么就很清楚了。工程师拥有他们构建的基础设施，数据科学家拥有他们提供的业务逻辑和算法实现。迭代不需要任何形式的紧密耦合。

### 充满挑战的道路

在这一点上，你可能会怀疑是否有可能完成这样的事情。然而，我认为回报是值得冒险的。以下是一些需要注意的事情，它们可能会阻碍或逆转进展:

人们反对改变。人们倾向于重建他们已经习惯的工作环境。这就产生了回归思考者-实干家模式的压力。新员工需要尽快适应新的结构。当项目遇到问题时，尤其需要保持警惕——例如，API 中断或算法产生不良结果。

在这种情况下，人们的反应非常被动。他们会坚持让工程师接手。但是，他们只是治标不治本。工程师应该构建更好的平台支持、可见性、抽象和弹性。而且，他们应该意识到工程师也会破坏东西…没有人能免于犯错和中断生产。

平台工程师走在数据科学团队的前面是绝对必要的。您需要非常敏锐的平台工程师，他们能够在急需服务、框架和功能之前做出直观的决定。缺乏从科学家到工程师的交接意味着工程师没有对科学家交付的需求做出反应的奢侈。

请记住，工程师正在创建乐高积木，而数据科学团队正在组装它们。如果数据科学团队不需要组装正确的模块，他们仍然会努力创造解决方案。他们要么通过组装错误的积木(圆孔中的方钉)，要么通过创造自己的积木来解决问题。通常，他们会制造一个大混乱。一旦建立就很难撤销。

### 不要害怕低效率

授权数据科学家承担如此广泛的任务的后果是，他们不太可能产生像工程师一样技术高效的代码和解决方案。为了速度和自主性，我们牺牲了技术效率。重要的是要认识到这是一种有意的权衡。

然而，端到端所有权带来了一系列不太明显的效率。数据科学家是他们所开发的实现领域的专家。因此，他们能够很好地在技术和支持成本与需求之间进行权衡。例如，他们可以决定在某些地方采样数据，在有意义的地方使用近似的方法，并决定 nix 或 punt 特性，这些特性可能只产生非常小的业务影响，但会带来极高的开发或支持成本。在科学家和工程师之间的流水线移交模式中，这些事情很少发生(即使发生，通常也需要多次协商)。

总的来说，人们希望自主性的好处和由此产生的创新将超过缺乏技术专业化在允许数据科学家拥有他们的完整堆栈方面的技术低效。

## 未来

我不会宣称我们已经发现了构建数据科学部门的最佳方式，或者这是您组织的最佳结构。但是，这绝对不是试图建立一个更快的马，我强烈地感觉到这是一个更好的解决方案。

我真诚地希望，通过分享我们所做的事情，它将鼓励非传统结构部门的其他人也这样做，激励处于形成阶段的数据科学部门的领导者跳出框框思考，找到挑战传统的勇气，并告诉对传统角色感到沮丧的工程师和数据科学家，有不同类型的环境可供操作。

* * *

<sup>1</sup> 问一个面试你的工程师，数据科学家坐在哪里(反之亦然)。如果他们不知道，不要走…跑。 [←](#footnote1-return)

