# 你不需要理解编程来欣赏这种令人敬畏的咆哮

> 原文：<https://gizmodo.com/you-dont-need-to-understand-programming-to-appreciate-t-1739927472?utm_source=wanqu.co&utm_campaign=Wanqu+Daily&utm_medium=website>

[Linus Torvalds](http://gizmodo.com/tag/linus-torvalds) 是一位传奇的软件工程师，也是 Linux 内核的创始人。他也不能忍受糟糕的代码，所以坐下来，拿起爆米花，尽情享受。

死亡之友协会有声读物剪辑

星期五下午 3 点 38 分

Torvalds [发布了对 Linux 版本 4.3 中出现的一些新代码的回应](http://lkml.iu.edu/hypermail/linux/kernel/1510.3/02866.html) 。挺有技术含量的，但就算没把握住细微差别，那精细的脏话也能被所有人欣赏:

> 基督教徒。这太不公平了
> 
> 。我得到的冲突是由于愚蠢的新 gcc 头文件废话。但让我心烦的是，这些废话是出于完全虚假的理由。
> 
> 这是 net/ipv6/ip6_output.c 中的旧代码:

> MTU-= hlen+sizeof(struct frag _ HDR)；
> 
> 这是新的“改进的”代码，它使用想要神奇的内置编译器支持的花哨东西，并在它不存在时具有愚蠢的包装函数:
> 
> if (overflow_usub(mtu，hlen + sizeof(struct frag_hdr)，&mtu) ||
> 
> mtu <= 7)
> 
> goto fail _ toobig
> 
> 任何认为上述内容(a)清晰易读(b)高效(即使有神奇的编译器支持)(c)特别安全的人都是不称职的，都出去吃午饭了。
> 
> 上面的代码是 sh*t，生成的是狗屎代码。看起来很糟糕，也没有理由。
> 
> 代码可以很容易地用一个可理解的条件来完成，编译器实际上会生成更好的代码，代码看起来会更好，更容易理解。为什么不是这样
> 
> if(MTU < hlen+sizeof(struct frag _ HDR)+8)
> 
> goto fail _ toobig
> 
> MTU-= hlen+sizeof(struct frag _ HDR)；
> 
> 这是相同的行数，没有使用疯狂的助手函数，没有人知道他们做什么，而且它实际做什么更明显。我保证第二个更明显的版本更容易阅读和理解。有人真的想争论这个吗？
> 
> 真的。给我一个理由，为什么它用两种不同的条件和一个闪亮的新的非标准函数以愚蠢的方式编写，它需要特定的编译器支持来生成甚至中途正常的代码，甚至然后生成更差的代码？一个闪亮的功能，我们从来没有在其他地方需要过，这只是编译器-自慰。
> 
> 是的，如果整个“hlen +xyz”表达式溢出，您仍然会遇到溢出问题，但是坦率地说，“overflow_usub()”代码也有这个问题。所以如果你担心这个，那么你一开始就没有做正确的事情。
> 
> 所以我真的看不出这种完全愚蠢的废话的理由。
> 
> 告诉我为什么。因为我没有拉这种完全疯狂的东西，在 rc7 时间产生冲突，这似乎完全没有理由成为一个白痴不可读的混乱。
> 
> 该代码似乎*设计*使用新的“overflow_usub()”代码。好像是用那个功能的借口。
> 
> 这是脑损伤的一个糟糕的借口。
> 
> 对不起，但是我们不会为这样愚蠢的新代码添加这样愚蠢的新接口。
> 
> 是的，是的，如果这是在网络层，我永远不会注意到。但是因为我注意到了，我真的不想扯这个。事实上，我想让每个人都明白，这样的代码是完全不可接受的。任何认为像这样的代码是“安全”的，因为它使用了奇特的溢出检测功能的人都是大错特错了，甚至一点都不好笑。所有这类废话所做的就是让代码变得不可读，没有一个正常人会真正理解它实际上做了什么。
> 
> 摆脱它。我再也不想看到那种东西了。
> 
> 莱纳斯（m.）

经验教训:不要弄乱 Linus 的代码。

【】