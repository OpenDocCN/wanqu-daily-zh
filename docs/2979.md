# 无头网络

> 原文:[https://paul.kinlan.me/the-headless-web/?UTM _ source = Wanqu . co&UTM _ campaign = Wanqu+Daily&UTM _ medium = website](https://paul.kinlan.me/the-headless-web/?utm_source=wanqu.co&utm_campaign=Wanqu+Daily&utm_medium=website)

**保罗·金兰**T3】2016 年 8 月 1 日 T5】

2014 年，我有幸在阿姆斯特丹 Fronteers 演讲(我衷心推荐)。我试图谈论网络平台的状态，它过去在哪里，现在在哪里，将来会在哪里。

它在哪里，我最近在[起伏的网络](/the-lumpy-web/)中已经部分介绍过了。它涵盖了不一致的特性支持的状态，以及它可能给开发人员带来的痛苦。它(网络)将会在哪里，我简单地提到了我称之为“无头网络”的东西。

我们中的许多人已经熟悉了“无头浏览器”，它是一个用户看不到也不与之交互的 web 浏览器的实例，对大多数人来说，它似乎是无用的。对于开发人员来说，我们通常使用这些无头浏览器来自动测试用户界面。如果更进一步，许多现代搜索引擎在幕后运行浏览器，以便能够自己执行 JavaScript，这样您使用首选框架托管的内容仍将呈现，并且数据将可索引。但我认为无头浏览器给我们提供了更多，事实上我认为它们是商业和服务网络未来的核心部分，希望我能在这篇文章中解释这一点。

我假设的无头网络是这样一种网络，用户只在网络浏览器中与网页进行轻微的交互。相反，用户体验仍然用 HTML 表示，用 JavaScript 执行，但你可能只访问一次网页就能与之建立长期关系。你可能永远不会直接访问这个网站。

我发现这至少存在于四种类型的互动中:

*   **与通知的交互** -网站或应用程序可以创建类似小应用程序的体验，让您直接与之交互，例如:像照片一样，无需打开网页就能进行交互。我早期的想法是，服务人员是交互式无头体验的关键推动者。
*   本地发现(Local discovery)又称“物理网络”(The Physical Web)，在你周围传播的 URL 可以通过 schema.org 动词和名词之类的东西在它们的网站上表达上下文动作。这样，而不是访问该网站购买电影票，它直接集成到关于信标的通知中。
*   **嵌入式内容** - Google Now 就是一个例子。数据通过 HTML 或 schema.org 在页面中表示，呈现给用户的形式可能与它在页面中的表现形式不同。例如，电影列表可以被聚集，并与其他数据一起应用，例如来自其他站点的评级和评论。
*   **原生综合内容**——又名网页浏览。如果你把所有时间都花在脸书或微信上，你会与网络互动，但你可能不知道，如果你看看这个过程，就会发现越来越多的传统网络浏览器正被主机应用程序取代。

事实证明，在没有浏览器的情况下，我们可以有更多的方式来思考网络，但这是我当时的看法。

对此有一种悲观的看法，也有一种乐观的看法:

*   半空的玻璃杯:它标志着网络开发者、用户界面设计者和整个网络的终结。
*   半杯水:内容是开放的，随处可得，比以往任何时候都更具组合性，全部由网络托管和驱动。

向前跳一年，我在 2015 年的 Coldfront Conf 上，肯尼斯·奥肯伯格(Kenneth Auchenberg)邀请我谈论“无头网络”(令我感到羞愧的是，我在那次演讲中从未真正谈到它)。相反，我关注的是移动网络的[未来，这更直接关系到作为无头网络表现的](/future-of-web-on-mobile-coldfront-conf/)[元平台](/rise-of-the-meta-platforms/)的崛起。

我们所看到的网络是通过用户主屏幕上的浏览器访问的，无论是 iOS 上的 Safari 还是 Android 上的 Chrome，这都是我们所担心的。我们 web 开发人员担心在浏览器中可以访问和使用的 web，而“Web 浏览器”正在发生变化。

我们正在创造的内容和工具正在一种非传统浏览器的体验中被消费。当时我看到它在新闻、社交平台和其他应用之间分裂。

*   苹果新闻
*   Google 对 AMP 内容的渲染(我不认为这是我在谈论元平台时的事情)
*   脸书网络视图，Facebook 即时文章
*   Chrome 自定义标签
*   微信和其他在移动平台上的社交应用。

有趣的是，由于这些平台控制着观看体验，它们可以开始将自己的平台功能和 API 注入网络。稍后我会谈到这一点。

### 桌子赌注

我对渐进式网络应用程序的概念充满热情。它们允许我们以一种人们期望的方式来表达和制定 web 应用程序，并在即时可访问性、可用性和轻量级方面表现出色。

渐进式网络应用是现代网络体验的关键。为什么它们是赌桌的赌注呢？

我一直关注网络平台的能力，以及在过去的 3-4 年里，我们如何看到网络在所有平台上的巨大变化。

![](../Images/cb88a90badacdcc59be3d7d997e69076.png)

Ever increasing capabilities of the web 2015



但是，我也表达了 Native 并不逊色，虽然我们理所当然地认为苹果每 12 个月才更新一次他们的操作系统，但其他平台如 Android 每 6 周更新一次他们的平台(在我写最初的演示文稿时)

![](../Images/cd883f082f3ff63e358d8d9a32cfc90a.png)

Native is catching up every 6 weeks



我认为这是对网络的一个看不见的威胁，正如我们正在追赶，然后本地平台迭代。谷歌 Android，特别是 Google Play 服务获得了一次更新，在 Android 中引入了一个完整的[健身层，一直到 Android Gingerbread，而没有改变底层操作系统。](https://developers.google.com/fit/)

为什么我要说健身？在这种情况下，它是一组独立传感器 API 的更高抽象，我们在网络上没有，它突出了我们的差距:

1.  我们的 API 表面仍然不成熟——例如，传感器仍然不是一个完全解决的问题，我们只是刚刚开始通过[可扩展 web](https://extensiblewebmanifesto.org/) 的原则来公开更多的平台原语(例如服务人员)
2.  我们的开发模型是多样的和完全不同的——有大量的前端和后端框架和库可供我们选择，为开发人员形成一条清晰、平坦的道路是很难的，因此构建新的原语可能会有点困难。

这种原生平台的节奏很有意思，我敢打赌，iOS 很快就会开始逐步更新核心平台——我相信这是从主屏幕上的核心应用程序开始的，我相信允许在 iOS 更新节奏之外更新它们。

正是这种节奏让我担心，看看下面的表格，这是我在第一次之后 8 个月(尽管是私下)创建的。

![](../Images/7953f6ddd3f89de3795801857c4355be.png)

Ever increasing capabilities of the web 2016



注意到区别了吗？网络获得了一些新功能，但本地平台获得了深度链接*和*(即时应用程序)的“即时加载”。我不是即时应用的粉丝，但即使在此之前，他们在 2015 年底就有了应用流——这也是一个非常糟糕的实现，但重点是移动平台。

**所有平台都在竞争[片](/slice-the-web/)空间**。

网络正在迎头赶上，渐进式网络应用和平台可扩展性的概念给了我们这些，还有很多东西我们绝对必须迎头赶上，但我们需要找到一种方法，让我们与众不同，同时保持我们的开放性和切片原则。我认为无头网络的概念是一个可以帮助我们的模型。

### 如果一切都由“网络”驱动，但你从未见过浏览器，那会怎样？

这是一个大问题。作为一个行业，我们会对用户几乎看不到网页浏览器感到满意吗？或者这是一件神圣不可侵犯的事情？

我认为我最初的分类:物理通知、嵌入式通知和集成通知，与我认为的平台发展方向相差不远。

服务工作者*是*平台的一部分，它允许很多这样的工作(至少对于用户是本地的)，但是它真正关注的是本地用户级别。用户必须注册服务人员，但是一旦我们注册了，平台级的系统事件可能会允许我们快速构建和部署我们想要的任何无头体验。现在 UI 仍然是通知。

#### 通知

令人高兴的是，这已经发生了！在英国脱欧公投前夕，[卫报](https://www.gdnmobilelab.com/)进行了一项实验，向订阅该服务的人发送更新和新闻。你可以随着时间的推移定制体验，如果你想通过点击通知获得更多信息，或者如果你从通知中获得了你需要的一切，你可以快速关闭通知。

我只拍了一张截图:(，但这是一次**惊人的**体验，对我来说，它拓展了我对网络和切片模型的体验。重要的是，它是短暂的，它使用一个简单的 URL 部署在 web 上，当公投结束时它就停止了。我认为这是网络所擅长的能力，一个完整的原生体验永远无法与之匹敌(或者不需要)。

![](../Images/004d4046329a18f38256c67066383f3c.png)

The Guardian pioneering notification led services.



我强烈建议您阅读 GDN 移动实验室，它涵盖了许多独特而有趣的体验。

#### 组合服务和嵌入内容

SLICE 中的“C”是可组合性，即从一个站点或服务获取内容和功能并将其包含在您自己的站点中的能力。传统上，这是桌面上的 web 通过带给我们 Web 2.0，特别是通过 IFRAME、JSONP 和 XMLHttpRequest 的“混搭”开始击败底层本地应用程序的能力的地方，这允许我们构建可立即访问并提供巨大价值的服务。

很长一段时间以来，这并不是本土经验所能提供的一部分，但它正开始到来。例如，Google Now 可以获取在公开网络上发现的数据，并应用您本地操作的上下文。例如，也许它可以找到你附近的电影院时间。

现在，数据被嵌入和聚合到应用程序中，然后在此基础上应用自定义操作。然而，这并不等同于将另一个应用程序逻辑直接嵌入到您的体验中，相反，原生模型是将体验和控制委托给另一个应用程序(如果已经安装了的话)。这可能是“语义网”的一个目标，但我认为我们的数据和功能需要在每个平台的网站和应用程序之间可移植，我们需要尽快解决这个问题。

[AMP](https://ampproject.org/) 有意思。AMP 允许在 web 上创建和托管内容，并且由于其定义和验证的方式，它允许 web 体验和本地体验就地托管整个内容体验。AMP 的约束允许丰富的经验组合，这些经验无处不在**而没有** `iframes`。

关键是，我们可以在传统浏览器之外轻松快速地呈现网页内容。

#### 关于在 native: WebViews 和集成内容上组合服务，我撒了谎

当我说 native 不具备快速轻松地组合服务的能力时，我说了一个小谎。

我们确实有这个能力！每一个平台都有一个 WebView 或一种将基于网络的内容直接嵌入到本地应用程序中的方法，这实在是太笨拙了。

网络浏览量对用户来说是一件坏事。在 Android 平台上，他们不会给你很好的体验。一切都在一个进程中，一切都是可截获的，开发者有能力检查你在他们的应用程序中做的一切。下面是 WebView 上的亚历克斯·罗素:*“在网络上加载任意内容是不可以的”*。

一个更好的解决方案是 [Chrome 自定义标签](https://developer.chrome.com/multidevice/android/customtabs)和`SafariViewController`，它们是系统中各自浏览器的一个实例，并提供你在浏览器中运行时获得的所有好处:同步 cookies、历史记录、支付和自动填充以及一个良好的安全沙箱。在大多数情况下，虽然很明显你是在浏览器中运行，但是越来越多我们期望从浏览器中获得的用户界面被移除，并被承载网页内容的应用程序中的逻辑所取代。

尽管我们有这两个工具，但它们实际上只用于呈现完整的外部内容，如网页或托管 web 应用程序，很少用于托管和嵌入微体验。

如果我正在建立一个平台，比如脸书或微信，我永远不会离开 WebView，因为它给了我作为平台所有者的控制权。因为我可以管理、检查和操作 WebView 中的内容，这意味着我可以直接在 web 上构建我自己的平台集成，如果我的平台被世界上的许多人使用，那么我可以更容易地进入一个空间，在那里我可以定义新的元素或界面，如果检测到这些元素或界面，可以将其转移到我自己的围墙花园平台。想象一下支付，例如，你可以检测到将要进行支付，并为用户提供优化的体验....

#### 基于服务器渲染的体验

我们有一些服务通过 HTTP 资源访问网络上的内容，然后解析出内容，并试图从中提取意义。搜索引擎、爬虫等在很长一段时间里都是这样构建的。他们获取原始 HTML 并解析它，过了一段时间这还不够好，许多网站会通过 JavaScript 加载并生成内容，这需要能够被抓取和索引。

[Bing 看起来正在做](https://html5test.com/s/c7a0303058f42596.html)。[谷歌正在做(页面速度)](https://html5test.com/s/69d033305ef7325d.html)

使用浏览器作为服务是一个不可思议的机会。它允许我们将声明性 HTML 与开发人员定义的 JavaScript 程序执行相结合，并对内容进行深入分析。

浏览器厂商也加入了这场游戏。Opera 和 UC Browser 的产品将用户正在访问的网站内容呈现在服务器上，这样他们就可以将高度压缩的页面呈现视图传输给用户，从而节省大量带宽。

作为一个开发社区，我们还利用浏览器来运行我们的 CI 和网页截图服务， [PageSpeed Insights](https://developers.google.com/speed/pagespeed/insights/) 可能是我所知道的第一个在服务器上运行浏览器的服务，根据它看到的世界状态运行一些测试，然后将数据返回给用户。

使用浏览器作为服务是一个不可思议的机会。它允许我们将声明性 HTML 与开发人员定义的 JavaScript 程序性执行结合起来，并对内容进行深入分析。

我是这样看待它的:你在 Chrome 扩展中可以做的任何事情现在也可以在服务器上做。

如果我们要了解我们周围的网络，我们需要运行一个无头浏览器，现在有几个选项:

为了理解传统上嵌入在这些页面中的内容，我们建议您应该使用“语义 HTML”。语义 HTML 允许我们在我们的页面中表示文档结构，这使得辅助工具更容易帮助用户，结合`micro data`[Schema.org](https://schema.org)允许我们将更高级的名词附加到我们的语义 HTML 上，以将“对象”表达为数据，我们甚至创建了一个可怕的 JSON 格式，以帮助开发人员将这种模式数据编码到 web 中。

不管对错，虽然我们有一些工具可以在页面中表达语义，但我们还没有为开发者创造将语义编码到页面中的动力。我不太确定我们会完全到达那里，也许人工智能的曙光会帮助我们提取一些意义。

*   DOM Distiller —帮助我们从页面中剔除垃圾，只留下内容。
*   [隐喻](https://github.com/hueniverse/metaphor) —以统一的方式从页面中提取“共享”数据。
*   Mozilla Fathom 特别有趣，因为对我来说，这是对语义 HTML 无法表达开发者意图的强烈控诉，我们可以编写测试来找到我们可以使用的页面

> Fathom 是一个实验性框架，用于从网页中提取含义，识别上一页/下一页按钮、地址形式和主要文本内容等部分。本质上，它根据您指定的条件对 DOM 节点评分并提取它们。受 Prolog 启发的类型和注释系统表达了评分步骤之间的依赖关系，并保持状态在控制之下。它还提供了扩展现有评分规则集的自由，而无需直接编辑它们，因此多个第三方细化可以混合在一起。

正如你可能已经注意到的，Distiller 和 Fathom 去掉了渲染，但我们说我们需要浏览器的完整渲染功能，所以它们实际上只是无头 web 的一部分解决方案。

我们需要能够在我们的页面上表达对数据的操作，既包括可以对数据执行的操作，也包括我的服务可以对您的数据执行的操作。我曾设想 web intents 可以被扩展来处理这种情况，但当时我只是说一个页面可以对某一段数据执行一个动作，如果您需要访问该功能，您可以将“编辑该图像”的请求委托给另一个应用程序。但是，如果您可以直接隔离页面中的功能，想象一下能够安全地将内容直接嵌入到您的站点中。AMP 对内容是这样做的，但是我目前还不知道它对“动作”是如何起作用的(我认为自定义元素会起作用)。

在服务器上运行浏览器将允许我们更容易地构建解析动态生成的数据的服务，它将允许我们更容易地针对页面中的逻辑运行我们自己的逻辑(以表单填充为例),并且我相信它将提供针对页面上嵌入的数据更有效地运行操作的能力。

### 未来的机遇

渐进式网络应用是赌注。它们让我们可以像玩本地游戏一样玩游戏，让用户体验一流的网络。我们需要向用户介绍这样一个事实，即这些体验可以是快速、可靠、健壮的，并且可以在他们期望的任何地方获得。进步的网络应用程序给了我们一个平台。

服务工作者将在未来的无头网络中扮演重要角色，他们的体验将通过用户设备直接呈现，但由 HTML 和 JavaScript 提供支持和交付。这将为我们提供完全围绕基于通知的界面构建的新产品，以及与服务人员集成的其他未来平台。

无头浏览器将有助于增强后端，它允许我们聚合信息，更容易地从整个网络中提取意义，并通过一个引擎来运行它，该引擎不仅可以理解页面内容，还可以理解在页面上执行的逻辑。

自定义元素与无头浏览器的结合将带回网络的可组合性，并使我们的托管内容可移植并在任何地方蓬勃发展，无论是将网络中的微内容原生嵌入应用程序，还是创建微网络视图，甚至是通过解析某处服务器上的数据。当 native 出现时，我们失去了一些东西，我认为我们可以通过创建可移植的数据和逻辑来展示 web 的力量。定制元素是未来 web 可组合性的关键(我会写得更详细一点)。从根本上说，自定义元素允许我们定义 HTML 标签，通过一致定义的开发人员界面，功能可以被任何本机元素或其他 web 实现所取代。

为了实现由无头浏览器支持的下一代远程服务，我们需要解决规模问题。我们一直将这些工具作为浏览器的单独实例来运行我们的测试套件。我们需要扩大规模，能够运行数百个甚至数千个浏览器实例。需要有人来建这个！如果我们能够获得一个在云中运行浏览器的规模化和通用化的解决方案，那么我们就拥有了一个非常引人注目的新平台，可以在网上大规模聚合数据。

我对网络的未来感到非常兴奋，但我所知道的是，它不会像今天这样，但我希望它由 URL 和内容驱动，这些内容可以直接寻址，可供世界上的每个人使用。我们需要直接在这些内容上有很好的体验，但是这些内容需要可以移植到用户所在的每个平台上，并且可以在他们使用的任何用户代理中使用。

如果我们能提供这样一个世界，内容和内容上的实用程序都是无标题的，那么我认为我们处于一个很好的位置。

关于我:保罗·金兰

我在谷歌领导 Chrome 开发者关系团队。

我们希望人们在网络上获得尽可能好的体验，而不必安装本地应用程序或在围墙花园中制作内容。

我们的团队试图通过支持每一个 Chrome 版本，创建优秀的内容以支持开发人员在 [web.dev](https://web.dev) 上进行开发，为 MDN 做出贡献，帮助改善浏览器兼容性，以及一些最好的开发人员工具，如 Lighthouse、Workbox、Squoosh 等等，来使开发人员更容易在 web 上进行构建。