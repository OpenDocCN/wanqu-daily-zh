# 网飞的全周期开发者——操作你构建的东西|网飞科技博客|网飞科技博客

> 原文:[https://medium . com/网飞-tech blog/full-cycle-developers-at-网飞-a08c31f83249？UTM _ source = Wanqu . co&UTM _ campaign = Wanqu+Daily&UTM _ medium = website](https://medium.com/netflix-techblog/full-cycle-developers-at-netflix-a08c31f83249?utm_source=wanqu.co&utm_campaign=Wanqu+Daily&utm_medium=website)

# 网飞的全周期开发人员——操作您构建的产品

那是 2012 年，在网飞运营一项关键服务是一项艰巨的任务。部署就像走过湿沙。鸭鸣正在演变成验证耐力(“鸭鸣一周后，没有任何东西损坏，让我们来推它”)而不是正确的功能。研究问题就像在团队之间弹一个橡皮球，很难找到根本原因，更难阻止在团队之间弹来弹去。所有这些都是需要改变的迹象。

快进到 2018 年。网飞的全球会员已经增长到 1.25 亿，每天观看时长超过 1.4 亿小时。我们在改善工程团队的开发和运营方面投入了大量资金。一路走来，我们尝试了许多构建和运营服务的方法。我们想分享一种方法，包括它的优点和缺点，这在网飞是比较常见的。我们希望分享我们的经验能激励其他人讨论替代方案，并从我们的经历中学习。

# 一个团队的旅程

[Edge](https://www.youtube.com/watch?v=x_ygR9i9EbM) [Engineering](https://medium.com/netflix-techblog/tagged/edge-engineering) 负责 AWS 服务的第一层，必须启动该层才能让网飞流正常工作。过去，Edge Engineering 拥有以运营为中心的团队和 SRE 专家，他们负责软件生命周期的部署+运营+支持部分。发布一个新的特性意味着开发人员要与运营团队在指标、警报和容量考虑等方面进行协调，然后将代码交给运营团队进行部署和操作。为了有效地运行代码和支持合作伙伴，运营团队需要不断地接受新功能和错误修复方面的培训。拥有一个独立的运营团队的主要好处是，当事情进展顺利时，开发人员很少会被打断。

当事情不顺利时，成本就会增加。dev 和 ops/sre 之间的沟通和知识传递是有损耗的，需要额外的往返行程来调试问题或回答合作伙伴的问题。部署问题需要更长的时间来检测和解决，因为运营团队对正在部署的变更缺乏直接了解。代码完成和部署之间的时间间隔比今天长得多，发布时间是几周而不是几天。反馈来自运营部门，他们直接经历了诸如缺乏警报/监控或性能问题以及延迟增加等难题，反馈也来自开发部门，他们通过第二手资料了解到了这些问题。

为了改进这一点，Edge Engineering 试验了一种混合模型，在这种模型中，开发人员可以在需要时自己推送代码，同时还负责非工作时间的生产问题和支持请求。这改善了开发人员的反馈和学习周期。但是，只承担部分责任会留下缺口。例如，即使开发人员可以进行他们自己的部署和调试管道中断，他们通常也会听从 ops 发布专家的意见。对于以运营为中心的人来说，他们被激励去做日常工作，但发现很难优先考虑自动化，以便其他人不需要依赖他们。

为了寻找更好的方法，我们后退一步，决定从基本原则开始。我们试图完成什么，为什么我们没有成功？

# 软件生命周期

软件生命周期的目的是优化“实现价值的时间”；有效地将想法转化为客户的工作产品和服务。开发和运行软件服务涉及一整套责任:



SDLC components



我们一直在划分这些职责。在极端情况下，这意味着每个职能领域由不同的人/角色负责:



SDLC specialists



这些专门的角色在每个部分创造了效率，同时在整个生命周期中潜在地创造了低效率。专家在某个重点领域发展专业知识，并优化该领域的需求。他们能更有效地解决他们的难题。但是软件需要整个生命周期来向客户交付价值。拥有各自拥有生命周期一部分的专家团队可能会产生筒仓，从而减缓端到端的进展。将不同的专家分组到一个团队中可以减少孤岛，但是让不同的人担任每个角色会增加沟通开销，引入瓶颈，并抑制反馈循环的有效性。

# 运营您构建的产品

为了反思我们的方法，我们从 devops 运动的[原则中汲取灵感。我们可以通过打破孤岛和鼓励共享整个软件生命周期的所有权来优化学习和反馈:](http://itrevolution.com/the-three-ways-principles-underpinning-devops/)



SDLC with devops principles



“操作您构建的东西”通过让开发系统的团队也负责操作和支持该系统，将 devops 原则付诸实践。将这种责任分配给每个开发团队，而不是将其外部化，可以创建直接的反馈循环并调整激励。感觉到操作痛苦的团队被授权通过改变他们的系统设计或代码来补救痛苦；他们对这两项职能负责并接受问责。每个开发团队负责部署问题、性能缺陷、容量规划、警报缺口、合作伙伴支持等等。

## 通过开发工具进行扩展

对整个开发生命周期的所有权大大增加了软件开发人员的工作量。简化和自动化常见开发需求的工具有助于平衡这一点。例如，如果期望软件开发人员管理他们服务的回滚，那么就需要丰富的工具来检测和提醒他们问题，并帮助回滚。

网飞创建了集中式团队(例如，云平台、性能和可靠性工程、工程工具)，其任务是开发[通用工具和基础设施](https://netflix.github.io/)来解决每个开发团队都有的问题。这些集中化的团队通过将他们的专业知识转化为可重用的构建模块来发挥力量倍增器的作用。例如:



Specialists create reusable tools



有了这些工具，开发团队可以专注于解决他们特定产品领域内的问题。当额外的工具需求出现时，集中的团队评估需求是否在多个开发团队中是共同的。当他们是，合作接踵而至。有时，这些地方需求过于具体，不值得集中投资。在这种情况下，开发团队决定他们的需求是否重要到足以让他们自己解决。

在类似问题上平衡地方投资和中央投资是我们方法中最困难的方面之一。根据我们的经验，找到满足开发人员需求的新颖解决方案的好处值得多个团队冒风险创建并行解决方案，这些解决方案将需要在未来进行融合。沟通和协调是成功的关键。通过在需求和它们可能有多普遍上开始很好地对齐，我们可以更好地将投资与整个网飞的开发团队的利益相匹配。

## 全周期开发人员

通过将所有这些想法结合在一起，我们得到了一个模型，在这个模型中，一个配备了惊人的开发人员生产力工具的开发团队负责整个软件生命周期:设计、开发、测试、部署、操作和支持。



The empowered full cycle developer



全周期开发人员被期望在软件生命周期的所有领域都有知识和效率。对于许多刚到网飞的开发者来说，这意味着要在他们以前没有关注的领域加速前进。我们举办开发人员训练营和其他形式的持续培训，传授这些知识并培养这些技能。知识是必要的，但还不够；有效的全周期所有权还需要易于使用的部署管道工具(如 [Spinnaker](https://www.spinnaker.io/) )和监控工具(如 [Atlas](https://github.com/Netflix/atlas/wiki) )。

全周期开发人员将工程原则应用于生命周期的所有领域。他们从开发人员的角度评估问题，并提出类似“我如何自动化操作这个系统所需的东西？”以及“什么样的自助服务工具能让我的合作伙伴无需我的参与就能回答他们的问题？”这有助于我们的团队通过支持以系统为中心而不是以人类为中心的思维和自动化而不是手工方法来扩展。

转向全周期开发模式需要思维方式的转变。一些开发人员将设计+开发，有时是测试，视为他们创造价值的主要方式。这导致了将运营视为干扰的反模式，倾向于短期修复运营和支持问题，以便他们可以回到他们的“真正工作”。但是全周期开发人员的“真正工作”是使用他们的软件开发专业知识来解决整个生命周期中的问题。一个完整周期的开发人员像瑞典人、SDET 人和 SRE 一样思考和行动。有时他们创建解决业务问题的软件，有时他们编写测试用例，有时他们自动化系统的操作方面。

要使这种模式成功，团队必须致力于它所带来的价值，并认识到其成本。团队需要配备适当的人员，有足够的空间来管理构建和部署，处理生产问题，并响应合作伙伴的支持请求。时间需要投入到训练中。工具需要被利用和投资。需要与集中的团队建立伙伴关系，以创建可重用的组件和解决方案。在计划和回顾期间，需要考虑生命周期的所有方面。自动化警报响应和构建自助服务合作伙伴支持工具等投资需要与业务项目一起优先考虑。通过适当的人员配备、优先级划分和合作关系，团队可以成功地运营他们构建的东西。没有这些，团队就会面临超负荷和精疲力竭的风险。

要在网飞之外应用这一模式，就必须进行调整。您的开发团队中的常见问题可能是相似的——来自对连续交付管道、监控/可观察性的需求，等等。但许多公司没有像网飞那样的人员来投资集中的团队，也不需要网飞的规模所要求的复杂性。网飞的工具通常是开源的，第一次尝试它们可能会很有吸引力。然而，针对这些问题的其他开源和 SaaS 解决方案可以满足大多数公司的需求。从分析潜在价值和计算成本开始，然后转变思维。评估你需要什么，注意引入最不必要的复杂性。

## 权衡取舍

科技行业有各种各样的方法来解决开发和运营需求(参见 [devops 拓扑](http://web.devopstopologies.com/)获取详细列表)。这里描述的全周期模型在网飞很常见，但也有它的缺点。在选择型号之前知道取舍，可以增加成功的几率。

在全周期模式中，通过工具优先考虑更大范围的所有权和有效性。广度需要对多种多样的技术既有兴趣又有才能。一些开发者更喜欢专注于成为某个狭窄领域的世界级专家，而我们的行业需要某些领域的这类专家。对于这些专家来说，要求广泛，每个领域都有合理的深度，可能会不舒服，有时甚至无法实现。网飞的一些人更喜欢在一个需要深入专业知识的领域，而不需要持续的广度，我们支持他们找到这些角色；其他人享受并欢迎更广泛的责任。

在我们构建和操作基于云的系统的经验中，我们看到了开发人员的有效性，他们重视拥有整个周期所需的广度。但是这种广度增加了每个开发人员的认知负荷，并且意味着一个团队每周将会平衡更多的优先级，而不是仅仅专注于一个领域。我们通过随叫随到的轮换来缓解这一问题，开发人员轮流处理部署+运营+支持职责。做得好的话，就为其他人创造了专注的、心流状态的工作空间。当工作做得不好时，团队会变成每个人都投入到高干扰的工作中，比如生产问题，这可能会导致精疲力竭。

工具和自动化有助于扩展专业知识，但是没有工具能够解决开发人员生产力和操作空间中的所有问题。网飞有一套由集中团队正式支持的“铺路”工具和实践。我们并不强制要求采用这些铺设好的道路，而是通过确保使用这些技术的开发和运营比不使用它们的体验好得多来鼓励采用。我们方法的缺点是“每个团队使用每个工具中的每个特性来满足他们最重要的需求”的理想几乎不可能实现。实现我们集中式团队解决方案的投资回报需要努力、调整和持续的适应。

# 结论

从 2012 年到今天，这条道路充满了实验、学习和适应。Edge Engineering，其早期的经验激发了寻找更好的模型，今天正在积极地应用全周期开发人员模型。部署是例行和频繁的，金丝雀需要几个小时而不是几天，开发人员可以快速研究问题并做出改变，而不是在团队之间推卸责任。其他群体也看到了类似的好处。然而，我们认识到，我们是通过应用和学习替代方法才走到这一步的。我们期待未来的需求能够推动进一步的发展。

有兴趣看看这个模型的运行吗？想参与探索我们如何发展未来的方法吗？考虑[加入我们](https://jobs.netflix.com/)。

*由* [*菲舍尔-奥格登*](https://www.linkedin.com/in/philfish/)*[*格雷格·伯瑞尔*](https://www.linkedin.com/in/greg-burrell-67ab273/) *，以及* [*黛安娜·马什*](https://www.linkedin.com/in/diannemarsh/)*