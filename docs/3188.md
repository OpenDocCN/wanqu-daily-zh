# 当你的同事创建意大利面条代码时该怎么办

> 原文：<https://blog.ndepend.com/colleague-creates-spaghetti-code/?utm_source=wanqu.co&utm_campaign=Wanqu+Daily&utm_medium=website>

我为许多不同的机构写文章，并以软件和 IT 咨询为生。因为这三个关注点——写作、专业地提供建议和软件——的交叉，我处理了很多关于如何做正确的技术事情而不被你周围的人攻击的建议请求。考虑一个例子。

"我们如何开始单元测试？"

仅仅作为一个技术问题来考虑，这个问题会招致相当迟钝的反应。“首先，编写一个单元测试。第二，运行单元测试。”显然，这并不是任何人在问这个问题时真正想问的。

相反，他们想知道更复杂的事情。“我们如何克服多年的惰性，一个令人讨厌的遗留代码库，比尔，他已经存在了 40 年，讨厌一切新东西，以及管理层不想付钱给我们写‘额外’代码的事实…然后*然后*开始单元测试？”哦，对了，那个。嗯，那很复杂。

我经常听到这种看似无害但实际上很复杂的关于代码质量的问题。“我团队中的这个白痴正在写一堆难以想象的最难维护的垃圾——我该怎么办？”

通常，这类问题来自客户网站的人。因此，我必须在对个人最有意义的答案和考虑客户最大利益的答案之间取得平衡。客户支付我的账单，我有一个宪章来降低他们代码的拥有和开发成本。

但是当我处于写作模式时，只有提问者的兴趣才重要，我会给出一个微妙不同的答案。今天，我想提供一些建议，告诉你在这种情况下应该怎么做。

### 免责声明

明确地说，问题“我应该如何处理我同事的意大利面代码？”并不意味着当涉及到你的利益时，你和你的组织会步调一致。您的组织可能想要可以想象的最干净、最易维护的代码，并且，从理论上讲，它会要求您为正义而战。

但是你的组织也可能对你抛出“愤怒的比尔，单元测试的憎恨者”，并告诉你他是高级开发人员，不管你喜欢与否。突然之间，死在“干净代码”的山头上变成了一个不那么明确的选择。

因此，我提供以下免责声明。我对你应该做什么的建议可能并不总是为你的公司带来最好的结果。

### 建立基于数据的案例

读完我的免责声明后，你坐在那里，确信比尔正在慢慢毒害他接触的每一个代码库。他的垂直和水平间距激怒了你，他的公共方法语义冒犯了你的敏感。他的代码是如此的…丑陋…以至于你几乎可以从中察觉到一种物理气味。你甚至会认为他这样做是为了刁难你。

尽管你讨厌它，但你确定它不好吗？当你把它描述成意大利面条时，你是在发表评论吗？我是说，你怎么知道的？你有没有画出入口点和出口点，并画出依赖关系？还是你只是不喜欢，因为他做的事情和你大相径庭？

并不是我怀疑你。那就是，你可以打赌，大多数人会怀疑你，尤其是比尔。如果你没有关于代码的一些数据来武装自己，当你陈述你的情况时，你会看起来充满恶意。如果你没有支持性的参考资料来支持你的数据，来帮助你声明这是一个问题，你也不会做得更好。

在进一步调查之前做一些研究，确保你可以证明你的指控是正确的。

### 问问你自己，“我认为我是谁？”

问这个问题是因为你可以确定别人会问。当然，你已经建立了一个防弹的案例，利用静态分析、专家意见和行业趋势。这一切都很好。

但是你要指控比尔——比尔！写意大利面条式的代码。比尔，当你的公司没有电子邮件，只有信鸽的时候，他就和你一起创建了这个软件的原始版本，他只用了 COBOL 语言、打包线和胶带。你到底以为你是谁？

说真的，这很重要。你需要考虑你的角色。如果你的团队将你视为技术领导和导师，那么去对一个新的团队成员说，“你的方法相当复杂——尽量将这个叫做圈复杂度的东西保持在 3 以下”没有问题。每个人，包括新手，都希望你在自己的岗位上做到这一点。但是如果你是新手，初级开发人员对导师说同样的话，事情会变得很糟糕。

我可以听到你愤怒的抗议“当有实证证明正义的时候，角色就不重要了！”老实说，我同意你的观点。我想 HR 会想在你的离职面谈中听到所有的信息。

站在相对缺乏经验的立场上争论会让你付出政治代价——即使你是对的。让这些战斗自担风险，看看术语[得不偿失的胜利](https://en.wikipedia.org/wiki/Pyrrhic_victory)，了解即使你赢了也会发生什么。

### 提供备选方案和结果

让我们假设你已经建立了一个像样的事实案例，并且准确地估算了你可以支配的组织资本。你有足够的理由继续下去，也有足够的可信度让人们听你的理由。

除非你能提供某种解决方案，否则不要实际进行。简单地走到比尔面前说，“我已经做了很多研究，这里有一篇关于为什么你的代码很糟糕的长篇论文，”只会让他泄气。相反，你需要做好准备，准备好可供选择的方案。“你倾向于编写大量的方法，但实际上你可以获取大量的局部变量，并用它们作为字段提取类。”现在，你提供了一个行动计划。

但除此之外，还要完成你的案子。一旦你向比尔展示了更好的方法，确保你能证明更好的结果会随之而来。发挥创造力。也许把某人拉过来，问他们需要多长时间才能理解旧的方法和新的、被打破的类。无论你必须做什么，通过提供利益来帮助“啊哈”时刻。

### 谦逊、外交和以身作则

你已经建立了一个案例，陈述了它，并展示了它所提供的价值。不要让那件事冲昏你的头脑。

你不要抱着“我的路是对的，你的是错的”的态度。相反，你想让数据说话，把你和比尔从你写的代码中分离出来。你读了很多书，也从聪明人那里了解到，这样会有更好的结果。你不是专家，但如果他想看一看，你自己也有很好的结果。听着，如果他感兴趣，你会告诉他的。

尽你所能采取一种耐心的导师姿态，但不要暗示你们中的一个更好或更有经验… *即使你明显更好或更有经验。*主题不应该是你和比尔，而是各种技术的优劣。你们只是两个同龄人在讨论他们。

### 意大利面条代码的哲学总结

我在帖子的开头提到了这一点，但我想在这里重申一下。“我怎样才能让比尔停止写意大利面条式的代码”只是表面上的一个技术问题。事实上，这是一个人的问题。

你可以拥有它的权利，没有任何区别。或者，你可以威胁比尔，进一步巩固他的地位。你可以给他发愤怒的电子邮件，撤销他的提交，在代码评审中“拒绝”他的东西，和他作对。那会打击他的士气，破坏每个人的进步。

简单地说，如果不与比尔打交道，你就无法改变他的行为。所以，不管你采取什么方法，要明白你的问题是一个说服问题，而不是技术正确性问题。

### 

我是一名热情的软件开发人员和活跃的博客作者。在[我的网站上了解我。](https://www.daedtech.com/additional-information/about)