# 我的第一次账单回顾——乔尔谈软件

> 原文：<http://www.joelonsoftware.com/items/2006/06/16.html?utm_source=wanqu.co&utm_campaign=Wanqu+Daily&utm_medium=website>

在过去，Excel 是一种没有名字的非常笨拙的编程语言。我们称之为“Excel 宏”。这是一种严重功能失调的编程语言，没有变量(你必须将值存储在工作表的单元格中)，没有局部变量，没有子例程调用:简而言之，它几乎完全不可维护。它有像“Goto”这样的高级功能，但标签实际上是看不见的。

唯一让它看起来合理的是，与 Lotus 宏相比，它看起来很棒，Lotus 宏只不过是作为长字符串输入到工作表单元格中的一系列击键。

1991 年 6 月 17 日，我开始在微软的 Excel 团队工作。我的头衔是“项目经理”我应该想出解决这个问题的办法。言外之意是，解决方案将与基本编程语言有关。

*基础？耶！*

我花了一些时间与各种开发小组谈判。Visual Basic 1.0 刚刚问世，非常酷。有一个被误导的努力正在进行，代号为 MacroMan，另一个努力是使面向对象的基本代号为“银”银牌团队被告知他们的产品只有一个客户:Excel。Silver 的营销经理 Bob Wyman，是的，Bob Wyman，他只能向一个人推销他的技术:我。

正如我所说，MacroMan 被误导了，这需要一些说服，但它最终被关闭。Excel 团队让 Basic 团队相信，我们真正需要的是某种用于 Excel 的 Visual Basic。我设法把四个宠物特性添加到基本版中。我让他们添加变量，这是一种可以容纳任何其他类型的联合数据类型，因为如果没有 switch 语句，就无法将电子表格单元格的内容存储在变量中。我让他们添加后期绑定，后来被称为 IDispatch，也就是 COM 自动化，因为 Silver 的原始设计需要对类型系统有深刻的理解，而编写宏的人并不关心这一点。我在这种语言中得到了两个最受欢迎的句法特征:从 csh 中偷来的每个的**，以及从 Pascal 中偷来的带有**的**。**

然后我坐下来写 Excel Basic spec，这是一个长达数百页的大文档。我想完成的时候已经有 500 页了。(“瀑布，”你窃笑；是啊是啊闭嘴。)

在那些日子里，我们曾经有这些东西被称为比尔格评论。基本上每一个重要的功能都经过了比尔·盖茨的审核。我被告知要送一份我的说明书到他的办公室，为审查做准备。它基本上是一令激光打印纸。

我赶紧把说明书打印出来，送到他的办公室。

那天晚些时候，我有一些时间，所以我开始弄清楚 Basic 是否有足够的日期和时间函数来做所有你可以在 Excel 中做的事情。

在大多数现代编程环境中，日期被存储为实数。该数字的整数部分是自过去某个约定日期以来的天数，称为纪元。在 Excel 中，今天的日期 2006 年 6 月 16 日存储为 38884，计算 1900 年 1 月 1 日为 1 的天数。

我开始研究 Basic 中的各种日期和时间函数以及 Excel 中的日期和时间函数，在尝试中，我注意到 Visual Basic 文档中有一些奇怪的地方:Basic 使用 1899 年 12 月 31 日作为纪元，而不是 1900 年 1 月 1 日，但是由于某种原因，今天的日期在 Excel 中与在 Basic 中是相同的。

啊？

我去找了一个 Excel 开发人员，他年纪够大了，还记得为什么。艾德·弗莱斯似乎知道答案。

“哦，”他告诉我。"查看 1900 年 2 月 28 日"

“是 59，”我说。

“现在试试 3 月 1 号。”

“是 61！”

“60 怎么了？”艾德问。

“二月二十九日。1900 年是闰年！能被 4 整除！”

“猜得不错，但没有雪茄，”埃德说，让我想了一会儿。

哎呀。我做了些调查。能被 100 整除的年份不是闰年，除非它们也能被 400 整除。

1900 年不是闰年。

“是 Excel 里的 bug！”我惊呼道。

“嗯，不是真的，”艾德说。“我们必须这样做，因为我们需要能够导入 Lotus 123 工作表。”

“这么说，是莲花 123 里的 bug？”

“是啊，但可能是故意的。Lotus 必须安装在 640K 中。那不是很多记忆。如果你忽略 1900 年，你可以通过观察最右边的两位是否为零来判断某一年是否是闰年。那真是又快又容易。在过去的两个月里，Lotus 的人可能认为出错并不重要。看起来基础版的人想对这两个月进行分析，所以他们把时间向后推了一天。”

“啊！”我说着，去研究为什么在选项对话框中会有一个名为 **1904 日期系统**的复选框。

第二天是大账单回顾。

一九九二年六月三十日。

那时候，微软没有那么官僚。我向迈克·康特汇报，而不是像现在这样有 11 或 12 层的管理层，迈克·康特向克里斯·格雷厄姆汇报，克里斯·格雷厄姆向皮特·希金斯汇报，皮特·希金斯向迈克·梅普斯汇报，迈克·梅普斯向比尔汇报。从上到下大概 6 层。我们取笑像通用汽车这样的公司，他们有八层管理体系，或者不管是什么。

在我的比尔格回顾会议上，整个汇报层级都在，还有他们的堂兄妹、姐妹和阿姨，还有一个来自我团队的人，他在会议期间的全部工作就是准确记录比尔说了多少次 F 字。f * * *-计数越低越好。

比尔进来了。

我想，他有两条腿、两只胳膊、一个脑袋，这是多么奇怪啊。几乎和普通人一模一样。

他手里拿着我的说明书。

他手里拿着我的说明书！

他坐下来，和一位我不认识的高管开玩笑，这对我来说毫无意义。几个人都笑了。

比尔转向我。

我注意到在我的说明书的空白处有一些注释。他已经读过第一页了！

他已经看了我的说明书的第一页，并在空白处写了些小笔记！

考虑到我们 24 小时前才给他拿到说明书，他肯定在前一天晚上就读过了。

他在问问题。我在回答他们。它们相当简单，但我无论如何也记不起它们是什么，因为我无法停止注意到他在翻阅说明书…

他正在翻阅说明书！【冷静点，你是什么小姑娘？]

…所有的页边空白处都有注释。在说明书的每一页上。他读完了整本该死的书，还在页边空白处做了笔记。

他读了整本书！【OMG SQUEEE！]

问题变得更加困难和详细。

它们看起来有点随机。到现在为止，我已经习惯于把比尔当作我的朋友。他是个好人！他看了我的说明书！他可能只是想问我几个关于空白处评论的问题！我会在 bug tracker 中为他的每一条评论打开一个 bug，并确保它得到解决， *pronto！*

最后一个关键问题。

“我不知道，伙计们，”比尔说，“真的有人在研究如何做到这一点的所有细节吗？就像，所有那些日期和时间函数。Excel 有如此多的日期和时间函数。Basic 会有同样的功能吗？它们的工作方式都一样吗？”

“是的，”我说，“除了 1900 年的一月和二月。”

沉默。

柜台和我的老板惊讶地交换了一下眼神。我是怎么知道的？一月和二月什么？

“好吧。“嗯，干得好，”比尔说。他拿着他那份有标记的说明书

… *等等！我想要那个* …

然后离开了。

“四，”f***计数器宣布，所有人都说:“哇，这是我能记得的最低了。比尔晚年变得越来越成熟了。”他，你知道，36 岁。

后来有人向我解释了这件事。“比尔并不是真的想检查你的规格，他只是想确保你能控制住它。他的标准作案手法就是问越来越难的问题，直到你承认你不知道，然后他就可以冲着你毫无准备的大喊大叫。没有人真的知道，如果你回答他能想到的最难的问题，会发生什么，因为这以前从未发生过。”

"你能想象如果吉姆·曼齐参加了那次会议吗？"有人问。“‘什么是日期函数？’Manzi 会问的。"

吉姆·曼齐(Jim Manzi)是那种把莲花跑进地里的 MBA 类型。

这是一个很好的观点。比尔·盖茨非常精通技术。他理解变体、COM 对象和 IDispatch，以及为什么自动化不同于 vtables，为什么这可能导致双接口。他担心日期功能。如果他信任从事软件工作的人，他就不会干涉软件，但是你一分钟也不能欺骗他，因为他是程序员。一个真正的程序员。

看着非程序员试图经营软件公司，就像看着一个不懂冲浪的人试图冲浪。

“无妨！我有伟大的顾问站在岸边告诉我该怎么做！”他们说，然后从板上掉下来，一次又一次。相信管理是一种通用功能的 MBA 们的标准呼声。鲍尔默会成为另一个约翰·斯卡利吗？因为董事会认为出售百事可乐是运营一家电脑公司的良好准备，鲍尔默差点让苹果公司陷入绝境。对 MBA 的崇拜倾向于相信，你可以管理那些做你不理解的事情的组织。

这些年来，微软变大了，比尔扩张过度了，一些见不得人的道德决定使它有必要投入太多的管理注意力来对抗美国政府。史蒂夫接任首席执行官一职的理论是，这将使比尔有更多的时间做他最擅长的事情，管理软件开发组织，但这似乎并没有解决由 11 层管理引起的普遍问题，一种永无休止的会议文化，一种无论如何都要创造每一个可能的产品的顽固坚持，(微软在 R&D 损失了多少亿美元，法律费用，以及对声誉的损害，因为他们决定他们不仅必须制作一个网络浏览器，而且必须免费提供？)，而几十年来草率而快速的招聘已经确保了微软普通员工的智力水平大幅下降(道格拉斯·柯普兰在《微博客》中写道:“他们仅在 1992 年就雇佣了 3100 人，你知道他们并不都是精英。”)

哦好吧。该党已转移到其他地方。Excel Basic 变成了 Microsoft Visual Basic for Applications for Microsoft Excel，有这么多的(TM)和(R)我不知道把它们都放在哪里。我在 1994 年离开了这家公司，以为比尔已经完全忘记了我，直到我注意到《华尔街日报》对比尔·盖茨的一次简短采访，他在采访中几乎顺便提到了为 Excel 招聘一名优秀的项目经理是多么困难。它们不只是长在树上之类的。

他会不会一直在说我？不，可能是别人。

还是。