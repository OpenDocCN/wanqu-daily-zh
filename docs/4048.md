# 与小团队一起攀登 Unsplash📈👨‍👩‍👧‍👦|作者 Luke Chesser | Unsplash 博客| Medium

> 原文:[https://medium . com/unsplash-unfiltered/scaling-unsplash-with-a-small-team-fbdd 55571906？UTM _ source = Wanqu . co&UTM _ campaign = Wanqu+Daily&UTM _ medium = website](https://medium.com/unsplash-unfiltered/scaling-unsplash-with-a-small-team-fbdd55571906?utm_source=wanqu.co&utm_campaign=Wanqu+Daily&utm_medium=website)

# 与小团队一起攀登 Unsplash📈👨‍👩‍👧‍👦

构建 Unsplash 最有趣的事情之一是产品的绝对大小、规模和受欢迎程度。

平均每天，我们的 API 处理来自 unsplash.com 的**1000 多万个请求**和数千个第三方应用，我们的数据管道处理**数百万个事件**，我们的订阅源添加**6000 万个更新**，我们提供**6000 万张图片**。

同时，[我们的团队](https://unsplash.com/hiring)比较小:2 个设计师，3 个前端，3 个后端，1 个数据工程师。没有人负责开发运维，每个人都将大部分时间花在实验和新功能开发上，以推动发展。

虽然我们已经通过 Unsplash 取得了很多成就，但作为产品和业务，我们仍处于其旅程的最开始。我们仍然有很多需要证明，这意味着我们需要整个团队专注于解决 Unsplash 特有的问题，而不是每个公司都有的问题，如部署、网络安全、基础设施、依赖性管理等。

在过去的 3 年里，我们制定了一套原则，使我们能够专注于增长，远离扩展挑战。不幸的是，对于那些寻找灵丹妙药的人来说，没有灵丹妙药:只有常识和一套我们从他人那里大量借鉴的原则。

# 1.构建枯燥、明显的解决方案

又名务实

在介绍新工具之前，无论是新数据库(RethinkDB、RocksDB 等)。)，一个新格局(“功能一切！”)，或者新的架构(“微服务拯救世界！”)，先穷尽显而易见的选项。

在后端，使用标准的重型工具和一些屡试不爽的模式，如缓存、批处理、异步操作和预请求聚合，很少有问题不能解决。

# 2.专注于解决用户问题，而不是技术问题

Unsplash 是一家产品公司，不是技术公司。投资者专门给了我们很多钱，这样我们就可以专注于解决产品和市场问题，而不是试图通过应用一项普通技术来降低 3%的运营成本。

相反，我们将时间集中在以解决用户问题和扩大 Unsplash 社区的方式连接预建技术上。这些是 Unsplash 独有的部分，如果我们成功地构建了一些独特而有价值的东西，我们可以在以后处理优化和大量定制，其中 3%的优化可能是剩余增长的主要来源。

这可能会让潜在的队友感到困惑，因为他们会听说 Unsplash 的“规模”和小团队，图像和人工智能的使用，以及未来的功能，但却意识到我们使用了许多现成的技术、服务和框架，同时支付少量的溢价将这些技术的内部开发交付给我们未来的队友。

部署管道、服务器配置、系统依赖性、数据处理、数据分析、图像处理和个性化(仅举几个例子)是我们选择不集中投资工程资源的领域，而是选择第三方服务来处理每一个领域。

# 3.在技术问题上砸钱

不关注技术问题的另一面是为获得预先构建的技术或第三方服务支付额外费用。

在团队中，我对任何问题的第一反应都是‘你试过砸钱吗？’，这已经成了一个笑话。但这不是笑话，这是我最喜欢的解决问题的方法之一。

优化与基础设施和技术相关的成本对于简单、可重复的解决方案来说是一个常见问题，投资者支持的产品公司不应该关心这个问题，直到他们觉得顶线指标的增长不再是他们的首要任务。

在技术问题上投入资金可以让我们的团队专注于不可重复的、困难的问题，比如弄清楚如何在一个季度内将用户群总体增长 40%。

T2】

这是我们遵循的三个相当简单但抽象的原则。

实际上**看起来如何？**

如果你看看 Unsplash 的架构，你会发现我们有一个非常简单的——几乎令人厌烦的(至少按照 2017 年的标准)——设置。



A simplified, bird’s eye view of the main parts of Unsplash 🐦



我们尽可能使用 Heroku 来简化主要应用程序的部署、配置、测试、维护和扩展。Heroku 是神奇的，因为它抽象出了应用和开发过程中任何队友都不应该*需要*熟悉的部分来构建和发布实验。

我们积极地最小化我们为应用程序逻辑编写的代码(紫色区域)。在应用程序逻辑中，我们严重依赖于其他人构建的框架，这些人凭借其在各自领域的专家地位，创建了一套适用于我们 95%用例的原则。

我们非常依赖 Redis、ElasticSearch 和 Postgres 来处理所有生产负载。我们过去尝试过其他数据库，但我们总是回到这三个数据库，因为我们对这些数据库如何在负载下运行的理解很有信心。

我们积极使用工作队列，将尽可能多的操作推入异步处理队列，无论是更新、聚合还是跨资源同步。

我们的数据处理使用了 [Snowplow](http://snowplowanalytics.com/) ，这是一个用 Scala 编写的开源集成数据处理框架，让我们的团队能够专注于系统的输入和输出，而不是实际的处理。

我们使用一系列云监控服务，如 [Datadog](https://datadoghq.com) 、 [New Relic](https://newrelic.com) 、 [Sentry](https://sentry.io) 和 [Logentries](https://logentries.com) ，而不是试图管理或滚动我们自己的 StatsD 或 ELK 堆栈。

我们将所有的图像托管和基础设施外包给全球领先的动态图像处理公司 Imgix。当他们添加行业领先的功能时，我们的团队通过一个简单的 URL 更改选择加入，为我们的用户提供最新的图像优化和处理。

我们将所有用户活动推送到 [Stream](https://getstream.io) ，这是一个提要聚合服务，利用他们构建和优化高度可扩展的个性化提要的知识。Stream 将数十亿个活动简化为一个简单的输入和输出 API，其性能需要我们的团队花费数月甚至数年来学习和优化。

我们不训练自己的图像识别算法，而是使用 [TinEye](https://www.tineye.com/) 进行反向图像搜索，使用 [Google Vision](https://cloud.google.com/vision/) 进行图像理解和分类。

我们将所有行为事件推送到电子邮件营销和通知平台 [Vero](https://getvero.com) 上，该平台将电子邮件参与从我们的应用转移到我们的非开发团队成员手中，允许他们根据自己的见解，基于复杂的基于事件的逻辑，创建高度个性化的电子邮件。

T2】

与此同时，我们确实投资于 Unsplash 中与增强我们的核心竞争力相一致的部分。

在过去的一年里，我们已经逐步将应用程序[从单一的 Rails 应用程序](/unsplash-unfiltered/product-update-single-page-app-mobile-navigation-more-d991c8eb8adf)过渡到 Rails API、Node + React 支持的 web 应用程序，以及处理所有内部和产品指标的数据收集和处理的独立数据应用程序。

总的来说，这使得我们的团队能够构建在我们以前的纯 Rails 堆栈上几乎不可能实现的功能。通过拆分我们的应用程序关注点和技术，我们的团队还能够在各自的领域使用最好的工具:

*   在前端，我们的团队使用 React 和 Webpack，以及一个小型 Express 服务器来支持服务器端渲染和代理 API。我们非常谨慎地没有用像 [react-rails](https://github.com/reactjs/react-rails) 或 [webpacker](https://github.com/rails/webpacker) 这样的临时工具将我们的前端团队的工具绑定到我们的后端团队。毫无疑问，Javascript 社区正在开发最好的前端工具，所以在 Javascript 中进行原生工作可以让我们的团队更快地发布更高质量的特性。
*   在后端，我们的团队继续使用简单 web 应用程序的最佳框架:Rails。Rails 生态系统继续为后端功能开发提供最好的集成工具，而且 Rails 是一个如此广泛使用的框架，每个可能的问题都已经被其他团队经历、记录和解决了。
*   在数据方面，我们的团队使用一个小型的 Express 服务器来收集和排队数据以供处理。实际的数据处理由 Snowplow 处理，托管在一组 AWS 映像上，便于配置和设置。这使得我们的单一数据工程师 [Tim](https://twitter.com/TimmyCarbone) 能够将大部分时间集中在将数据输入和输出 Snowplow 上，以便于团队的其他成员理解和洞察。

我们在编写测试方面投入了大量资金，使用像 T2 科学家和数据狗这样的工具来衡量性能，通过实验推出改变，并尽可能多地自动化我们的基础设施。

我们正在开发一个[新的内部 GraphQL API](https://twitter.com/lukechesser/status/846935855285489664) ,以加速实验、新功能和新产品的独立迭代，因为我们发现，如果我们的数据、设计、前端和后端团队之间没有高级别的协调，我们的 RESTful API 就会崩溃——时间最好花在功能上，而不是 JSON 更改上。

虽然这些变化显然很有趣，但我们做这些并不是为了满足开发人员的需求，而是为了解决阻碍我们快速迭代和成长的实际问题。

T2】

我想大多数读过 Unsplash 是如何构建的人可能会有以下三种反应:

1.  Unsplash 很简单，所以显然 *you* 可以采用这种方法。我正在建造的东西很复杂，所以我们*需要*来做这些事情。
2.  我是开发商。这听起来真的很无聊——我想建立下一个高度可扩展的图像识别系统！
3.  凉爽的👍我不管，给我看几张[惊艳的免费照片](https://unsplash.com/new)我就能用。

对于认为#1 的人来说，你是对的，显然有公司在做比我们在 Unsplash 所做的更复杂的事情。但归根结底，大多数公司根本不是这样。我们基本上都在构建相同的系统，但侧重点略有不同，这就是为什么技术可以抽象为框架并在如此多的项目中重用，以及为什么大多数招聘职位看起来如此相似。

对于第二点，我说这取决于你对什么感兴趣。如果你对推动技术的发展感兴趣，那就去一家以此为使命的公司工作吧。不过这种情况很少，因为归根结底，大多数公司根本不会这么做。

对于第三点，我说是的，完全正确。最终，这也是我们所关心的！

T2】

*如果你有任何问题，或者想更深入地了解这一点，在 Twitter 上给我喊一声*[*@ Luke chesser*](https://twitter.com/lukechesser)*。此外，如果你发现自己在点头附和，并且喜欢创造美好的经历，我们正在 Unsplash 招聘👉*T11】